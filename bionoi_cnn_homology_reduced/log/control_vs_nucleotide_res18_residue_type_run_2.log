data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3722
train Accuracy:0.855 Precision:0.828 Recall:0.850 F1:0.839 MCC:0.707.
val Loss: 0.3951
val Accuracy:0.851 Precision:0.851 Recall:0.805 F1:0.827 MCC:0.697.
 
Epoch 2/8
---------------
train Loss: 0.2478
train Accuracy:0.909 Precision:0.892 Recall:0.904 F1:0.898 MCC:0.816.
val Loss: 0.4920
val Accuracy:0.833 Precision:0.889 Recall:0.714 F1:0.792 MCC:0.666.
 
Epoch 3/8
---------------
train Loss: 0.1617
train Accuracy:0.943 Precision:0.931 Recall:0.941 F1:0.936 MCC:0.884.
val Loss: 0.4414
val Accuracy:0.854 Precision:0.839 Recall:0.830 F1:0.835 MCC:0.704.
 
Epoch 4/8
---------------
train Loss: 0.1081
train Accuracy:0.963 Precision:0.955 Recall:0.961 F1:0.958 MCC:0.925.
val Loss: 0.5755
val Accuracy:0.843 Precision:0.823 Recall:0.823 F1:0.823 MCC:0.682.
 
Epoch 5/8
---------------
train Loss: 0.0842
train Accuracy:0.971 Precision:0.965 Recall:0.970 F1:0.968 MCC:0.941.
val Loss: 0.6167
val Accuracy:0.852 Precision:0.866 Recall:0.787 F1:0.825 MCC:0.699.
 
Epoch 6/8
---------------
train Loss: 0.0689
train Accuracy:0.977 Precision:0.972 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.5945
val Accuracy:0.856 Precision:0.888 Recall:0.773 F1:0.826 MCC:0.709.
 
Epoch 7/8
---------------
train Loss: 0.0586
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.7124
val Accuracy:0.840 Precision:0.862 Recall:0.760 F1:0.808 MCC:0.675.
 
Epoch 8/8
---------------
train Loss: 0.0538
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6575
val Accuracy:0.850 Precision:0.818 Recall:0.853 F1:0.835 MCC:0.699.
Training complete in 230m 55s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3797
train Accuracy:0.850 Precision:0.819 Recall:0.849 F1:0.834 MCC:0.697.
val Loss: 0.3996
val Accuracy:0.837 Precision:0.782 Recall:0.878 F1:0.827 MCC:0.678.
 
Epoch 2/8
---------------
train Loss: 0.2439
train Accuracy:0.909 Precision:0.890 Recall:0.908 F1:0.899 MCC:0.817.
val Loss: 0.5010
val Accuracy:0.863 Precision:0.916 Recall:0.762 F1:0.832 MCC:0.727.
 
Epoch 3/8
---------------
train Loss: 0.1553
train Accuracy:0.945 Precision:0.933 Recall:0.944 F1:0.939 MCC:0.889.
val Loss: 0.4262
val Accuracy:0.880 Precision:0.865 Recall:0.865 F1:0.865 MCC:0.757.
 
Epoch 4/8
---------------
train Loss: 0.1076
train Accuracy:0.963 Precision:0.954 Recall:0.963 F1:0.959 MCC:0.926.
val Loss: 0.5878
val Accuracy:0.845 Precision:0.779 Recall:0.909 F1:0.839 MCC:0.699.
 
Epoch 5/8
---------------
train Loss: 0.0819
train Accuracy:0.972 Precision:0.966 Recall:0.973 F1:0.969 MCC:0.944.
val Loss: 0.5617
val Accuracy:0.860 Precision:0.798 Recall:0.916 F1:0.853 MCC:0.726.
 
Epoch 6/8
---------------
train Loss: 0.0693
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.5642
val Accuracy:0.873 Precision:0.869 Recall:0.842 F1:0.855 MCC:0.743.
 
Epoch 7/8
---------------
train Loss: 0.0597
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.5042
val Accuracy:0.880 Precision:0.866 Recall:0.863 F1:0.864 MCC:0.756.
 
Epoch 8/8
---------------
train Loss: 0.0553
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.5589
val Accuracy:0.877 Precision:0.884 Recall:0.833 F1:0.857 MCC:0.750.
Training complete in 230m 55s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3847
train Accuracy:0.847 Precision:0.818 Recall:0.845 F1:0.831 MCC:0.692.
val Loss: 0.3619
val Accuracy:0.858 Precision:0.840 Recall:0.842 F1:0.841 MCC:0.713.
 
Epoch 2/8
---------------
train Loss: 0.2538
train Accuracy:0.906 Precision:0.887 Recall:0.904 F1:0.895 MCC:0.811.
val Loss: 0.4493
val Accuracy:0.833 Precision:0.744 Recall:0.952 F1:0.835 MCC:0.692.
 
Epoch 3/8
---------------
train Loss: 0.1638
train Accuracy:0.942 Precision:0.929 Recall:0.941 F1:0.935 MCC:0.882.
val Loss: 0.3752
val Accuracy:0.882 Precision:0.833 Recall:0.919 F1:0.874 MCC:0.767.
 
Epoch 4/8
---------------
train Loss: 0.1111
train Accuracy:0.962 Precision:0.954 Recall:0.961 F1:0.958 MCC:0.923.
val Loss: 0.4689
val Accuracy:0.867 Precision:0.829 Recall:0.884 F1:0.855 MCC:0.734.
 
Epoch 5/8
---------------
train Loss: 0.0850
train Accuracy:0.971 Precision:0.964 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.4316
val Accuracy:0.885 Precision:0.891 Recall:0.844 F1:0.867 MCC:0.766.
 
Epoch 6/8
---------------
train Loss: 0.0712
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.5827
val Accuracy:0.871 Precision:0.913 Recall:0.784 F1:0.843 MCC:0.741.
 
Epoch 7/8
---------------
train Loss: 0.0606
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.977 MCC:0.958.
val Loss: 0.4768
val Accuracy:0.883 Precision:0.877 Recall:0.856 F1:0.867 MCC:0.762.
 
Epoch 8/8
---------------
train Loss: 0.0558
train Accuracy:0.982 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.963.
val Loss: 0.4981
val Accuracy:0.886 Precision:0.923 Recall:0.810 F1:0.863 MCC:0.770.
Training complete in 230m 52s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3644
train Accuracy:0.856 Precision:0.828 Recall:0.853 F1:0.841 MCC:0.710.
val Loss: 0.4681
val Accuracy:0.809 Precision:0.726 Recall:0.913 F1:0.809 MCC:0.639.
 
Epoch 2/8
---------------
train Loss: 0.2255
train Accuracy:0.918 Precision:0.901 Recall:0.915 F1:0.908 MCC:0.834.
val Loss: 0.4335
val Accuracy:0.855 Precision:0.881 Recall:0.779 F1:0.827 MCC:0.707.
 
Epoch 3/8
---------------
train Loss: 0.1461
train Accuracy:0.949 Precision:0.938 Recall:0.947 F1:0.943 MCC:0.896.
val Loss: 0.5921
val Accuracy:0.836 Precision:0.860 Recall:0.753 F1:0.803 MCC:0.668.
 
Epoch 4/8
---------------
train Loss: 0.0986
train Accuracy:0.967 Precision:0.959 Recall:0.966 F1:0.963 MCC:0.933.
val Loss: 0.7638
val Accuracy:0.845 Precision:0.902 Recall:0.731 F1:0.807 MCC:0.691.
 
Epoch 5/8
---------------
train Loss: 0.0774
train Accuracy:0.974 Precision:0.969 Recall:0.973 F1:0.971 MCC:0.948.
val Loss: 0.6774
val Accuracy:0.845 Precision:0.856 Recall:0.782 F1:0.817 MCC:0.685.
 
Epoch 6/8
---------------
train Loss: 0.0658
train Accuracy:0.978 Precision:0.974 Recall:0.978 F1:0.976 MCC:0.956.
val Loss: 0.8274
val Accuracy:0.842 Precision:0.896 Recall:0.728 F1:0.804 MCC:0.684.
 
Epoch 7/8
---------------
train Loss: 0.0577
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.6641
val Accuracy:0.850 Precision:0.885 Recall:0.762 F1:0.819 MCC:0.698.
 
Epoch 8/8
---------------
train Loss: 0.0519
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.980 MCC:0.965.
val Loss: 0.6590
val Accuracy:0.853 Precision:0.832 Recall:0.838 F1:0.835 MCC:0.703.
Training complete in 231m 29s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3589
train Accuracy:0.859 Precision:0.833 Recall:0.855 F1:0.844 MCC:0.716.
val Loss: 0.4612
val Accuracy:0.837 Precision:0.867 Recall:0.746 F1:0.802 MCC:0.670.
 
Epoch 2/8
---------------
train Loss: 0.2240
train Accuracy:0.918 Precision:0.901 Recall:0.916 F1:0.909 MCC:0.835.
val Loss: 0.4698
val Accuracy:0.838 Precision:0.816 Recall:0.819 F1:0.818 MCC:0.672.
 
Epoch 3/8
---------------
train Loss: 0.1447
train Accuracy:0.948 Precision:0.938 Recall:0.947 F1:0.942 MCC:0.896.
val Loss: 0.5385
val Accuracy:0.836 Precision:0.794 Recall:0.852 F1:0.822 MCC:0.673.
 
Epoch 4/8
---------------
train Loss: 0.1008
train Accuracy:0.965 Precision:0.957 Recall:0.965 F1:0.961 MCC:0.930.
val Loss: 0.5931
val Accuracy:0.846 Precision:0.847 Recall:0.796 F1:0.821 MCC:0.687.
 
Epoch 5/8
---------------
train Loss: 0.0784
train Accuracy:0.973 Precision:0.967 Recall:0.974 F1:0.970 MCC:0.946.
val Loss: 0.7103
val Accuracy:0.833 Precision:0.822 Recall:0.797 F1:0.809 MCC:0.661.
 
Epoch 6/8
---------------
train Loss: 0.0657
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.975 MCC:0.956.
val Loss: 0.6451
val Accuracy:0.846 Precision:0.835 Recall:0.813 F1:0.824 MCC:0.686.
 
Epoch 7/8
---------------
train Loss: 0.0569
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.6971
val Accuracy:0.842 Precision:0.808 Recall:0.845 F1:0.826 MCC:0.682.
 
Epoch 8/8
---------------
train Loss: 0.0521
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.7319
val Accuracy:0.845 Precision:0.828 Recall:0.823 F1:0.825 MCC:0.686.
Training complete in 231m 50s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.39508881734146484, 'acc': 0.8507489300998573, 'precision': 0.850729358447812, 'recall': 0.8047963558413719, 'mcc': 0.6968254563063027}, {'loss': 0.39955831914430573, 'acc': 0.8371130952380952, 'precision': 0.7819526450766386, 'recall': 0.8782824222936764, 'mcc': 0.6782323420923564}, {'loss': 0.3618683449356329, 'acc': 0.8582142857142857, 'precision': 0.8396150761828388, 'recall': 0.8416398713826366, 'mcc': 0.7129344733513268}, {'loss': 0.43346488961135426, 'acc': 0.855209823557463, 'precision': 0.8809487608332066, 'recall': 0.7787634408602151, 'mcc': 0.7071199264019326}, {'loss': 0.46121653908766846, 'acc': 0.8367608488316642, 'precision': 0.867333385420736, 'recall': 0.7460349462365592, 'mcc': 0.669998447302514}]
Averge metrics over 5 folds:
average loss:  0.4102393820240852
average accuracy:  0.8476093966882731
average precision:  0.8441158451922464
average recall:  0.8099034073228918
average mcc:  0.6930221290908865
cross-validation finished, end of program
