data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3782
train Accuracy:0.905 Precision:0.745 Recall:0.903 F1:0.816 MCC:0.759.
val Loss: 1.0200
val Accuracy:0.871 Precision:0.830 Recall:0.569 F1:0.675 MCC:0.615.
 
Epoch 2/8
---------------
train Loss: 0.2381
train Accuracy:0.942 Precision:0.834 Recall:0.939 F1:0.884 MCC:0.848.
val Loss: 1.2445
val Accuracy:0.876 Precision:0.839 Recall:0.587 F1:0.691 MCC:0.632.
 
Epoch 3/8
---------------
train Loss: 0.1583
train Accuracy:0.962 Precision:0.885 Recall:0.963 F1:0.922 MCC:0.899.
val Loss: 0.8249
val Accuracy:0.830 Precision:0.600 Recall:0.836 F1:0.699 MCC:0.601.
 
Epoch 4/8
---------------
train Loss: 0.1085
train Accuracy:0.974 Precision:0.919 Recall:0.975 F1:0.946 MCC:0.930.
val Loss: 1.1576
val Accuracy:0.871 Precision:0.728 Recall:0.724 F1:0.726 MCC:0.642.
 
Epoch 5/8
---------------
train Loss: 0.0861
train Accuracy:0.979 Precision:0.934 Recall:0.980 F1:0.957 MCC:0.944.
val Loss: 1.3323
val Accuracy:0.864 Precision:0.705 Recall:0.725 F1:0.715 MCC:0.625.
 
Epoch 6/8
---------------
train Loss: 0.0720
train Accuracy:0.983 Precision:0.946 Recall:0.984 F1:0.965 MCC:0.954.
val Loss: 1.9880
val Accuracy:0.880 Precision:0.948 Recall:0.519 F1:0.671 MCC:0.646.
 
Epoch 7/8
---------------
train Loss: 0.0629
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.968 MCC:0.959.
val Loss: 1.3434
val Accuracy:0.892 Precision:0.802 Recall:0.716 F1:0.757 MCC:0.689.
 
Epoch 8/8
---------------
train Loss: 0.0581
train Accuracy:0.986 Precision:0.956 Recall:0.987 F1:0.971 MCC:0.962.
val Loss: 1.7409
val Accuracy:0.883 Precision:0.917 Recall:0.552 F1:0.689 MCC:0.653.
Training complete in 167m 21s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4183
train Accuracy:0.890 Precision:0.714 Recall:0.885 F1:0.790 MCC:0.724.
val Loss: 0.8517
val Accuracy:0.888 Precision:0.919 Recall:0.573 F1:0.706 MCC:0.669.
 
Epoch 2/8
---------------
train Loss: 0.2425
train Accuracy:0.939 Precision:0.827 Recall:0.937 F1:0.878 MCC:0.841.
val Loss: 0.4430
val Accuracy:0.912 Precision:0.764 Recall:0.902 F1:0.827 MCC:0.773.
 
Epoch 3/8
---------------
train Loss: 0.1594
train Accuracy:0.961 Precision:0.884 Recall:0.961 F1:0.921 MCC:0.896.
val Loss: 0.5230
val Accuracy:0.921 Precision:0.827 Recall:0.837 F1:0.832 MCC:0.780.
 
Epoch 4/8
---------------
train Loss: 0.1123
train Accuracy:0.973 Precision:0.917 Recall:0.972 F1:0.943 MCC:0.926.
val Loss: 0.6410
val Accuracy:0.928 Precision:0.891 Recall:0.789 F1:0.837 MCC:0.793.
 
Epoch 5/8
---------------
train Loss: 0.0961
train Accuracy:0.977 Precision:0.928 Recall:0.976 F1:0.951 MCC:0.937.
val Loss: 0.4571
val Accuracy:0.908 Precision:0.746 Recall:0.922 F1:0.825 MCC:0.771.
 
Epoch 6/8
---------------
train Loss: 0.0795
train Accuracy:0.981 Precision:0.939 Recall:0.981 F1:0.960 MCC:0.947.
val Loss: 0.4724
val Accuracy:0.939 Precision:0.871 Recall:0.866 F1:0.869 MCC:0.829.
 
Epoch 7/8
---------------
train Loss: 0.0685
train Accuracy:0.983 Precision:0.948 Recall:0.983 F1:0.965 MCC:0.955.
val Loss: 0.5206
val Accuracy:0.910 Precision:0.749 Recall:0.923 F1:0.827 MCC:0.775.
 
Epoch 8/8
---------------
train Loss: 0.0603
train Accuracy:0.986 Precision:0.955 Recall:0.986 F1:0.970 MCC:0.961.
val Loss: 0.4809
val Accuracy:0.930 Precision:0.819 Recall:0.902 F1:0.858 MCC:0.814.
Training complete in 167m 34s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4303
train Accuracy:0.887 Precision:0.708 Recall:0.884 F1:0.786 MCC:0.719.
val Loss: 0.3842
val Accuracy:0.927 Precision:0.826 Recall:0.869 F1:0.847 MCC:0.799.
 
Epoch 2/8
---------------
train Loss: 0.2596
train Accuracy:0.934 Precision:0.814 Recall:0.932 F1:0.869 MCC:0.829.
val Loss: 0.4052
val Accuracy:0.913 Precision:0.752 Recall:0.937 F1:0.834 MCC:0.785.
 
Epoch 3/8
---------------
train Loss: 0.1740
train Accuracy:0.957 Precision:0.874 Recall:0.956 F1:0.913 MCC:0.887.
val Loss: 0.4179
val Accuracy:0.943 Precision:0.898 Recall:0.854 F1:0.875 MCC:0.839.
 
Epoch 4/8
---------------
train Loss: 0.1258
train Accuracy:0.969 Precision:0.907 Recall:0.969 F1:0.937 MCC:0.917.
val Loss: 0.4252
val Accuracy:0.939 Precision:0.852 Recall:0.894 F1:0.872 MCC:0.833.
 
Epoch 5/8
---------------
train Loss: 0.0988
train Accuracy:0.976 Precision:0.924 Recall:0.976 F1:0.949 MCC:0.934.
val Loss: 0.3883
val Accuracy:0.929 Precision:0.803 Recall:0.924 F1:0.859 MCC:0.816.
 
Epoch 6/8
---------------
train Loss: 0.0794
train Accuracy:0.981 Precision:0.939 Recall:0.981 F1:0.960 MCC:0.947.
val Loss: 0.4767
val Accuracy:0.919 Precision:0.774 Recall:0.923 F1:0.842 MCC:0.793.
 
Epoch 7/8
---------------
train Loss: 0.0707
train Accuracy:0.983 Precision:0.946 Recall:0.983 F1:0.965 MCC:0.954.
val Loss: 0.4780
val Accuracy:0.941 Precision:0.848 Recall:0.912 F1:0.879 MCC:0.841.
 
Epoch 8/8
---------------
train Loss: 0.0635
train Accuracy:0.985 Precision:0.953 Recall:0.985 F1:0.969 MCC:0.959.
val Loss: 0.6667
val Accuracy:0.937 Precision:0.888 Recall:0.838 F1:0.863 MCC:0.823.
Training complete in 167m 35s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4326
train Accuracy:0.886 Precision:0.707 Recall:0.880 F1:0.784 MCC:0.716.
val Loss: 0.3955
val Accuracy:0.942 Precision:0.920 Recall:0.824 F1:0.869 MCC:0.834.
 
Epoch 2/8
---------------
train Loss: 0.2567
train Accuracy:0.936 Precision:0.818 Recall:0.932 F1:0.871 MCC:0.832.
val Loss: 0.3625
val Accuracy:0.940 Precision:0.878 Recall:0.866 F1:0.872 MCC:0.833.
 
Epoch 3/8
---------------
train Loss: 0.1694
train Accuracy:0.958 Precision:0.875 Recall:0.957 F1:0.914 MCC:0.888.
val Loss: 0.5242
val Accuracy:0.860 Precision:0.628 Recall:0.980 F1:0.766 MCC:0.706.
 
Epoch 4/8
---------------
train Loss: 0.1223
train Accuracy:0.970 Precision:0.910 Recall:0.970 F1:0.939 MCC:0.920.
val Loss: 0.2985
val Accuracy:0.937 Precision:0.827 Recall:0.922 F1:0.872 MCC:0.832.
 
Epoch 5/8
---------------
train Loss: 0.0982
train Accuracy:0.977 Precision:0.927 Recall:0.977 F1:0.951 MCC:0.937.
val Loss: 0.4792
val Accuracy:0.894 Precision:0.706 Recall:0.941 F1:0.807 MCC:0.750.
 
Epoch 6/8
---------------
train Loss: 0.0854
train Accuracy:0.979 Precision:0.934 Recall:0.981 F1:0.957 MCC:0.944.
val Loss: 0.3172
val Accuracy:0.934 Precision:0.805 Recall:0.948 F1:0.871 MCC:0.832.
 
Epoch 7/8
---------------
train Loss: 0.0761
train Accuracy:0.982 Precision:0.942 Recall:0.983 F1:0.962 MCC:0.951.
val Loss: 0.7201
val Accuracy:0.927 Precision:0.938 Recall:0.736 F1:0.825 MCC:0.789.
 
Epoch 8/8
---------------
train Loss: 0.0650
train Accuracy:0.985 Precision:0.952 Recall:0.984 F1:0.968 MCC:0.958.
val Loss: 0.3849
val Accuracy:0.914 Precision:0.748 Recall:0.954 F1:0.838 MCC:0.792.
Training complete in 167m 39s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4079
train Accuracy:0.895 Precision:0.725 Recall:0.892 F1:0.800 MCC:0.737.
val Loss: 0.4821
val Accuracy:0.891 Precision:0.733 Recall:0.842 F1:0.784 MCC:0.715.
 
Epoch 2/8
---------------
train Loss: 0.2447
train Accuracy:0.938 Precision:0.822 Recall:0.938 F1:0.876 MCC:0.838.
val Loss: 0.5250
val Accuracy:0.910 Precision:0.828 Recall:0.780 F1:0.803 MCC:0.746.
 
Epoch 3/8
---------------
train Loss: 0.1569
train Accuracy:0.961 Precision:0.884 Recall:0.962 F1:0.921 MCC:0.897.
val Loss: 0.7343
val Accuracy:0.914 Precision:0.846 Recall:0.775 F1:0.809 MCC:0.755.
 
Epoch 4/8
---------------
train Loss: 0.1111
train Accuracy:0.973 Precision:0.917 Recall:0.974 F1:0.944 MCC:0.927.
val Loss: 0.7668
val Accuracy:0.864 Precision:0.658 Recall:0.872 F1:0.750 MCC:0.671.
 
Epoch 5/8
---------------
train Loss: 0.0933
train Accuracy:0.978 Precision:0.930 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.5912
val Accuracy:0.899 Precision:0.752 Recall:0.845 F1:0.796 MCC:0.731.
 
Epoch 6/8
---------------
train Loss: 0.0738
train Accuracy:0.983 Precision:0.945 Recall:0.983 F1:0.964 MCC:0.952.
val Loss: 0.6481
val Accuracy:0.923 Precision:0.862 Recall:0.800 F1:0.830 MCC:0.781.
 
Epoch 7/8
---------------
train Loss: 0.0667
train Accuracy:0.984 Precision:0.949 Recall:0.985 F1:0.966 MCC:0.956.
val Loss: 0.9187
val Accuracy:0.911 Precision:0.845 Recall:0.761 F1:0.801 MCC:0.746.
 
Epoch 8/8
---------------
train Loss: 0.0641
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.969 MCC:0.959.
val Loss: 0.8676
val Accuracy:0.904 Precision:0.789 Recall:0.805 F1:0.797 MCC:0.734.
Training complete in 167m 46s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.8248889759815986, 'acc': 0.8303104575163399, 'precision': 0.6, 'recall': 0.8364583333333333, 'mcc': 0.6007099688553986}, {'loss': 0.4429644381143446, 'acc': 0.911745406824147, 'precision': 0.7638600652238363, 'recall': 0.9021358543417367, 'mcc': 0.773336567174411}, {'loss': 0.38424016981632536, 'acc': 0.9265501968503937, 'precision': 0.8263692358914599, 'recall': 0.8690476190476191, 'mcc': 0.7993089308122665}, {'loss': 0.2985224804823871, 'acc': 0.9365567585301837, 'precision': 0.8268717626746194, 'recall': 0.9222689075630253, 'mcc': 0.832151427017266}, {'loss': 0.4821062163545156, 'acc': 0.891363188976378, 'precision': 0.7334959597499618, 'recall': 0.8422619047619048, 'mcc': 0.7150432703831929}]
Averge metrics over 5 folds:
average loss:  0.4865444561498343
average accuracy:  0.8993052017394885
average precision:  0.7501194047079756
average recall:  0.8744345238095239
average mcc:  0.744110032848507
cross-validation finished, end of program
