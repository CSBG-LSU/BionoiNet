data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3748
train Accuracy:0.853 Precision:0.825 Recall:0.850 F1:0.837 MCC:0.704.
val Loss: 0.4169
val Accuracy:0.845 Precision:0.834 Recall:0.812 F1:0.823 MCC:0.685.
 
Epoch 2/8
---------------
train Loss: 0.2509
train Accuracy:0.908 Precision:0.891 Recall:0.902 F1:0.897 MCC:0.813.
val Loss: 0.4080
val Accuracy:0.849 Precision:0.822 Recall:0.841 F1:0.831 MCC:0.694.
 
Epoch 3/8
---------------
train Loss: 0.1638
train Accuracy:0.942 Precision:0.930 Recall:0.940 F1:0.935 MCC:0.883.
val Loss: 0.4259
val Accuracy:0.854 Precision:0.825 Recall:0.852 F1:0.838 MCC:0.706.
 
Epoch 4/8
---------------
train Loss: 0.1082
train Accuracy:0.963 Precision:0.955 Recall:0.961 F1:0.958 MCC:0.925.
val Loss: 0.5993
val Accuracy:0.841 Precision:0.789 Recall:0.874 F1:0.829 MCC:0.684.
 
Epoch 5/8
---------------
train Loss: 0.0856
train Accuracy:0.971 Precision:0.966 Recall:0.970 F1:0.968 MCC:0.942.
val Loss: 0.6011
val Accuracy:0.849 Precision:0.826 Recall:0.835 F1:0.830 MCC:0.694.
 
Epoch 6/8
---------------
train Loss: 0.0685
train Accuracy:0.977 Precision:0.972 Recall:0.976 F1:0.974 MCC:0.953.
val Loss: 0.6106
val Accuracy:0.851 Precision:0.848 Recall:0.810 F1:0.828 MCC:0.697.
 
Epoch 7/8
---------------
train Loss: 0.0589
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.6507
val Accuracy:0.846 Precision:0.845 Recall:0.800 F1:0.822 MCC:0.687.
 
Epoch 8/8
---------------
train Loss: 0.0556
train Accuracy:0.982 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.963.
val Loss: 0.6687
val Accuracy:0.845 Precision:0.833 Recall:0.814 F1:0.824 MCC:0.686.
Training complete in 230m 11s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3797
train Accuracy:0.850 Precision:0.819 Recall:0.850 F1:0.834 MCC:0.697.
val Loss: 0.3717
val Accuracy:0.852 Precision:0.796 Recall:0.898 F1:0.844 MCC:0.709.
 
Epoch 2/8
---------------
train Loss: 0.2465
train Accuracy:0.908 Precision:0.888 Recall:0.908 F1:0.898 MCC:0.815.
val Loss: 0.3907
val Accuracy:0.875 Precision:0.898 Recall:0.811 F1:0.853 MCC:0.748.
 
Epoch 3/8
---------------
train Loss: 0.1603
train Accuracy:0.943 Precision:0.930 Recall:0.943 F1:0.936 MCC:0.884.
val Loss: 0.4050
val Accuracy:0.875 Precision:0.847 Recall:0.878 F1:0.862 MCC:0.749.
 
Epoch 4/8
---------------
train Loss: 0.1108
train Accuracy:0.962 Precision:0.953 Recall:0.963 F1:0.958 MCC:0.924.
val Loss: 0.6209
val Accuracy:0.830 Precision:0.758 Recall:0.908 F1:0.826 MCC:0.674.
 
Epoch 5/8
---------------
train Loss: 0.0827
train Accuracy:0.972 Precision:0.965 Recall:0.972 F1:0.969 MCC:0.944.
val Loss: 0.4951
val Accuracy:0.869 Precision:0.826 Recall:0.894 F1:0.859 MCC:0.740.
 
Epoch 6/8
---------------
train Loss: 0.0709
train Accuracy:0.976 Precision:0.970 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.4654
val Accuracy:0.883 Precision:0.856 Recall:0.885 F1:0.870 MCC:0.763.
 
Epoch 7/8
---------------
train Loss: 0.0613
train Accuracy:0.980 Precision:0.974 Recall:0.980 F1:0.977 MCC:0.959.
val Loss: 0.5710
val Accuracy:0.876 Precision:0.898 Recall:0.813 F1:0.853 MCC:0.749.
 
Epoch 8/8
---------------
train Loss: 0.0565
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.4893
val Accuracy:0.883 Precision:0.871 Recall:0.866 F1:0.868 MCC:0.764.
Training complete in 230m 27s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3853
train Accuracy:0.847 Precision:0.817 Recall:0.844 F1:0.830 MCC:0.691.
val Loss: 0.3250
val Accuracy:0.873 Precision:0.852 Recall:0.864 F1:0.858 MCC:0.744.
 
Epoch 2/8
---------------
train Loss: 0.2525
train Accuracy:0.908 Precision:0.889 Recall:0.905 F1:0.897 MCC:0.814.
val Loss: 0.3956
val Accuracy:0.850 Precision:0.773 Recall:0.938 F1:0.848 MCC:0.716.
 
Epoch 3/8
---------------
train Loss: 0.1630
train Accuracy:0.943 Precision:0.931 Recall:0.942 F1:0.936 MCC:0.885.
val Loss: 0.3350
val Accuracy:0.886 Precision:0.863 Recall:0.883 F1:0.873 MCC:0.769.
 
Epoch 4/8
---------------
train Loss: 0.1097
train Accuracy:0.962 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.924.
val Loss: 0.4951
val Accuracy:0.846 Precision:0.800 Recall:0.870 F1:0.834 MCC:0.692.
 
Epoch 5/8
---------------
train Loss: 0.0856
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.4177
val Accuracy:0.878 Precision:0.845 Recall:0.888 F1:0.866 MCC:0.754.
 
Epoch 6/8
---------------
train Loss: 0.0691
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.5956
val Accuracy:0.858 Precision:0.888 Recall:0.778 F1:0.830 MCC:0.713.
 
Epoch 7/8
---------------
train Loss: 0.0608
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.4669
val Accuracy:0.873 Precision:0.834 Recall:0.890 F1:0.861 MCC:0.745.
 
Epoch 8/8
---------------
train Loss: 0.0544
train Accuracy:0.982 Precision:0.977 Recall:0.982 F1:0.980 MCC:0.963.
val Loss: 0.4320
val Accuracy:0.888 Precision:0.888 Recall:0.856 F1:0.872 MCC:0.773.
Training complete in 230m 38s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3640
train Accuracy:0.857 Precision:0.828 Recall:0.856 F1:0.842 MCC:0.712.
val Loss: 0.4183
val Accuracy:0.837 Precision:0.798 Recall:0.845 F1:0.821 MCC:0.672.
 
Epoch 2/8
---------------
train Loss: 0.2259
train Accuracy:0.918 Precision:0.901 Recall:0.915 F1:0.908 MCC:0.834.
val Loss: 0.4135
val Accuracy:0.855 Precision:0.837 Recall:0.835 F1:0.836 MCC:0.706.
 
Epoch 3/8
---------------
train Loss: 0.1459
train Accuracy:0.949 Precision:0.938 Recall:0.947 F1:0.943 MCC:0.896.
val Loss: 0.5216
val Accuracy:0.844 Precision:0.824 Recall:0.826 F1:0.825 MCC:0.685.
 
Epoch 4/8
---------------
train Loss: 0.0997
train Accuracy:0.966 Precision:0.958 Recall:0.966 F1:0.962 MCC:0.931.
val Loss: 0.5903
val Accuracy:0.845 Precision:0.839 Recall:0.806 F1:0.822 MCC:0.686.
 
Epoch 5/8
---------------
train Loss: 0.0776
train Accuracy:0.974 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.947.
val Loss: 0.5884
val Accuracy:0.850 Precision:0.848 Recall:0.805 F1:0.826 MCC:0.694.
 
Epoch 6/8
---------------
train Loss: 0.0651
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.976 MCC:0.956.
val Loss: 0.7926
val Accuracy:0.842 Precision:0.881 Recall:0.745 F1:0.807 MCC:0.682.
 
Epoch 7/8
---------------
train Loss: 0.0586
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.5770
val Accuracy:0.856 Precision:0.841 Recall:0.834 F1:0.837 MCC:0.709.
 
Epoch 8/8
---------------
train Loss: 0.0507
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.8244
val Accuracy:0.841 Precision:0.892 Recall:0.730 F1:0.803 MCC:0.681.
Training complete in 231m 19s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3561
train Accuracy:0.861 Precision:0.833 Recall:0.859 F1:0.846 MCC:0.720.
val Loss: 0.4880
val Accuracy:0.827 Precision:0.857 Recall:0.733 F1:0.790 MCC:0.650.
 
Epoch 2/8
---------------
train Loss: 0.2207
train Accuracy:0.919 Precision:0.903 Recall:0.916 F1:0.910 MCC:0.837.
val Loss: 0.5081
val Accuracy:0.841 Precision:0.834 Recall:0.799 F1:0.816 MCC:0.676.
 
Epoch 3/8
---------------
train Loss: 0.1421
train Accuracy:0.950 Precision:0.939 Recall:0.949 F1:0.944 MCC:0.899.
val Loss: 0.5840
val Accuracy:0.839 Precision:0.801 Recall:0.846 F1:0.823 MCC:0.676.
 
Epoch 4/8
---------------
train Loss: 0.1025
train Accuracy:0.965 Precision:0.957 Recall:0.964 F1:0.961 MCC:0.929.
val Loss: 0.6942
val Accuracy:0.832 Precision:0.861 Recall:0.741 F1:0.796 MCC:0.660.
 
Epoch 5/8
---------------
train Loss: 0.0804
train Accuracy:0.973 Precision:0.967 Recall:0.972 F1:0.970 MCC:0.946.
val Loss: 0.6403
val Accuracy:0.853 Precision:0.841 Recall:0.824 F1:0.832 MCC:0.701.
 
Epoch 6/8
---------------
train Loss: 0.0666
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.6116
val Accuracy:0.847 Precision:0.802 Recall:0.868 F1:0.834 MCC:0.694.
 
Epoch 7/8
---------------
train Loss: 0.0574
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.7773
val Accuracy:0.839 Precision:0.844 Recall:0.781 F1:0.811 MCC:0.672.
 
Epoch 8/8
---------------
train Loss: 0.0529
train Accuracy:0.983 Precision:0.978 Recall:0.983 F1:0.980 MCC:0.965.
val Loss: 0.7126
val Accuracy:0.850 Precision:0.825 Recall:0.841 F1:0.833 MCC:0.698.
Training complete in 231m 38s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.408023734394987, 'acc': 0.8486685687113648, 'precision': 0.8219007723524021, 'recall': 0.8411709539121115, 'mcc': 0.6943234078500785}, {'loss': 0.3717061761660235, 'acc': 0.8523809523809524, 'precision': 0.7960323117129959, 'recall': 0.8977759914255091, 'mcc': 0.7094202521732506}, {'loss': 0.32503887540527754, 'acc': 0.8732440476190476, 'precision': 0.8524146131994451, 'recall': 0.8643488745980707, 'mcc': 0.7437194902808391}, {'loss': 0.4135182678386832, 'acc': 0.8548223652837387, 'precision': 0.8372531841768314, 'recall': 0.8349462365591398, 'mcc': 0.7058078299401184}, {'loss': 0.4880080113580924, 'acc': 0.8270147830233667, 'precision': 0.8565928021373566, 'recall': 0.7325940860215053, 'mcc': 0.6500128758482994}]
Averge metrics over 5 folds:
average loss:  0.4012590130326127
average accuracy:  0.8512261434036941
average precision:  0.8328387367158061
average recall:  0.8341672285032672
average mcc:  0.7006567712185172
cross-validation finished, end of program
