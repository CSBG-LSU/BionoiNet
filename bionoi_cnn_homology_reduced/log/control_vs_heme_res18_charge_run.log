data directory: ../../bionoi_output/charge/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/heme/fold_2', '../../bionoi_output/charge/heme/fold_3', '../../bionoi_output/charge/heme/fold_4', '../../bionoi_output/charge/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4886
train Accuracy:0.867 Precision:0.665 Recall:0.875 F1:0.756 MCC:0.679.
val Loss: 1.7230
val Accuracy:0.799 Precision:0.645 Recall:0.327 F1:0.434 MCC:0.355.
 
Epoch 2/8
---------------
train Loss: 0.3191
train Accuracy:0.916 Precision:0.766 Recall:0.920 F1:0.836 MCC:0.786.
val Loss: 0.8254
val Accuracy:0.848 Precision:0.670 Recall:0.698 F1:0.684 MCC:0.585.
 
Epoch 3/8
---------------
train Loss: 0.2241
train Accuracy:0.943 Precision:0.830 Recall:0.950 F1:0.886 MCC:0.851.
val Loss: 0.8343
val Accuracy:0.779 Precision:0.519 Recall:0.827 F1:0.637 MCC:0.518.
 
Epoch 4/8
---------------
train Loss: 0.1636
train Accuracy:0.958 Precision:0.871 Recall:0.963 F1:0.914 MCC:0.888.
val Loss: 1.7948
val Accuracy:0.854 Precision:0.777 Recall:0.534 F1:0.633 MCC:0.561.
 
Epoch 5/8
---------------
train Loss: 0.1302
train Accuracy:0.967 Precision:0.898 Recall:0.971 F1:0.933 MCC:0.913.
val Loss: 0.9711
val Accuracy:0.833 Precision:0.619 Recall:0.755 F1:0.680 MCC:0.574.
 
Epoch 6/8
---------------
train Loss: 0.1050
train Accuracy:0.974 Precision:0.917 Recall:0.977 F1:0.946 MCC:0.930.
val Loss: 1.9678
val Accuracy:0.868 Precision:0.847 Recall:0.536 F1:0.656 MCC:0.603.
 
Epoch 7/8
---------------
train Loss: 0.0905
train Accuracy:0.978 Precision:0.928 Recall:0.980 F1:0.953 MCC:0.939.
val Loss: 1.3468
val Accuracy:0.849 Precision:0.686 Recall:0.660 F1:0.673 MCC:0.575.
 
Epoch 8/8
---------------
train Loss: 0.0853
train Accuracy:0.979 Precision:0.933 Recall:0.981 F1:0.956 MCC:0.943.
val Loss: 1.6462
val Accuracy:0.856 Precision:0.715 Recall:0.644 F1:0.678 MCC:0.587.
Training complete in 167m 38s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/heme/fold_1', '../../bionoi_output/charge/heme/fold_3', '../../bionoi_output/charge/heme/fold_4', '../../bionoi_output/charge/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5353
train Accuracy:0.853 Precision:0.641 Recall:0.855 F1:0.732 MCC:0.647.
val Loss: 0.7642
val Accuracy:0.869 Precision:0.765 Recall:0.636 F1:0.694 MCC:0.616.
 
Epoch 2/8
---------------
train Loss: 0.3610
train Accuracy:0.903 Precision:0.738 Recall:0.909 F1:0.815 MCC:0.757.
val Loss: 0.8933
val Accuracy:0.769 Precision:0.504 Recall:0.932 F1:0.654 MCC:0.557.
 
Epoch 3/8
---------------
train Loss: 0.2559
train Accuracy:0.933 Precision:0.805 Recall:0.942 F1:0.868 MCC:0.828.
val Loss: 0.7579
val Accuracy:0.896 Precision:0.797 Recall:0.749 F1:0.772 MCC:0.706.
 
Epoch 4/8
---------------
train Loss: 0.1869
train Accuracy:0.951 Precision:0.851 Recall:0.958 F1:0.901 MCC:0.871.
val Loss: 0.6816
val Accuracy:0.898 Precision:0.777 Recall:0.789 F1:0.783 MCC:0.716.
 
Epoch 5/8
---------------
train Loss: 0.1452
train Accuracy:0.962 Precision:0.882 Recall:0.969 F1:0.924 MCC:0.901.
val Loss: 0.7877
val Accuracy:0.850 Precision:0.624 Recall:0.903 F1:0.738 MCC:0.659.
 
Epoch 6/8
---------------
train Loss: 0.1190
train Accuracy:0.970 Precision:0.906 Recall:0.973 F1:0.938 MCC:0.920.
val Loss: 0.7575
val Accuracy:0.832 Precision:0.593 Recall:0.905 F1:0.716 MCC:0.632.
 
Epoch 7/8
---------------
train Loss: 0.1062
train Accuracy:0.973 Precision:0.915 Recall:0.976 F1:0.944 MCC:0.927.
val Loss: 0.7451
val Accuracy:0.901 Precision:0.752 Recall:0.863 F1:0.804 MCC:0.741.
 
Epoch 8/8
---------------
train Loss: 0.0933
train Accuracy:0.977 Precision:0.926 Recall:0.980 F1:0.952 MCC:0.937.
val Loss: 0.8904
val Accuracy:0.901 Precision:0.806 Recall:0.760 F1:0.782 MCC:0.719.
Training complete in 167m 39s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/heme/fold_1', '../../bionoi_output/charge/heme/fold_2', '../../bionoi_output/charge/heme/fold_4', '../../bionoi_output/charge/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5641
train Accuracy:0.839 Precision:0.614 Recall:0.850 F1:0.713 MCC:0.621.
val Loss: 0.5197
val Accuracy:0.905 Precision:0.823 Recall:0.756 F1:0.788 MCC:0.728.
 
Epoch 2/8
---------------
train Loss: 0.3810
train Accuracy:0.897 Precision:0.723 Recall:0.908 F1:0.805 MCC:0.745.
val Loss: 0.4235
val Accuracy:0.919 Precision:0.787 Recall:0.900 F1:0.840 MCC:0.789.
 
Epoch 3/8
---------------
train Loss: 0.2750
train Accuracy:0.926 Precision:0.788 Recall:0.936 F1:0.856 MCC:0.812.
val Loss: 0.4241
val Accuracy:0.892 Precision:0.706 Recall:0.926 F1:0.801 MCC:0.741.
 
Epoch 4/8
---------------
train Loss: 0.2061
train Accuracy:0.946 Precision:0.840 Recall:0.953 F1:0.893 MCC:0.860.
val Loss: 0.4099
val Accuracy:0.921 Precision:0.783 Recall:0.916 F1:0.844 MCC:0.796.
 
Epoch 5/8
---------------
train Loss: 0.1586
train Accuracy:0.959 Precision:0.874 Recall:0.966 F1:0.918 MCC:0.893.
val Loss: 1.2380
val Accuracy:0.888 Precision:0.935 Recall:0.560 F1:0.701 MCC:0.668.
 
Epoch 6/8
---------------
train Loss: 0.1311
train Accuracy:0.967 Precision:0.897 Recall:0.971 F1:0.933 MCC:0.913.
val Loss: 0.5052
val Accuracy:0.922 Precision:0.789 Recall:0.912 F1:0.846 MCC:0.798.
 
Epoch 7/8
---------------
train Loss: 0.1137
train Accuracy:0.972 Precision:0.910 Recall:0.975 F1:0.941 MCC:0.924.
val Loss: 0.7432
val Accuracy:0.931 Precision:0.849 Recall:0.855 F1:0.852 MCC:0.807.
 
Epoch 8/8
---------------
train Loss: 0.1002
train Accuracy:0.975 Precision:0.920 Recall:0.977 F1:0.948 MCC:0.932.
val Loss: 0.6064
val Accuracy:0.898 Precision:0.735 Recall:0.881 F1:0.801 MCC:0.739.
Training complete in 167m 30s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/heme/fold_1', '../../bionoi_output/charge/heme/fold_2', '../../bionoi_output/charge/heme/fold_3', '../../bionoi_output/charge/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5491
train Accuracy:0.847 Precision:0.628 Recall:0.855 F1:0.724 MCC:0.636.
val Loss: 1.0871
val Accuracy:0.854 Precision:0.935 Recall:0.403 F1:0.563 MCC:0.554.
 
Epoch 2/8
---------------
train Loss: 0.3702
train Accuracy:0.900 Precision:0.729 Recall:0.913 F1:0.811 MCC:0.753.
val Loss: 0.4064
val Accuracy:0.913 Precision:0.771 Recall:0.895 F1:0.828 MCC:0.774.
 
Epoch 3/8
---------------
train Loss: 0.2640
train Accuracy:0.929 Precision:0.795 Recall:0.941 F1:0.862 MCC:0.820.
val Loss: 0.7097
val Accuracy:0.788 Precision:0.526 Recall:0.955 F1:0.678 MCC:0.592.
 
Epoch 4/8
---------------
train Loss: 0.1883
train Accuracy:0.951 Precision:0.851 Recall:0.958 F1:0.901 MCC:0.871.
val Loss: 0.4351
val Accuracy:0.911 Precision:0.767 Recall:0.893 F1:0.825 MCC:0.770.
 
Epoch 5/8
---------------
train Loss: 0.1483
train Accuracy:0.962 Precision:0.883 Recall:0.967 F1:0.923 MCC:0.899.
val Loss: 0.5602
val Accuracy:0.864 Precision:0.647 Recall:0.926 F1:0.762 MCC:0.692.
 
Epoch 6/8
---------------
train Loss: 0.1257
train Accuracy:0.968 Precision:0.898 Recall:0.972 F1:0.934 MCC:0.914.
val Loss: 0.5565
val Accuracy:0.893 Precision:0.715 Recall:0.903 F1:0.798 MCC:0.736.
 
Epoch 7/8
---------------
train Loss: 0.1032
train Accuracy:0.974 Precision:0.918 Recall:0.977 F1:0.946 MCC:0.930.
val Loss: 0.5163
val Accuracy:0.892 Precision:0.710 Recall:0.915 F1:0.799 MCC:0.738.
 
Epoch 8/8
---------------
train Loss: 0.0942
train Accuracy:0.977 Precision:0.927 Recall:0.979 F1:0.952 MCC:0.938.
val Loss: 0.9888
val Accuracy:0.787 Precision:0.525 Recall:0.961 F1:0.679 MCC:0.595.
Training complete in 167m 26s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/heme/fold_1', '../../bionoi_output/charge/heme/fold_2', '../../bionoi_output/charge/heme/fold_3', '../../bionoi_output/charge/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5298
train Accuracy:0.855 Precision:0.644 Recall:0.856 F1:0.735 MCC:0.650.
val Loss: 0.4972
val Accuracy:0.873 Precision:0.683 Recall:0.857 F1:0.760 MCC:0.683.
 
Epoch 2/8
---------------
train Loss: 0.3548
train Accuracy:0.906 Precision:0.745 Recall:0.912 F1:0.820 MCC:0.764.
val Loss: 0.5887
val Accuracy:0.828 Precision:0.587 Recall:0.906 F1:0.712 MCC:0.627.
 
Epoch 3/8
---------------
train Loss: 0.2530
train Accuracy:0.934 Precision:0.810 Recall:0.939 F1:0.870 MCC:0.830.
val Loss: 0.5648
val Accuracy:0.857 Precision:0.638 Recall:0.897 F1:0.746 MCC:0.668.
 
Epoch 4/8
---------------
train Loss: 0.1836
train Accuracy:0.952 Precision:0.855 Recall:0.958 F1:0.904 MCC:0.874.
val Loss: 1.5144
val Accuracy:0.874 Precision:0.894 Recall:0.525 F1:0.662 MCC:0.623.
 
Epoch 5/8
---------------
train Loss: 0.1436
train Accuracy:0.964 Precision:0.888 Recall:0.967 F1:0.926 MCC:0.904.
val Loss: 0.6051
val Accuracy:0.890 Precision:0.736 Recall:0.829 F1:0.779 MCC:0.709.
 
Epoch 6/8
---------------
train Loss: 0.1195
train Accuracy:0.970 Precision:0.905 Recall:0.972 F1:0.938 MCC:0.919.
val Loss: 1.1973
val Accuracy:0.895 Precision:0.863 Recall:0.655 F1:0.745 MCC:0.690.
 
Epoch 7/8
---------------
train Loss: 0.1029
train Accuracy:0.974 Precision:0.919 Recall:0.976 F1:0.947 MCC:0.931.
val Loss: 0.8114
val Accuracy:0.884 Precision:0.746 Recall:0.765 F1:0.755 MCC:0.680.
 
Epoch 8/8
---------------
train Loss: 0.0896
train Accuracy:0.978 Precision:0.931 Recall:0.979 F1:0.955 MCC:0.941.
val Loss: 0.8384
val Accuracy:0.900 Precision:0.816 Recall:0.738 F1:0.775 MCC:0.712.
Training complete in 167m 35s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.8254482635193401, 'acc': 0.8482843137254902, 'precision': 0.6705, 'recall': 0.6984375, 'mcc': 0.5846105494839553}, {'loss': 0.6815684990825381, 'acc': 0.8976788057742782, 'precision': 0.7772797793483882, 'recall': 0.789390756302521, 'mcc': 0.716359496440877}, {'loss': 0.4099442697743692, 'acc': 0.9207677165354331, 'precision': 0.7829341317365269, 'recall': 0.9156162464985994, 'mcc': 0.7957722746800203}, {'loss': 0.40638253011122305, 'acc': 0.9129347112860893, 'precision': 0.7705412332278004, 'recall': 0.8947829131652661, 'mcc': 0.7740305838257728}, {'loss': 0.49716947533757355, 'acc': 0.8731955380577427, 'precision': 0.6828077030421434, 'recall': 0.8566176470588235, 'mcc': 0.6832488263589022}]
Averge metrics over 5 folds:
average loss:  0.5641026075650089
average accuracy:  0.8905722170758068
average precision:  0.7368125694709718
average recall:  0.830969012605042
average mcc:  0.7108043461579056
cross-validation finished, end of program
