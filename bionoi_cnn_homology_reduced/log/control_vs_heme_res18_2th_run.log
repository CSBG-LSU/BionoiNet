data directory: ../../data_homology_reduced/images/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4798
train Accuracy:0.878 Precision:0.688 Recall:0.877 F1:0.771 MCC:0.698.
val Loss: 0.7354
val Accuracy:0.848 Precision:0.664 Recall:0.721 F1:0.691 MCC:0.592.
 
Epoch 2/8
---------------
train Loss: 0.3872
train Accuracy:0.904 Precision:0.747 Recall:0.896 F1:0.815 MCC:0.757.
val Loss: 0.7229
val Accuracy:0.848 Precision:0.646 Recall:0.782 F1:0.707 MCC:0.611.
 
Epoch 3/8
---------------
train Loss: 0.3372
train Accuracy:0.918 Precision:0.777 Recall:0.911 F1:0.838 MCC:0.788.
val Loss: 0.7450
val Accuracy:0.882 Precision:0.772 Recall:0.709 F1:0.739 MCC:0.664.
 
Epoch 4/8
---------------
train Loss: 0.2850
train Accuracy:0.931 Precision:0.808 Recall:0.925 F1:0.862 MCC:0.820.
val Loss: 0.7685
val Accuracy:0.825 Precision:0.596 Recall:0.792 F1:0.680 MCC:0.573.
 
Epoch 5/8
---------------
train Loss: 0.2306
train Accuracy:0.944 Precision:0.840 Recall:0.938 F1:0.887 MCC:0.852.
val Loss: 0.6870
val Accuracy:0.818 Precision:0.579 Recall:0.830 F1:0.682 MCC:0.578.
 
Epoch 6/8
---------------
train Loss: 0.1856
train Accuracy:0.954 Precision:0.865 Recall:0.954 F1:0.908 MCC:0.879.
val Loss: 1.8717
val Accuracy:0.874 Precision:0.926 Recall:0.503 F1:0.652 MCC:0.623.
 
Epoch 7/8
---------------
train Loss: 0.1555
train Accuracy:0.962 Precision:0.886 Recall:0.961 F1:0.922 MCC:0.898.
val Loss: 1.2682
val Accuracy:0.878 Precision:0.800 Recall:0.643 F1:0.713 MCC:0.643.
 
Epoch 8/8
---------------
train Loss: 0.1311
train Accuracy:0.967 Precision:0.900 Recall:0.968 F1:0.933 MCC:0.912.
val Loss: 1.4036
val Accuracy:0.883 Precision:0.826 Recall:0.636 F1:0.719 MCC:0.655.
Training complete in 156m 42s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5579
train Accuracy:0.852 Precision:0.639 Recall:0.846 F1:0.728 MCC:0.640.
val Loss: 1.1125
val Accuracy:0.823 Precision:0.708 Recall:0.417 F1:0.525 MCC:0.447.
 
Epoch 2/8
---------------
train Loss: 0.4405
train Accuracy:0.888 Precision:0.713 Recall:0.875 F1:0.786 MCC:0.718.
val Loss: 0.8540
val Accuracy:0.726 Precision:0.460 Recall:0.970 F1:0.624 MCC:0.527.
 
Epoch 3/8
---------------
train Loss: 0.3728
train Accuracy:0.905 Precision:0.749 Recall:0.893 F1:0.815 MCC:0.757.
val Loss: 0.4080
val Accuracy:0.880 Precision:0.688 Recall:0.894 F1:0.778 MCC:0.709.
 
Epoch 4/8
---------------
train Loss: 0.3038
train Accuracy:0.923 Precision:0.788 Recall:0.918 F1:0.848 MCC:0.801.
val Loss: 0.3928
val Accuracy:0.905 Precision:0.752 Recall:0.887 F1:0.813 MCC:0.755.
 
Epoch 5/8
---------------
train Loss: 0.2471
train Accuracy:0.937 Precision:0.820 Recall:0.935 F1:0.874 MCC:0.835.
val Loss: 0.5807
val Accuracy:0.917 Precision:0.901 Recall:0.724 F1:0.803 MCC:0.758.
 
Epoch 6/8
---------------
train Loss: 0.2017
train Accuracy:0.949 Precision:0.850 Recall:0.948 F1:0.896 MCC:0.865.
val Loss: 0.4171
val Accuracy:0.885 Precision:0.685 Recall:0.943 F1:0.793 MCC:0.734.
 
Epoch 7/8
---------------
train Loss: 0.1630
train Accuracy:0.959 Precision:0.876 Recall:0.959 F1:0.916 MCC:0.890.
val Loss: 0.5994
val Accuracy:0.921 Precision:0.868 Recall:0.783 F1:0.823 MCC:0.775.
 
Epoch 8/8
---------------
train Loss: 0.1362
train Accuracy:0.966 Precision:0.897 Recall:0.966 F1:0.930 MCC:0.909.
val Loss: 0.5666
val Accuracy:0.906 Precision:0.752 Recall:0.891 F1:0.816 MCC:0.758.
Training complete in 156m 56s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5577
train Accuracy:0.846 Precision:0.627 Recall:0.847 F1:0.721 MCC:0.631.
val Loss: 0.5417
val Accuracy:0.804 Precision:0.548 Recall:0.946 F1:0.694 MCC:0.610.
 
Epoch 2/8
---------------
train Loss: 0.4298
train Accuracy:0.886 Precision:0.706 Recall:0.881 F1:0.784 MCC:0.716.
val Loss: 0.3541
val Accuracy:0.912 Precision:0.752 Recall:0.930 F1:0.832 MCC:0.781.
 
Epoch 3/8
---------------
train Loss: 0.3549
train Accuracy:0.907 Precision:0.753 Recall:0.901 F1:0.820 MCC:0.764.
val Loss: 0.3901
val Accuracy:0.919 Precision:0.787 Recall:0.900 F1:0.840 MCC:0.789.
 
Epoch 4/8
---------------
train Loss: 0.2902
train Accuracy:0.925 Precision:0.791 Recall:0.922 F1:0.851 MCC:0.805.
val Loss: 0.3916
val Accuracy:0.935 Precision:0.850 Recall:0.876 F1:0.863 MCC:0.820.
 
Epoch 5/8
---------------
train Loss: 0.2283
train Accuracy:0.942 Precision:0.834 Recall:0.941 F1:0.884 MCC:0.848.
val Loss: 0.4289
val Accuracy:0.935 Precision:0.846 Recall:0.885 F1:0.865 MCC:0.822.
 
Epoch 6/8
---------------
train Loss: 0.1769
train Accuracy:0.956 Precision:0.868 Recall:0.957 F1:0.910 MCC:0.883.
val Loss: 0.5074
val Accuracy:0.882 Precision:0.686 Recall:0.912 F1:0.783 MCC:0.717.
 
Epoch 7/8
---------------
train Loss: 0.1457
train Accuracy:0.963 Precision:0.886 Recall:0.965 F1:0.924 MCC:0.901.
val Loss: 0.4629
val Accuracy:0.910 Precision:0.750 Recall:0.922 F1:0.827 MCC:0.775.
 
Epoch 8/8
---------------
train Loss: 0.1201
train Accuracy:0.970 Precision:0.906 Recall:0.972 F1:0.938 MCC:0.919.
val Loss: 0.5210
val Accuracy:0.917 Precision:0.768 Recall:0.923 F1:0.838 MCC:0.788.
Training complete in 156m 42s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5667
train Accuracy:0.846 Precision:0.629 Recall:0.838 F1:0.719 MCC:0.628.
val Loss: 0.4819
val Accuracy:0.915 Precision:0.818 Recall:0.820 F1:0.819 MCC:0.763.
 
Epoch 2/8
---------------
train Loss: 0.4457
train Accuracy:0.886 Precision:0.708 Recall:0.870 F1:0.781 MCC:0.712.
val Loss: 0.3776
val Accuracy:0.862 Precision:0.637 Recall:0.954 F1:0.764 MCC:0.699.
 
Epoch 3/8
---------------
train Loss: 0.3754
train Accuracy:0.906 Precision:0.751 Recall:0.894 F1:0.816 MCC:0.759.
val Loss: 0.3190
val Accuracy:0.891 Precision:0.692 Recall:0.960 F1:0.804 MCC:0.750.
 
Epoch 4/8
---------------
train Loss: 0.3025
train Accuracy:0.924 Precision:0.791 Recall:0.918 F1:0.850 MCC:0.803.
val Loss: 0.3376
val Accuracy:0.921 Precision:0.786 Recall:0.910 F1:0.843 MCC:0.795.
 
Epoch 5/8
---------------
train Loss: 0.2348
train Accuracy:0.940 Precision:0.826 Recall:0.940 F1:0.879 MCC:0.843.
val Loss: 0.3426
val Accuracy:0.900 Precision:0.716 Recall:0.949 F1:0.817 MCC:0.764.
 
Epoch 6/8
---------------
train Loss: 0.1849
train Accuracy:0.951 Precision:0.856 Recall:0.953 F1:0.902 MCC:0.872.
val Loss: 0.3777
val Accuracy:0.914 Precision:0.768 Recall:0.908 F1:0.832 MCC:0.780.
 
Epoch 7/8
---------------
train Loss: 0.1506
train Accuracy:0.962 Precision:0.883 Recall:0.964 F1:0.922 MCC:0.898.
val Loss: 0.3507
val Accuracy:0.933 Precision:0.843 Recall:0.879 F1:0.861 MCC:0.817.
 
Epoch 8/8
---------------
train Loss: 0.1296
train Accuracy:0.967 Precision:0.898 Recall:0.970 F1:0.933 MCC:0.912.
val Loss: 0.4248
val Accuracy:0.906 Precision:0.735 Recall:0.937 F1:0.824 MCC:0.772.
Training complete in 156m 57s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5482
train Accuracy:0.855 Precision:0.643 Recall:0.856 F1:0.734 MCC:0.649.
val Loss: 0.5577
val Accuracy:0.879 Precision:0.726 Recall:0.779 F1:0.751 MCC:0.672.
 
Epoch 2/8
---------------
train Loss: 0.4363
train Accuracy:0.888 Precision:0.712 Recall:0.879 F1:0.787 MCC:0.719.
val Loss: 0.4665
val Accuracy:0.892 Precision:0.745 Recall:0.817 F1:0.779 MCC:0.709.
 
Epoch 3/8
---------------
train Loss: 0.3725
train Accuracy:0.905 Precision:0.748 Recall:0.899 F1:0.816 MCC:0.759.
val Loss: 0.5200
val Accuracy:0.866 Precision:0.678 Recall:0.814 F1:0.740 MCC:0.655.
 
Epoch 4/8
---------------
train Loss: 0.3095
train Accuracy:0.922 Precision:0.786 Recall:0.920 F1:0.847 MCC:0.800.
val Loss: 0.5555
val Accuracy:0.908 Precision:0.841 Recall:0.751 F1:0.793 MCC:0.736.
 
Epoch 5/8
---------------
train Loss: 0.2641
train Accuracy:0.934 Precision:0.812 Recall:0.933 F1:0.868 MCC:0.828.
val Loss: 0.5720
val Accuracy:0.910 Precision:0.817 Recall:0.794 F1:0.805 MCC:0.747.
 
Epoch 6/8
---------------
train Loss: 0.2207
train Accuracy:0.944 Precision:0.837 Recall:0.945 F1:0.887 MCC:0.853.
val Loss: 0.4838
val Accuracy:0.848 Precision:0.618 Recall:0.918 F1:0.739 MCC:0.662.
 
Epoch 7/8
---------------
train Loss: 0.1842
train Accuracy:0.953 Precision:0.860 Recall:0.956 F1:0.905 MCC:0.876.
val Loss: 0.7575
val Accuracy:0.915 Precision:0.859 Recall:0.759 F1:0.806 MCC:0.754.
 
Epoch 8/8
---------------
train Loss: 0.1579
train Accuracy:0.961 Precision:0.881 Recall:0.962 F1:0.920 MCC:0.895.
val Loss: 0.6047
val Accuracy:0.889 Precision:0.739 Recall:0.812 F1:0.774 MCC:0.702.
Training complete in 157m 3s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.6870156097061494, 'acc': 0.8177696078431372, 'precision': 0.5785653804282085, 'recall': 0.8303819444444445, 'mcc': 0.5778657766129259}, {'loss': 0.3927910779199497, 'acc': 0.9047736220472441, 'precision': 0.7515583259127337, 'recall': 0.8865546218487395, 'mcc': 0.7547543286925333}, {'loss': 0.35414134703205014, 'acc': 0.9117043963254593, 'precision': 0.751732918376008, 'recall': 0.9303221288515406, 'mcc': 0.7806880658230851}, {'loss': 0.3189970376532222, 'acc': 0.8906660104986877, 'precision': 0.6922494319616258, 'recall': 0.9600840336134454, 'mcc': 0.7501612454343844}, {'loss': 0.4664774044096626, 'acc': 0.8915272309711286, 'precision': 0.7446163662466103, 'recall': 0.8172268907563025, 'mcc': 0.7088849688448288}]
Averge metrics over 5 folds:
average loss:  0.4438844953442068
average accuracy:  0.8832881735371314
average precision:  0.7037444845850374
average recall:  0.8849139239028945
average mcc:  0.7144708770815515
cross-validation finished, end of program
