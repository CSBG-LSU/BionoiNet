data directory: ../../bionoi_output/binding_prob/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/nucleotide/fold_2', '../../bionoi_output/binding_prob/nucleotide/fold_3', '../../bionoi_output/binding_prob/nucleotide/fold_4', '../../bionoi_output/binding_prob/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4216
train Accuracy:0.830 Precision:0.792 Recall:0.838 F1:0.814 MCC:0.659.
val Loss: 0.4933
val Accuracy:0.811 Precision:0.756 Recall:0.847 F1:0.799 MCC:0.624.
 
Epoch 2/8
---------------
train Loss: 0.3052
train Accuracy:0.884 Precision:0.856 Recall:0.887 F1:0.871 MCC:0.766.
val Loss: 0.4825
val Accuracy:0.825 Precision:0.819 Recall:0.776 F1:0.797 MCC:0.644.
 
Epoch 3/8
---------------
train Loss: 0.2099
train Accuracy:0.924 Precision:0.905 Recall:0.926 F1:0.915 MCC:0.846.
val Loss: 0.5167
val Accuracy:0.820 Precision:0.774 Recall:0.840 F1:0.806 MCC:0.641.
 
Epoch 4/8
---------------
train Loss: 0.1431
train Accuracy:0.950 Precision:0.938 Recall:0.949 F1:0.944 MCC:0.898.
val Loss: 0.6250
val Accuracy:0.819 Precision:0.832 Recall:0.741 F1:0.784 MCC:0.632.
 
Epoch 5/8
---------------
train Loss: 0.1066
train Accuracy:0.963 Precision:0.955 Recall:0.963 F1:0.959 MCC:0.926.
val Loss: 0.7336
val Accuracy:0.807 Precision:0.767 Recall:0.811 F1:0.788 MCC:0.612.
 
Epoch 6/8
---------------
train Loss: 0.0859
train Accuracy:0.971 Precision:0.964 Recall:0.972 F1:0.968 MCC:0.942.
val Loss: 0.7274
val Accuracy:0.814 Precision:0.836 Recall:0.723 F1:0.775 MCC:0.623.
 
Epoch 7/8
---------------
train Loss: 0.0717
train Accuracy:0.976 Precision:0.970 Recall:0.975 F1:0.973 MCC:0.951.
val Loss: 0.7237
val Accuracy:0.814 Precision:0.795 Recall:0.784 F1:0.789 MCC:0.624.
 
Epoch 8/8
---------------
train Loss: 0.0650
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.976 MCC:0.956.
val Loss: 0.8839
val Accuracy:0.810 Precision:0.875 Recall:0.667 F1:0.757 MCC:0.620.
Training complete in 230m 58s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/nucleotide/fold_1', '../../bionoi_output/binding_prob/nucleotide/fold_3', '../../bionoi_output/binding_prob/nucleotide/fold_4', '../../bionoi_output/binding_prob/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4384
train Accuracy:0.820 Precision:0.778 Recall:0.830 F1:0.803 MCC:0.639.
val Loss: 0.4090
val Accuracy:0.847 Precision:0.853 Recall:0.793 F1:0.822 MCC:0.690.
 
Epoch 2/8
---------------
train Loss: 0.3296
train Accuracy:0.871 Precision:0.839 Recall:0.879 F1:0.859 MCC:0.741.
val Loss: 0.4089
val Accuracy:0.846 Precision:0.825 Recall:0.828 F1:0.827 MCC:0.688.
 
Epoch 3/8
---------------
train Loss: 0.2382
train Accuracy:0.912 Precision:0.888 Recall:0.917 F1:0.902 MCC:0.822.
val Loss: 0.4569
val Accuracy:0.848 Precision:0.821 Recall:0.842 F1:0.831 MCC:0.693.
 
Epoch 4/8
---------------
train Loss: 0.1624
train Accuracy:0.942 Precision:0.928 Recall:0.944 F1:0.936 MCC:0.884.
val Loss: 0.5637
val Accuracy:0.839 Precision:0.775 Recall:0.898 F1:0.832 MCC:0.685.
 
Epoch 5/8
---------------
train Loss: 0.1186
train Accuracy:0.958 Precision:0.946 Recall:0.960 F1:0.953 MCC:0.915.
val Loss: 0.6595
val Accuracy:0.823 Precision:0.741 Recall:0.923 F1:0.822 MCC:0.665.
 
Epoch 6/8
---------------
train Loss: 0.0936
train Accuracy:0.968 Precision:0.959 Recall:0.969 F1:0.964 MCC:0.935.
val Loss: 0.5909
val Accuracy:0.839 Precision:0.799 Recall:0.851 F1:0.824 MCC:0.677.
 
Epoch 7/8
---------------
train Loss: 0.0781
train Accuracy:0.974 Precision:0.967 Recall:0.975 F1:0.971 MCC:0.948.
val Loss: 0.5753
val Accuracy:0.848 Precision:0.820 Recall:0.844 F1:0.832 MCC:0.694.
 
Epoch 8/8
---------------
train Loss: 0.0710
train Accuracy:0.976 Precision:0.970 Recall:0.977 F1:0.973 MCC:0.952.
val Loss: 0.6166
val Accuracy:0.854 Precision:0.803 Recall:0.890 F1:0.844 MCC:0.711.
Training complete in 231m 15s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/nucleotide/fold_1', '../../bionoi_output/binding_prob/nucleotide/fold_2', '../../bionoi_output/binding_prob/nucleotide/fold_4', '../../bionoi_output/binding_prob/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4344
train Accuracy:0.825 Precision:0.784 Recall:0.836 F1:0.809 MCC:0.649.
val Loss: 0.3873
val Accuracy:0.842 Precision:0.807 Recall:0.848 F1:0.827 MCC:0.683.
 
Epoch 2/8
---------------
train Loss: 0.3128
train Accuracy:0.879 Precision:0.849 Recall:0.885 F1:0.866 MCC:0.756.
val Loss: 0.4485
val Accuracy:0.829 Precision:0.785 Recall:0.849 F1:0.815 MCC:0.659.
 
Epoch 3/8
---------------
train Loss: 0.2160
train Accuracy:0.920 Precision:0.900 Recall:0.923 F1:0.911 MCC:0.839.
val Loss: 0.4588
val Accuracy:0.841 Precision:0.793 Recall:0.870 F1:0.829 MCC:0.684.
 
Epoch 4/8
---------------
train Loss: 0.1467
train Accuracy:0.949 Precision:0.936 Recall:0.949 F1:0.943 MCC:0.896.
val Loss: 0.5562
val Accuracy:0.836 Precision:0.769 Recall:0.903 F1:0.831 MCC:0.682.
 
Epoch 5/8
---------------
train Loss: 0.1092
train Accuracy:0.962 Precision:0.952 Recall:0.963 F1:0.958 MCC:0.923.
val Loss: 0.4519
val Accuracy:0.865 Precision:0.837 Recall:0.864 F1:0.850 MCC:0.728.
 
Epoch 6/8
---------------
train Loss: 0.0875
train Accuracy:0.971 Precision:0.963 Recall:0.971 F1:0.967 MCC:0.941.
val Loss: 0.8803
val Accuracy:0.795 Precision:0.846 Recall:0.659 F1:0.741 MCC:0.589.
 
Epoch 7/8
---------------
train Loss: 0.0754
train Accuracy:0.974 Precision:0.967 Recall:0.975 F1:0.971 MCC:0.948.
val Loss: 0.5272
val Accuracy:0.862 Precision:0.839 Recall:0.854 F1:0.846 MCC:0.722.
 
Epoch 8/8
---------------
train Loss: 0.0668
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.5751
val Accuracy:0.858 Precision:0.822 Recall:0.868 F1:0.845 MCC:0.715.
Training complete in 231m 10s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/nucleotide/fold_1', '../../bionoi_output/binding_prob/nucleotide/fold_2', '../../bionoi_output/binding_prob/nucleotide/fold_3', '../../bionoi_output/binding_prob/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4210
train Accuracy:0.829 Precision:0.788 Recall:0.842 F1:0.814 MCC:0.657.
val Loss: 0.4427
val Accuracy:0.814 Precision:0.742 Recall:0.889 F1:0.809 MCC:0.640.
 
Epoch 2/8
---------------
train Loss: 0.3058
train Accuracy:0.882 Precision:0.853 Recall:0.888 F1:0.870 MCC:0.763.
val Loss: 0.5820
val Accuracy:0.785 Precision:0.811 Recall:0.671 F1:0.734 MCC:0.563.
 
Epoch 3/8
---------------
train Loss: 0.2138
train Accuracy:0.922 Precision:0.903 Recall:0.924 F1:0.914 MCC:0.844.
val Loss: 0.5614
val Accuracy:0.807 Precision:0.753 Recall:0.840 F1:0.794 MCC:0.617.
 
Epoch 4/8
---------------
train Loss: 0.1426
train Accuracy:0.950 Precision:0.937 Recall:0.951 F1:0.944 MCC:0.899.
val Loss: 0.6330
val Accuracy:0.829 Precision:0.816 Recall:0.793 F1:0.804 MCC:0.653.
 
Epoch 5/8
---------------
train Loss: 0.1062
train Accuracy:0.963 Precision:0.954 Recall:0.963 F1:0.959 MCC:0.926.
val Loss: 0.7046
val Accuracy:0.812 Precision:0.803 Recall:0.763 F1:0.782 MCC:0.617.
 
Epoch 6/8
---------------
train Loss: 0.0852
train Accuracy:0.971 Precision:0.963 Recall:0.971 F1:0.967 MCC:0.941.
val Loss: 0.8123
val Accuracy:0.814 Precision:0.847 Recall:0.709 F1:0.772 MCC:0.624.
 
Epoch 7/8
---------------
train Loss: 0.0734
train Accuracy:0.975 Precision:0.969 Recall:0.976 F1:0.972 MCC:0.950.
val Loss: 0.7256
val Accuracy:0.825 Precision:0.841 Recall:0.746 F1:0.791 MCC:0.645.
 
Epoch 8/8
---------------
train Loss: 0.0648
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.956.
val Loss: 0.7798
val Accuracy:0.831 Precision:0.826 Recall:0.786 F1:0.805 MCC:0.658.
Training complete in 231m 19s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/nucleotide/fold_1', '../../bionoi_output/binding_prob/nucleotide/fold_2', '../../bionoi_output/binding_prob/nucleotide/fold_3', '../../bionoi_output/binding_prob/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4204
train Accuracy:0.831 Precision:0.791 Recall:0.842 F1:0.816 MCC:0.661.
val Loss: 0.5167
val Accuracy:0.799 Precision:0.824 Recall:0.695 F1:0.754 MCC:0.592.
 
Epoch 2/8
---------------
train Loss: 0.3084
train Accuracy:0.880 Precision:0.851 Recall:0.885 F1:0.868 MCC:0.759.
val Loss: 0.5886
val Accuracy:0.782 Precision:0.753 Recall:0.757 F1:0.755 MCC:0.558.
 
Epoch 3/8
---------------
train Loss: 0.2232
train Accuracy:0.917 Precision:0.898 Recall:0.918 F1:0.908 MCC:0.833.
val Loss: 0.6253
val Accuracy:0.806 Precision:0.744 Recall:0.857 F1:0.796 MCC:0.618.
 
Epoch 4/8
---------------
train Loss: 0.1529
train Accuracy:0.945 Precision:0.931 Recall:0.947 F1:0.939 MCC:0.890.
val Loss: 0.6576
val Accuracy:0.812 Precision:0.823 Recall:0.733 F1:0.776 MCC:0.618.
 
Epoch 5/8
---------------
train Loss: 0.1106
train Accuracy:0.961 Precision:0.951 Recall:0.962 F1:0.956 MCC:0.921.
val Loss: 0.6390
val Accuracy:0.819 Precision:0.789 Recall:0.807 F1:0.798 MCC:0.634.
 
Epoch 6/8
---------------
train Loss: 0.0895
train Accuracy:0.969 Precision:0.961 Recall:0.970 F1:0.966 MCC:0.938.
val Loss: 0.8240
val Accuracy:0.798 Precision:0.798 Recall:0.728 F1:0.762 MCC:0.588.
 
Epoch 7/8
---------------
train Loss: 0.0744
train Accuracy:0.975 Precision:0.968 Recall:0.975 F1:0.972 MCC:0.949.
val Loss: 0.7743
val Accuracy:0.812 Precision:0.833 Recall:0.720 F1:0.772 MCC:0.618.
 
Epoch 8/8
---------------
train Loss: 0.0684
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.8266
val Accuracy:0.810 Precision:0.820 Recall:0.732 F1:0.773 MCC:0.613.
Training complete in 231m 13s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4825041501991419, 'acc': 0.8246255349500713, 'precision': 0.8189076520878965, 'recall': 0.7763933547695605, 'mcc': 0.6435695411886808}, {'loss': 0.4089035388117745, 'acc': 0.8457738095238095, 'precision': 0.8254307466274876, 'recall': 0.8279742765273312, 'mcc': 0.6877687257630605}, {'loss': 0.38728400363808585, 'acc': 0.8423214285714286, 'precision': 0.8070007651109411, 'recall': 0.8478697749196141, 'mcc': 0.6829934074886264}, {'loss': 0.4427237771042882, 'acc': 0.8135729613733905, 'precision': 0.7417998317914214, 'recall': 0.8891129032258065, 'mcc': 0.6396461718677414}, {'loss': 0.5167025336564923, 'acc': 0.7986409155937053, 'precision': 0.8235106721885951, 'recall': 0.6948924731182796, 'mcc': 0.5915416390176027}]
Averge metrics over 5 folds:
average loss:  0.44762360068195656
average accuracy:  0.824986930002481
average precision:  0.8033299335612684
average recall:  0.8072485565121184
average mcc:  0.6491038970651424
cross-validation finished, end of program
