data directory: ../../bionoi_output/center_dist/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/heme/fold_2', '../../bionoi_output/center_dist/heme/fold_3', '../../bionoi_output/center_dist/heme/fold_4', '../../bionoi_output/center_dist/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4958
train Accuracy:0.863 Precision:0.657 Recall:0.868 F1:0.748 MCC:0.668.
val Loss: 0.8549
val Accuracy:0.854 Precision:0.701 Recall:0.663 F1:0.682 MCC:0.588.
 
Epoch 2/8
---------------
train Loss: 0.3590
train Accuracy:0.905 Precision:0.743 Recall:0.910 F1:0.818 MCC:0.762.
val Loss: 0.7124
val Accuracy:0.863 Precision:0.678 Recall:0.799 F1:0.733 MCC:0.646.
 
Epoch 3/8
---------------
train Loss: 0.2727
train Accuracy:0.927 Precision:0.792 Recall:0.934 F1:0.857 MCC:0.813.
val Loss: 0.7858
val Accuracy:0.871 Precision:0.758 Recall:0.666 F1:0.709 MCC:0.629.
 
Epoch 4/8
---------------
train Loss: 0.2060
train Accuracy:0.945 Precision:0.837 Recall:0.952 F1:0.891 MCC:0.858.
val Loss: 0.8248
val Accuracy:0.871 Precision:0.700 Recall:0.793 F1:0.744 MCC:0.660.
 
Epoch 5/8
---------------
train Loss: 0.1586
train Accuracy:0.959 Precision:0.873 Recall:0.965 F1:0.917 MCC:0.891.
val Loss: 0.8712
val Accuracy:0.866 Precision:0.683 Recall:0.800 F1:0.737 MCC:0.651.
 
Epoch 6/8
---------------
train Loss: 0.1295
train Accuracy:0.967 Precision:0.896 Recall:0.971 F1:0.932 MCC:0.912.
val Loss: 1.0781
val Accuracy:0.877 Precision:0.745 Recall:0.724 F1:0.734 MCC:0.654.
 
Epoch 7/8
---------------
train Loss: 0.1132
train Accuracy:0.971 Precision:0.909 Recall:0.975 F1:0.940 MCC:0.922.
val Loss: 1.1202
val Accuracy:0.875 Precision:0.733 Recall:0.736 F1:0.734 MCC:0.652.
 
Epoch 8/8
---------------
train Loss: 0.1000
train Accuracy:0.975 Precision:0.920 Recall:0.978 F1:0.948 MCC:0.933.
val Loss: 1.4443
val Accuracy:0.881 Precision:0.799 Recall:0.661 F1:0.724 MCC:0.653.
Training complete in 167m 53s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/heme/fold_1', '../../bionoi_output/center_dist/heme/fold_3', '../../bionoi_output/center_dist/heme/fold_4', '../../bionoi_output/center_dist/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5326
train Accuracy:0.854 Precision:0.642 Recall:0.854 F1:0.733 MCC:0.648.
val Loss: 0.6146
val Accuracy:0.888 Precision:0.780 Recall:0.727 F1:0.752 MCC:0.681.
 
Epoch 2/8
---------------
train Loss: 0.3855
train Accuracy:0.897 Precision:0.726 Recall:0.899 F1:0.803 MCC:0.742.
val Loss: 0.5292
val Accuracy:0.878 Precision:0.690 Recall:0.867 F1:0.768 MCC:0.695.
 
Epoch 3/8
---------------
train Loss: 0.2968
train Accuracy:0.921 Precision:0.779 Recall:0.926 F1:0.846 MCC:0.798.
val Loss: 0.5018
val Accuracy:0.912 Precision:0.816 Recall:0.806 F1:0.811 MCC:0.754.
 
Epoch 4/8
---------------
train Loss: 0.2243
train Accuracy:0.942 Precision:0.828 Recall:0.948 F1:0.884 MCC:0.848.
val Loss: 0.9372
val Accuracy:0.892 Precision:0.867 Recall:0.638 F1:0.735 MCC:0.681.
 
Epoch 5/8
---------------
train Loss: 0.1779
train Accuracy:0.953 Precision:0.860 Recall:0.958 F1:0.906 MCC:0.878.
val Loss: 0.7449
val Accuracy:0.908 Precision:0.853 Recall:0.732 F1:0.788 MCC:0.733.
 
Epoch 6/8
---------------
train Loss: 0.1424
train Accuracy:0.963 Precision:0.887 Recall:0.967 F1:0.925 MCC:0.903.
val Loss: 0.6389
val Accuracy:0.870 Precision:0.664 Recall:0.900 F1:0.764 MCC:0.692.
 
Epoch 7/8
---------------
train Loss: 0.1170
train Accuracy:0.970 Precision:0.907 Recall:0.973 F1:0.939 MCC:0.920.
val Loss: 0.9826
val Accuracy:0.903 Precision:0.815 Recall:0.760 F1:0.787 MCC:0.725.
 
Epoch 8/8
---------------
train Loss: 0.1042
train Accuracy:0.973 Precision:0.914 Recall:0.976 F1:0.944 MCC:0.927.
val Loss: 0.8016
val Accuracy:0.895 Precision:0.751 Recall:0.822 F1:0.785 MCC:0.717.
Training complete in 167m 46s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/heme/fold_1', '../../bionoi_output/center_dist/heme/fold_2', '../../bionoi_output/center_dist/heme/fold_4', '../../bionoi_output/center_dist/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5484
train Accuracy:0.848 Precision:0.629 Recall:0.853 F1:0.724 MCC:0.636.
val Loss: 0.4067
val Accuracy:0.931 Precision:0.854 Recall:0.852 F1:0.853 MCC:0.808.
 
Epoch 2/8
---------------
train Loss: 0.3984
train Accuracy:0.893 Precision:0.716 Recall:0.900 F1:0.798 MCC:0.735.
val Loss: 0.4327
val Accuracy:0.878 Precision:0.672 Recall:0.935 F1:0.782 MCC:0.719.
 
Epoch 3/8
---------------
train Loss: 0.3016
train Accuracy:0.918 Precision:0.770 Recall:0.927 F1:0.841 MCC:0.793.
val Loss: 0.4731
val Accuracy:0.925 Precision:0.856 Recall:0.818 F1:0.837 MCC:0.788.
 
Epoch 4/8
---------------
train Loss: 0.2292
train Accuracy:0.939 Precision:0.821 Recall:0.947 F1:0.880 MCC:0.843.
val Loss: 0.4022
val Accuracy:0.914 Precision:0.765 Recall:0.915 F1:0.833 MCC:0.782.
 
Epoch 5/8
---------------
train Loss: 0.1714
train Accuracy:0.956 Precision:0.865 Recall:0.962 F1:0.911 MCC:0.884.
val Loss: 0.4239
val Accuracy:0.920 Precision:0.787 Recall:0.903 F1:0.841 MCC:0.791.
 
Epoch 6/8
---------------
train Loss: 0.1406
train Accuracy:0.964 Precision:0.887 Recall:0.969 F1:0.926 MCC:0.904.
val Loss: 0.6278
val Accuracy:0.927 Precision:0.829 Recall:0.865 F1:0.847 MCC:0.799.
 
Epoch 7/8
---------------
train Loss: 0.1167
train Accuracy:0.970 Precision:0.906 Recall:0.973 F1:0.938 MCC:0.919.
val Loss: 0.6980
val Accuracy:0.930 Precision:0.899 Recall:0.791 F1:0.841 MCC:0.800.
 
Epoch 8/8
---------------
train Loss: 0.1067
train Accuracy:0.973 Precision:0.914 Recall:0.975 F1:0.944 MCC:0.926.
val Loss: 0.5264
val Accuracy:0.913 Precision:0.769 Recall:0.901 F1:0.830 MCC:0.776.
Training complete in 168m 10s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/heme/fold_1', '../../bionoi_output/center_dist/heme/fold_2', '../../bionoi_output/center_dist/heme/fold_3', '../../bionoi_output/center_dist/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5294
train Accuracy:0.853 Precision:0.639 Recall:0.856 F1:0.732 MCC:0.647.
val Loss: 1.8683
val Accuracy:0.828 Precision:0.944 Recall:0.283 F1:0.435 MCC:0.460.
 
Epoch 2/8
---------------
train Loss: 0.3888
train Accuracy:0.896 Precision:0.724 Recall:0.902 F1:0.803 MCC:0.743.
val Loss: 0.4385
val Accuracy:0.888 Precision:0.708 Recall:0.889 F1:0.789 MCC:0.722.
 
Epoch 3/8
---------------
train Loss: 0.3011
train Accuracy:0.920 Precision:0.777 Recall:0.926 F1:0.845 MCC:0.798.
val Loss: 0.5606
val Accuracy:0.849 Precision:0.617 Recall:0.933 F1:0.743 MCC:0.669.
 
Epoch 4/8
---------------
train Loss: 0.2265
train Accuracy:0.940 Precision:0.824 Recall:0.947 F1:0.881 MCC:0.845.
val Loss: 0.4844
val Accuracy:0.886 Precision:0.706 Recall:0.881 F1:0.784 MCC:0.716.
 
Epoch 5/8
---------------
train Loss: 0.1738
train Accuracy:0.954 Precision:0.861 Recall:0.959 F1:0.908 MCC:0.880.
val Loss: 0.5806
val Accuracy:0.905 Precision:0.797 Recall:0.797 F1:0.797 MCC:0.735.
 
Epoch 6/8
---------------
train Loss: 0.1389
train Accuracy:0.964 Precision:0.888 Recall:0.969 F1:0.926 MCC:0.904.
val Loss: 0.6161
val Accuracy:0.855 Precision:0.641 Recall:0.872 F1:0.739 MCC:0.656.
 
Epoch 7/8
---------------
train Loss: 0.1177
train Accuracy:0.971 Precision:0.908 Recall:0.974 F1:0.940 MCC:0.922.
val Loss: 0.5923
val Accuracy:0.910 Precision:0.793 Recall:0.834 F1:0.813 MCC:0.754.
 
Epoch 8/8
---------------
train Loss: 0.1072
train Accuracy:0.973 Precision:0.915 Recall:0.976 F1:0.945 MCC:0.928.
val Loss: 0.7829
val Accuracy:0.880 Precision:0.709 Recall:0.826 F1:0.763 MCC:0.687.
Training complete in 168m 9s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/heme/fold_1', '../../bionoi_output/center_dist/heme/fold_2', '../../bionoi_output/center_dist/heme/fold_3', '../../bionoi_output/center_dist/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4943
train Accuracy:0.865 Precision:0.662 Recall:0.869 F1:0.752 MCC:0.673.
val Loss: 0.6492
val Accuracy:0.874 Precision:0.738 Recall:0.716 F1:0.727 MCC:0.645.
 
Epoch 2/8
---------------
train Loss: 0.3575
train Accuracy:0.906 Precision:0.746 Recall:0.909 F1:0.820 MCC:0.764.
val Loss: 1.1171
val Accuracy:0.863 Precision:0.780 Recall:0.581 F1:0.666 MCC:0.592.
 
Epoch 3/8
---------------
train Loss: 0.2759
train Accuracy:0.927 Precision:0.795 Recall:0.931 F1:0.857 MCC:0.814.
val Loss: 0.5919
val Accuracy:0.870 Precision:0.690 Recall:0.812 F1:0.746 MCC:0.664.
 
Epoch 4/8
---------------
train Loss: 0.2082
train Accuracy:0.945 Precision:0.838 Recall:0.950 F1:0.890 MCC:0.857.
val Loss: 1.0228
val Accuracy:0.857 Precision:0.714 Recall:0.650 F1:0.681 MCC:0.590.
 
Epoch 5/8
---------------
train Loss: 0.1628
train Accuracy:0.957 Precision:0.870 Recall:0.961 F1:0.913 MCC:0.887.
val Loss: 0.8499
val Accuracy:0.874 Precision:0.704 Recall:0.795 F1:0.747 MCC:0.665.
 
Epoch 6/8
---------------
train Loss: 0.1293
train Accuracy:0.967 Precision:0.897 Recall:0.970 F1:0.932 MCC:0.911.
val Loss: 0.9845
val Accuracy:0.877 Precision:0.757 Recall:0.700 F1:0.728 MCC:0.649.
 
Epoch 7/8
---------------
train Loss: 0.1122
train Accuracy:0.971 Precision:0.910 Recall:0.974 F1:0.941 MCC:0.923.
val Loss: 1.2787
val Accuracy:0.867 Precision:0.764 Recall:0.625 F1:0.688 MCC:0.609.
 
Epoch 8/8
---------------
train Loss: 0.0989
train Accuracy:0.975 Precision:0.921 Recall:0.978 F1:0.949 MCC:0.933.
val Loss: 1.2021
val Accuracy:0.867 Precision:0.731 Recall:0.687 F1:0.708 MCC:0.623.
Training complete in 168m 7s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7123898589338352, 'acc': 0.8632761437908497, 'precision': 0.6777663179608074, 'recall': 0.7986111111111112, 'mcc': 0.646057876184008}, {'loss': 0.5018175421307093, 'acc': 0.912114501312336, 'precision': 0.8162325004430268, 'recall': 0.8063725490196079, 'mcc': 0.7540194225397368}, {'loss': 0.40219062395159183, 'acc': 0.9142060367454068, 'precision': 0.7649297423887588, 'recall': 0.9149159663865546, 'mcc': 0.781730313872975}, {'loss': 0.4385025098753648, 'acc': 0.8882463910761155, 'precision': 0.7082113481109718, 'recall': 0.8893557422969187, 'mcc': 0.7224435472451424}, {'loss': 0.591930600895187, 'acc': 0.8704068241469817, 'precision': 0.6898244570068433, 'recall': 0.8117997198879552, 'mcc': 0.6635936696678842}]
Averge metrics over 5 folds:
average loss:  0.5293662271573376
average accuracy:  0.8896499794143379
average precision:  0.7313928731820816
average recall:  0.8442110177404295
average mcc:  0.7135689659019493
cross-validation finished, end of program
