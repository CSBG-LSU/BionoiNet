data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3747
train Accuracy:0.854 Precision:0.826 Recall:0.849 F1:0.837 MCC:0.705.
val Loss: 0.4323
val Accuracy:0.837 Precision:0.796 Recall:0.852 F1:0.823 MCC:0.674.
 
Epoch 2/8
---------------
train Loss: 0.2514
train Accuracy:0.908 Precision:0.891 Recall:0.903 F1:0.897 MCC:0.813.
val Loss: 0.4892
val Accuracy:0.829 Precision:0.841 Recall:0.758 F1:0.797 MCC:0.652.
 
Epoch 3/8
---------------
train Loss: 0.1615
train Accuracy:0.943 Precision:0.932 Recall:0.941 F1:0.936 MCC:0.885.
val Loss: 0.4157
val Accuracy:0.858 Precision:0.827 Recall:0.860 F1:0.844 MCC:0.715.
 
Epoch 4/8
---------------
train Loss: 0.1091
train Accuracy:0.963 Precision:0.955 Recall:0.961 F1:0.958 MCC:0.925.
val Loss: 0.6097
val Accuracy:0.845 Precision:0.827 Recall:0.823 F1:0.825 MCC:0.686.
 
Epoch 5/8
---------------
train Loss: 0.0836
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.6377
val Accuracy:0.835 Precision:0.881 Recall:0.726 F1:0.796 MCC:0.668.
 
Epoch 6/8
---------------
train Loss: 0.0703
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.6309
val Accuracy:0.852 Precision:0.877 Recall:0.774 F1:0.822 MCC:0.700.
 
Epoch 7/8
---------------
train Loss: 0.0586
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.6519
val Accuracy:0.842 Precision:0.805 Recall:0.850 F1:0.827 MCC:0.683.
 
Epoch 8/8
---------------
train Loss: 0.0545
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.7020
val Accuracy:0.847 Precision:0.875 Recall:0.764 F1:0.816 MCC:0.690.
Training complete in 230m 24s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3809
train Accuracy:0.849 Precision:0.818 Recall:0.847 F1:0.833 MCC:0.695.
val Loss: 0.3715
val Accuracy:0.853 Precision:0.827 Recall:0.847 F1:0.837 MCC:0.704.
 
Epoch 2/8
---------------
train Loss: 0.2466
train Accuracy:0.908 Precision:0.888 Recall:0.907 F1:0.897 MCC:0.814.
val Loss: 0.4143
val Accuracy:0.868 Precision:0.887 Recall:0.807 F1:0.845 MCC:0.734.
 
Epoch 3/8
---------------
train Loss: 0.1578
train Accuracy:0.944 Precision:0.932 Recall:0.943 F1:0.937 MCC:0.887.
val Loss: 0.4774
val Accuracy:0.859 Precision:0.805 Recall:0.900 F1:0.850 MCC:0.721.
 
Epoch 4/8
---------------
train Loss: 0.1109
train Accuracy:0.962 Precision:0.952 Recall:0.961 F1:0.957 MCC:0.922.
val Loss: 0.5831
val Accuracy:0.854 Precision:0.824 Recall:0.855 F1:0.839 MCC:0.707.
 
Epoch 5/8
---------------
train Loss: 0.0830
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.5088
val Accuracy:0.879 Precision:0.855 Recall:0.875 F1:0.865 MCC:0.755.
 
Epoch 6/8
---------------
train Loss: 0.0703
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.4971
val Accuracy:0.866 Precision:0.815 Recall:0.903 F1:0.857 MCC:0.735.
 
Epoch 7/8
---------------
train Loss: 0.0595
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.6654
val Accuracy:0.856 Precision:0.881 Recall:0.783 F1:0.829 MCC:0.710.
 
Epoch 8/8
---------------
train Loss: 0.0563
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.5929
val Accuracy:0.878 Precision:0.904 Recall:0.813 F1:0.856 MCC:0.754.
Training complete in 230m 26s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3852
train Accuracy:0.848 Precision:0.819 Recall:0.844 F1:0.831 MCC:0.693.
val Loss: 0.3809
val Accuracy:0.858 Precision:0.890 Recall:0.777 F1:0.830 MCC:0.714.
 
Epoch 2/8
---------------
train Loss: 0.2545
train Accuracy:0.906 Precision:0.887 Recall:0.902 F1:0.895 MCC:0.810.
val Loss: 0.4786
val Accuracy:0.834 Precision:0.751 Recall:0.938 F1:0.834 MCC:0.689.
 
Epoch 3/8
---------------
train Loss: 0.1645
train Accuracy:0.942 Precision:0.929 Recall:0.941 F1:0.935 MCC:0.882.
val Loss: 0.3601
val Accuracy:0.883 Precision:0.840 Recall:0.912 F1:0.874 MCC:0.768.
 
Epoch 4/8
---------------
train Loss: 0.1108
train Accuracy:0.961 Precision:0.953 Recall:0.961 F1:0.957 MCC:0.922.
val Loss: 0.4014
val Accuracy:0.880 Precision:0.852 Recall:0.883 F1:0.867 MCC:0.758.
 
Epoch 5/8
---------------
train Loss: 0.0838
train Accuracy:0.972 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.944.
val Loss: 0.4301
val Accuracy:0.880 Precision:0.833 Recall:0.912 F1:0.871 MCC:0.761.
 
Epoch 6/8
---------------
train Loss: 0.0710
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.4858
val Accuracy:0.878 Precision:0.898 Recall:0.818 F1:0.856 MCC:0.753.
 
Epoch 7/8
---------------
train Loss: 0.0602
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.977 MCC:0.959.
val Loss: 0.4517
val Accuracy:0.883 Precision:0.866 Recall:0.872 F1:0.869 MCC:0.763.
 
Epoch 8/8
---------------
train Loss: 0.0539
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.4478
val Accuracy:0.887 Precision:0.883 Recall:0.860 F1:0.872 MCC:0.772.
Training complete in 230m 40s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3659
train Accuracy:0.857 Precision:0.828 Recall:0.854 F1:0.841 MCC:0.711.
val Loss: 0.4330
val Accuracy:0.822 Precision:0.760 Recall:0.876 F1:0.814 MCC:0.652.
 
Epoch 2/8
---------------
train Loss: 0.2274
train Accuracy:0.917 Precision:0.901 Recall:0.914 F1:0.907 MCC:0.832.
val Loss: 0.4748
val Accuracy:0.852 Precision:0.894 Recall:0.756 F1:0.819 MCC:0.703.
 
Epoch 3/8
---------------
train Loss: 0.1472
train Accuracy:0.948 Precision:0.937 Recall:0.947 F1:0.942 MCC:0.895.
val Loss: 0.5108
val Accuracy:0.844 Precision:0.831 Recall:0.814 F1:0.822 MCC:0.683.
 
Epoch 4/8
---------------
train Loss: 0.0998
train Accuracy:0.966 Precision:0.958 Recall:0.966 F1:0.962 MCC:0.931.
val Loss: 0.5948
val Accuracy:0.860 Precision:0.864 Recall:0.813 F1:0.838 MCC:0.716.
 
Epoch 5/8
---------------
train Loss: 0.0781
train Accuracy:0.973 Precision:0.967 Recall:0.974 F1:0.970 MCC:0.946.
val Loss: 0.6271
val Accuracy:0.840 Precision:0.824 Recall:0.814 F1:0.819 MCC:0.676.
 
Epoch 6/8
---------------
train Loss: 0.0664
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.7524
val Accuracy:0.839 Precision:0.857 Recall:0.764 F1:0.808 MCC:0.673.
 
Epoch 7/8
---------------
train Loss: 0.0580
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.6189
val Accuracy:0.850 Precision:0.853 Recall:0.801 F1:0.826 MCC:0.696.
 
Epoch 8/8
---------------
train Loss: 0.0518
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.981 MCC:0.965.
val Loss: 0.7284
val Accuracy:0.853 Precision:0.844 Recall:0.821 F1:0.832 MCC:0.702.
Training complete in 231m 17s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3565
train Accuracy:0.860 Precision:0.832 Recall:0.858 F1:0.845 MCC:0.717.
val Loss: 0.4921
val Accuracy:0.832 Precision:0.871 Recall:0.728 F1:0.793 MCC:0.661.
 
Epoch 2/8
---------------
train Loss: 0.2220
train Accuracy:0.919 Precision:0.902 Recall:0.916 F1:0.909 MCC:0.836.
val Loss: 0.5254
val Accuracy:0.837 Precision:0.835 Recall:0.789 F1:0.811 MCC:0.669.
 
Epoch 3/8
---------------
train Loss: 0.1432
train Accuracy:0.950 Precision:0.939 Recall:0.949 F1:0.944 MCC:0.898.
val Loss: 0.5254
val Accuracy:0.840 Precision:0.796 Recall:0.861 F1:0.827 MCC:0.681.
 
Epoch 4/8
---------------
train Loss: 0.0995
train Accuracy:0.966 Precision:0.959 Recall:0.965 F1:0.962 MCC:0.932.
val Loss: 0.6635
val Accuracy:0.834 Precision:0.857 Recall:0.751 F1:0.800 MCC:0.664.
 
Epoch 5/8
---------------
train Loss: 0.0788
train Accuracy:0.974 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.947.
val Loss: 0.8477
val Accuracy:0.818 Precision:0.855 Recall:0.709 F1:0.775 MCC:0.632.
 
Epoch 6/8
---------------
train Loss: 0.0653
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.6419
val Accuracy:0.851 Precision:0.824 Recall:0.845 F1:0.835 MCC:0.700.
 
Epoch 7/8
---------------
train Loss: 0.0557
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.7831
val Accuracy:0.831 Precision:0.824 Recall:0.787 F1:0.805 MCC:0.657.
 
Epoch 8/8
---------------
train Loss: 0.0519
train Accuracy:0.983 Precision:0.978 Recall:0.983 F1:0.981 MCC:0.965.
val Loss: 0.7696
val Accuracy:0.846 Precision:0.847 Recall:0.797 F1:0.821 MCC:0.687.
Training complete in 231m 29s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4157204070454884, 'acc': 0.8584759866856871, 'precision': 0.8274284978098428, 'recall': 0.8604635584137191, 'mcc': 0.7149221775678936}, {'loss': 0.3714977917429947, 'acc': 0.8533630952380953, 'precision': 0.8269369074861066, 'recall': 0.8472668810289389, 'mcc': 0.7039405623870463}, {'loss': 0.36014049770044426, 'acc': 0.8833928571428571, 'precision': 0.8397309306344113, 'recall': 0.9115085744908896, 'mcc': 0.7680965048504512}, {'loss': 0.4330265532093612, 'acc': 0.8224845016690511, 'precision': 0.7603571011786673, 'recall': 0.875739247311828, 'mcc': 0.6517342922896248}, {'loss': 0.4920639312929577, 'acc': 0.8316940867906533, 'precision': 0.8714894986722459, 'recall': 0.7278225806451613, 'mcc': 0.6607677944937508}]
Averge metrics over 5 folds:
average loss:  0.41448983619824925
average accuracy:  0.8498821055052688
average precision:  0.8251885871562548
average recall:  0.8445601683781072
average mcc:  0.6998922663177533
cross-validation finished, end of program
