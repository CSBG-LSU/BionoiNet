data directory: ../../bionoi_output/binding_prob/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/heme/fold_2', '../../bionoi_output/binding_prob/heme/fold_3', '../../bionoi_output/binding_prob/heme/fold_4', '../../bionoi_output/binding_prob/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4785
train Accuracy:0.871 Precision:0.672 Recall:0.879 F1:0.762 MCC:0.687.
val Loss: 1.0726
val Accuracy:0.874 Precision:0.836 Recall:0.577 F1:0.683 MCC:0.624.
 
Epoch 2/8
---------------
train Loss: 0.3260
train Accuracy:0.917 Precision:0.772 Recall:0.917 F1:0.838 MCC:0.788.
val Loss: 1.1283
val Accuracy:0.875 Precision:0.776 Recall:0.659 F1:0.713 MCC:0.637.
 
Epoch 3/8
---------------
train Loss: 0.2296
train Accuracy:0.941 Precision:0.830 Recall:0.943 F1:0.883 MCC:0.847.
val Loss: 1.1954
val Accuracy:0.873 Precision:0.823 Recall:0.585 F1:0.683 MCC:0.620.
 
Epoch 4/8
---------------
train Loss: 0.1581
train Accuracy:0.960 Precision:0.878 Recall:0.963 F1:0.919 MCC:0.894.
val Loss: 1.3294
val Accuracy:0.857 Precision:0.710 Recall:0.665 F1:0.687 MCC:0.595.
 
Epoch 5/8
---------------
train Loss: 0.1248
train Accuracy:0.969 Precision:0.903 Recall:0.971 F1:0.936 MCC:0.916.
val Loss: 1.6189
val Accuracy:0.874 Precision:0.914 Recall:0.514 F1:0.658 MCC:0.625.
 
Epoch 6/8
---------------
train Loss: 0.0995
train Accuracy:0.976 Precision:0.925 Recall:0.977 F1:0.950 MCC:0.935.
val Loss: 1.6601
val Accuracy:0.860 Precision:0.738 Recall:0.630 F1:0.679 MCC:0.594.
 
Epoch 7/8
---------------
train Loss: 0.0875
train Accuracy:0.979 Precision:0.935 Recall:0.980 F1:0.957 MCC:0.944.
val Loss: 2.6053
val Accuracy:0.881 Precision:0.875 Recall:0.576 F1:0.695 MCC:0.646.
 
Epoch 8/8
---------------
train Loss: 0.0777
train Accuracy:0.981 Precision:0.940 Recall:0.983 F1:0.961 MCC:0.949.
val Loss: 2.1240
val Accuracy:0.888 Precision:0.911 Recall:0.581 F1:0.710 MCC:0.669.
Training complete in 167m 50s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/heme/fold_1', '../../bionoi_output/binding_prob/heme/fold_3', '../../bionoi_output/binding_prob/heme/fold_4', '../../bionoi_output/binding_prob/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5432
train Accuracy:0.854 Precision:0.643 Recall:0.848 F1:0.731 MCC:0.645.
val Loss: 0.5383
val Accuracy:0.884 Precision:0.747 Recall:0.764 F1:0.755 MCC:0.679.
 
Epoch 2/8
---------------
train Loss: 0.3770
train Accuracy:0.904 Precision:0.746 Recall:0.895 F1:0.814 MCC:0.755.
val Loss: 1.1136
val Accuracy:0.871 Precision:0.838 Recall:0.557 F1:0.669 MCC:0.612.
 
Epoch 3/8
---------------
train Loss: 0.2766
train Accuracy:0.928 Precision:0.798 Recall:0.928 F1:0.858 MCC:0.814.
val Loss: 0.5485
val Accuracy:0.890 Precision:0.760 Recall:0.776 F1:0.768 MCC:0.696.
 
Epoch 4/8
---------------
train Loss: 0.1999
train Accuracy:0.950 Precision:0.852 Recall:0.951 F1:0.898 MCC:0.867.
val Loss: 2.1905
val Accuracy:0.864 Precision:0.948 Recall:0.444 F1:0.605 MCC:0.592.
 
Epoch 5/8
---------------
train Loss: 0.1577
train Accuracy:0.960 Precision:0.878 Recall:0.962 F1:0.918 MCC:0.893.
val Loss: 2.2130
val Accuracy:0.855 Precision:0.928 Recall:0.411 F1:0.570 MCC:0.557.
 
Epoch 6/8
---------------
train Loss: 0.1295
train Accuracy:0.968 Precision:0.900 Recall:0.969 F1:0.933 MCC:0.913.
val Loss: 0.5658
val Accuracy:0.870 Precision:0.658 Recall:0.925 F1:0.769 MCC:0.701.
 
Epoch 7/8
---------------
train Loss: 0.1053
train Accuracy:0.974 Precision:0.918 Recall:0.976 F1:0.946 MCC:0.930.
val Loss: 1.0866
val Accuracy:0.894 Precision:0.848 Recall:0.667 F1:0.747 MCC:0.689.
 
Epoch 8/8
---------------
train Loss: 0.0988
train Accuracy:0.976 Precision:0.925 Recall:0.977 F1:0.950 MCC:0.935.
val Loss: 0.6406
val Accuracy:0.908 Precision:0.801 Recall:0.806 F1:0.804 MCC:0.743.
Training complete in 167m 43s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/heme/fold_1', '../../bionoi_output/binding_prob/heme/fold_2', '../../bionoi_output/binding_prob/heme/fold_4', '../../bionoi_output/binding_prob/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5629
train Accuracy:0.846 Precision:0.627 Recall:0.845 F1:0.719 MCC:0.629.
val Loss: 0.3918
val Accuracy:0.911 Precision:0.764 Recall:0.897 F1:0.825 MCC:0.771.
 
Epoch 2/8
---------------
train Loss: 0.3942
train Accuracy:0.898 Precision:0.732 Recall:0.892 F1:0.804 MCC:0.742.
val Loss: 0.4289
val Accuracy:0.856 Precision:0.627 Recall:0.950 F1:0.755 MCC:0.687.
 
Epoch 3/8
---------------
train Loss: 0.2790
train Accuracy:0.929 Precision:0.800 Recall:0.926 F1:0.859 MCC:0.815.
val Loss: 1.0450
val Accuracy:0.889 Precision:0.913 Recall:0.581 F1:0.710 MCC:0.671.
 
Epoch 4/8
---------------
train Loss: 0.1911
train Accuracy:0.953 Precision:0.861 Recall:0.954 F1:0.905 MCC:0.876.
val Loss: 0.4971
val Accuracy:0.921 Precision:0.834 Recall:0.827 F1:0.830 MCC:0.779.
 
Epoch 5/8
---------------
train Loss: 0.1445
train Accuracy:0.964 Precision:0.891 Recall:0.965 F1:0.926 MCC:0.904.
val Loss: 0.5147
val Accuracy:0.888 Precision:0.699 Recall:0.915 F1:0.793 MCC:0.730.
 
Epoch 6/8
---------------
train Loss: 0.1180
train Accuracy:0.971 Precision:0.909 Recall:0.972 F1:0.940 MCC:0.921.
val Loss: 0.5289
val Accuracy:0.895 Precision:0.743 Recall:0.842 F1:0.789 MCC:0.722.
 
Epoch 7/8
---------------
train Loss: 0.1017
train Accuracy:0.975 Precision:0.923 Recall:0.976 F1:0.949 MCC:0.933.
val Loss: 0.6212
val Accuracy:0.899 Precision:0.748 Recall:0.857 F1:0.799 MCC:0.735.
 
Epoch 8/8
---------------
train Loss: 0.0894
train Accuracy:0.979 Precision:0.935 Recall:0.978 F1:0.956 MCC:0.943.
val Loss: 1.3182
val Accuracy:0.887 Precision:0.898 Recall:0.584 F1:0.707 MCC:0.664.
Training complete in 167m 55s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/heme/fold_1', '../../bionoi_output/binding_prob/heme/fold_2', '../../bionoi_output/binding_prob/heme/fold_3', '../../bionoi_output/binding_prob/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5501
train Accuracy:0.852 Precision:0.640 Recall:0.843 F1:0.728 MCC:0.640.
val Loss: 0.7651
val Accuracy:0.883 Precision:0.902 Recall:0.561 F1:0.692 MCC:0.651.
 
Epoch 2/8
---------------
train Loss: 0.3830
train Accuracy:0.900 Precision:0.736 Recall:0.897 F1:0.809 MCC:0.749.
val Loss: 0.3493
val Accuracy:0.902 Precision:0.733 Recall:0.916 F1:0.814 MCC:0.757.
 
Epoch 3/8
---------------
train Loss: 0.2788
train Accuracy:0.928 Precision:0.798 Recall:0.928 F1:0.858 MCC:0.815.
val Loss: 0.5904
val Accuracy:0.837 Precision:0.595 Recall:0.947 F1:0.731 MCC:0.657.
 
Epoch 4/8
---------------
train Loss: 0.1987
train Accuracy:0.950 Precision:0.852 Recall:0.952 F1:0.899 MCC:0.868.
val Loss: 0.5204
val Accuracy:0.908 Precision:0.765 Recall:0.877 F1:0.817 MCC:0.759.
 
Epoch 5/8
---------------
train Loss: 0.1490
train Accuracy:0.963 Precision:0.887 Recall:0.963 F1:0.924 MCC:0.901.
val Loss: 0.4306
val Accuracy:0.901 Precision:0.743 Recall:0.884 F1:0.807 MCC:0.747.
 
Epoch 6/8
---------------
train Loss: 0.1234
train Accuracy:0.970 Precision:0.907 Recall:0.969 F1:0.937 MCC:0.918.
val Loss: 0.8096
val Accuracy:0.810 Precision:0.554 Recall:0.960 F1:0.703 MCC:0.624.
 
Epoch 7/8
---------------
train Loss: 0.1023
train Accuracy:0.975 Precision:0.923 Recall:0.976 F1:0.949 MCC:0.933.
val Loss: 0.5614
val Accuracy:0.912 Precision:0.806 Recall:0.825 F1:0.815 MCC:0.758.
 
Epoch 8/8
---------------
train Loss: 0.0909
train Accuracy:0.977 Precision:0.930 Recall:0.978 F1:0.953 MCC:0.939.
val Loss: 0.8444
val Accuracy:0.898 Precision:0.802 Recall:0.751 F1:0.776 MCC:0.711.
Training complete in 167m 43s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_1', '../../bionoi_output/binding_prob/control/fold_2', '../../bionoi_output/binding_prob/control/fold_3', '../../bionoi_output/binding_prob/control/fold_4', '../../bionoi_output/binding_prob/heme/fold_1', '../../bionoi_output/binding_prob/heme/fold_2', '../../bionoi_output/binding_prob/heme/fold_3', '../../bionoi_output/binding_prob/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/binding_prob/control/fold_5', '../../bionoi_output/binding_prob/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5244
train Accuracy:0.859 Precision:0.652 Recall:0.856 F1:0.740 MCC:0.657.
val Loss: 0.7064
val Accuracy:0.810 Precision:0.563 Recall:0.849 F1:0.677 MCC:0.573.
 
Epoch 2/8
---------------
train Loss: 0.3606
train Accuracy:0.905 Precision:0.745 Recall:0.906 F1:0.817 MCC:0.761.
val Loss: 0.6645
val Accuracy:0.882 Precision:0.757 Recall:0.728 F1:0.742 MCC:0.666.
 
Epoch 3/8
---------------
train Loss: 0.2610
train Accuracy:0.932 Precision:0.807 Recall:0.935 F1:0.866 MCC:0.825.
val Loss: 0.6538
val Accuracy:0.901 Precision:0.789 Recall:0.789 F1:0.789 MCC:0.724.
 
Epoch 4/8
---------------
train Loss: 0.1869
train Accuracy:0.952 Precision:0.857 Recall:0.956 F1:0.904 MCC:0.874.
val Loss: 0.9071
val Accuracy:0.898 Precision:0.810 Recall:0.740 F1:0.773 MCC:0.709.
 
Epoch 5/8
---------------
train Loss: 0.1474
train Accuracy:0.963 Precision:0.887 Recall:0.966 F1:0.925 MCC:0.902.
val Loss: 0.7020
val Accuracy:0.828 Precision:0.587 Recall:0.897 F1:0.710 MCC:0.622.
 
Epoch 6/8
---------------
train Loss: 0.1180
train Accuracy:0.971 Precision:0.910 Recall:0.972 F1:0.940 MCC:0.922.
val Loss: 0.6542
val Accuracy:0.898 Precision:0.754 Recall:0.837 F1:0.793 MCC:0.727.
 
Epoch 7/8
---------------
train Loss: 0.1003
train Accuracy:0.975 Precision:0.923 Recall:0.977 F1:0.949 MCC:0.934.
val Loss: 0.6722
val Accuracy:0.873 Precision:0.688 Recall:0.840 F1:0.756 MCC:0.678.
 
Epoch 8/8
---------------
train Loss: 0.0900
train Accuracy:0.978 Precision:0.930 Recall:0.979 F1:0.954 MCC:0.940.
val Loss: 1.7772
val Accuracy:0.883 Precision:0.872 Recall:0.585 F1:0.700 MCC:0.650.
Training complete in 167m 43s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 1.0726373046149615, 'acc': 0.8738562091503268, 'precision': 0.8361852038248616, 'recall': 0.5769097222222223, 'mcc': 0.6236148753032333}, {'loss': 0.5382842350741384, 'acc': 0.8839402887139107, 'precision': 0.7465776865160849, 'recall': 0.7638305322128851, 'mcc': 0.6791439356137058}, {'loss': 0.39175432089354423, 'acc': 0.9110482283464567, 'precision': 0.7642058165548098, 'recall': 0.8970588235294118, 'mcc': 0.7705911626030278}, {'loss': 0.34928105066571963, 'acc': 0.902107939632546, 'precision': 0.7328757529065696, 'recall': 0.9159663865546218, 'mcc': 0.7574875742380889}, {'loss': 0.6537673874095747, 'acc': 0.9010826771653543, 'precision': 0.7886634009797061, 'recall': 0.7892156862745098, 'mcc': 0.7243439250669776}]
Averge metrics over 5 folds:
average loss:  0.6011448597315877
average accuracy:  0.8944070686017189
average precision:  0.7737015721564064
average recall:  0.7885962301587301
average mcc:  0.7110362945650067
cross-validation finished, end of program
