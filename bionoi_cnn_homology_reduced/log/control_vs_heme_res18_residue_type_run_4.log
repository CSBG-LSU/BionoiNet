data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3771
train Accuracy:0.905 Precision:0.744 Recall:0.904 F1:0.816 MCC:0.759.
val Loss: 1.1321
val Accuracy:0.866 Precision:0.871 Recall:0.505 F1:0.639 MCC:0.596.
 
Epoch 2/8
---------------
train Loss: 0.2384
train Accuracy:0.943 Precision:0.836 Recall:0.942 F1:0.886 MCC:0.850.
val Loss: 0.8365
val Accuracy:0.879 Precision:0.742 Recall:0.746 F1:0.744 MCC:0.665.
 
Epoch 3/8
---------------
train Loss: 0.1582
train Accuracy:0.962 Precision:0.886 Recall:0.962 F1:0.922 MCC:0.898.
val Loss: 0.7598
val Accuracy:0.863 Precision:0.673 Recall:0.815 F1:0.738 MCC:0.652.
 
Epoch 4/8
---------------
train Loss: 0.1121
train Accuracy:0.973 Precision:0.917 Recall:0.974 F1:0.945 MCC:0.928.
val Loss: 1.1023
val Accuracy:0.880 Precision:0.770 Recall:0.696 F1:0.731 MCC:0.655.
 
Epoch 5/8
---------------
train Loss: 0.0891
train Accuracy:0.979 Precision:0.933 Recall:0.980 F1:0.956 MCC:0.943.
val Loss: 1.0907
val Accuracy:0.888 Precision:0.807 Recall:0.691 F1:0.744 MCC:0.677.
 
Epoch 6/8
---------------
train Loss: 0.0690
train Accuracy:0.983 Precision:0.946 Recall:0.984 F1:0.964 MCC:0.954.
val Loss: 1.9202
val Accuracy:0.887 Precision:0.907 Recall:0.579 F1:0.707 MCC:0.665.
 
Epoch 7/8
---------------
train Loss: 0.0638
train Accuracy:0.985 Precision:0.951 Recall:0.986 F1:0.968 MCC:0.958.
val Loss: 1.4887
val Accuracy:0.900 Precision:0.866 Recall:0.679 F1:0.761 MCC:0.707.
 
Epoch 8/8
---------------
train Loss: 0.0599
train Accuracy:0.986 Precision:0.955 Recall:0.986 F1:0.970 MCC:0.961.
val Loss: 1.1068
val Accuracy:0.889 Precision:0.781 Recall:0.736 F1:0.758 MCC:0.687.
Training complete in 167m 50s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4224
train Accuracy:0.889 Precision:0.712 Recall:0.885 F1:0.789 MCC:0.723.
val Loss: 0.6321
val Accuracy:0.911 Precision:0.949 Recall:0.657 F1:0.776 MCC:0.742.
 
Epoch 2/8
---------------
train Loss: 0.2511
train Accuracy:0.938 Precision:0.825 Recall:0.933 F1:0.876 MCC:0.837.
val Loss: 0.4064
val Accuracy:0.921 Precision:0.788 Recall:0.905 F1:0.842 MCC:0.793.
 
Epoch 3/8
---------------
train Loss: 0.1628
train Accuracy:0.961 Precision:0.883 Recall:0.960 F1:0.920 MCC:0.895.
val Loss: 0.4579
val Accuracy:0.904 Precision:0.743 Recall:0.901 F1:0.815 MCC:0.757.
 
Epoch 4/8
---------------
train Loss: 0.1134
train Accuracy:0.973 Precision:0.915 Recall:0.973 F1:0.943 MCC:0.926.
val Loss: 0.5106
val Accuracy:0.925 Precision:0.825 Recall:0.865 F1:0.845 MCC:0.796.
 
Epoch 5/8
---------------
train Loss: 0.0936
train Accuracy:0.978 Precision:0.929 Recall:0.978 F1:0.953 MCC:0.939.
val Loss: 0.9853
val Accuracy:0.911 Precision:0.911 Recall:0.687 F1:0.783 MCC:0.740.
 
Epoch 6/8
---------------
train Loss: 0.0760
train Accuracy:0.982 Precision:0.944 Recall:0.982 F1:0.963 MCC:0.951.
val Loss: 0.4427
val Accuracy:0.935 Precision:0.840 Recall:0.892 F1:0.865 MCC:0.823.
 
Epoch 7/8
---------------
train Loss: 0.0685
train Accuracy:0.984 Precision:0.948 Recall:0.984 F1:0.966 MCC:0.956.
val Loss: 0.6117
val Accuracy:0.928 Precision:0.869 Recall:0.817 F1:0.842 MCC:0.796.
 
Epoch 8/8
---------------
train Loss: 0.0587
train Accuracy:0.986 Precision:0.956 Recall:0.987 F1:0.971 MCC:0.963.
val Loss: 0.6589
val Accuracy:0.924 Precision:0.861 Recall:0.808 F1:0.834 MCC:0.786.
Training complete in 167m 52s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4292
train Accuracy:0.886 Precision:0.705 Recall:0.884 F1:0.784 MCC:0.716.
val Loss: 0.4545
val Accuracy:0.929 Precision:0.876 Recall:0.813 F1:0.843 MCC:0.798.
 
Epoch 2/8
---------------
train Loss: 0.2540
train Accuracy:0.936 Precision:0.819 Recall:0.934 F1:0.873 MCC:0.834.
val Loss: 0.3943
val Accuracy:0.902 Precision:0.725 Recall:0.935 F1:0.817 MCC:0.762.
 
Epoch 3/8
---------------
train Loss: 0.1688
train Accuracy:0.959 Precision:0.877 Recall:0.958 F1:0.916 MCC:0.890.
val Loss: 0.4808
val Accuracy:0.942 Precision:0.925 Recall:0.819 F1:0.869 MCC:0.834.
 
Epoch 4/8
---------------
train Loss: 0.1221
train Accuracy:0.970 Precision:0.909 Recall:0.970 F1:0.939 MCC:0.920.
val Loss: 0.4007
val Accuracy:0.952 Precision:0.893 Recall:0.906 F1:0.899 MCC:0.868.
 
Epoch 5/8
---------------
train Loss: 0.0953
train Accuracy:0.977 Precision:0.929 Recall:0.977 F1:0.952 MCC:0.938.
val Loss: 0.4376
val Accuracy:0.916 Precision:0.759 Recall:0.938 F1:0.839 MCC:0.791.
 
Epoch 6/8
---------------
train Loss: 0.0787
train Accuracy:0.981 Precision:0.940 Recall:0.981 F1:0.960 MCC:0.948.
val Loss: 0.4154
val Accuracy:0.933 Precision:0.813 Recall:0.929 F1:0.867 MCC:0.826.
 
Epoch 7/8
---------------
train Loss: 0.0680
train Accuracy:0.983 Precision:0.948 Recall:0.984 F1:0.965 MCC:0.955.
val Loss: 0.5054
val Accuracy:0.947 Precision:0.881 Recall:0.897 F1:0.889 MCC:0.855.
 
Epoch 8/8
---------------
train Loss: 0.0606
train Accuracy:0.986 Precision:0.955 Recall:0.987 F1:0.970 MCC:0.961.
val Loss: 0.5656
val Accuracy:0.937 Precision:0.854 Recall:0.882 F1:0.868 MCC:0.827.
Training complete in 167m 50s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4332
train Accuracy:0.886 Precision:0.705 Recall:0.881 F1:0.783 MCC:0.715.
val Loss: 0.3808
val Accuracy:0.930 Precision:0.851 Recall:0.848 F1:0.850 MCC:0.804.
 
Epoch 2/8
---------------
train Loss: 0.2646
train Accuracy:0.932 Precision:0.809 Recall:0.931 F1:0.866 MCC:0.825.
val Loss: 0.4046
val Accuracy:0.917 Precision:0.780 Recall:0.902 F1:0.837 MCC:0.786.
 
Epoch 3/8
---------------
train Loss: 0.1736
train Accuracy:0.956 Precision:0.870 Recall:0.957 F1:0.912 MCC:0.884.
val Loss: 0.3363
val Accuracy:0.921 Precision:0.769 Recall:0.947 F1:0.849 MCC:0.804.
 
Epoch 4/8
---------------
train Loss: 0.1271
train Accuracy:0.969 Precision:0.905 Recall:0.970 F1:0.936 MCC:0.916.
val Loss: 0.2652
val Accuracy:0.942 Precision:0.844 Recall:0.924 F1:0.882 MCC:0.846.
 
Epoch 5/8
---------------
train Loss: 0.0964
train Accuracy:0.976 Precision:0.926 Recall:0.977 F1:0.951 MCC:0.936.
val Loss: 0.3904
val Accuracy:0.906 Precision:0.735 Recall:0.936 F1:0.823 MCC:0.770.
 
Epoch 6/8
---------------
train Loss: 0.0835
train Accuracy:0.980 Precision:0.936 Recall:0.980 F1:0.958 MCC:0.945.
val Loss: 0.4290
val Accuracy:0.924 Precision:0.784 Recall:0.932 F1:0.852 MCC:0.806.
 
Epoch 7/8
---------------
train Loss: 0.0727
train Accuracy:0.983 Precision:0.946 Recall:0.983 F1:0.964 MCC:0.953.
val Loss: 0.2953
val Accuracy:0.953 Precision:0.892 Recall:0.907 F1:0.900 MCC:0.869.
 
Epoch 8/8
---------------
train Loss: 0.0649
train Accuracy:0.984 Precision:0.950 Recall:0.985 F1:0.967 MCC:0.957.
val Loss: 0.4001
val Accuracy:0.940 Precision:0.854 Recall:0.895 F1:0.874 MCC:0.835.
Training complete in 168m 20s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4039
train Accuracy:0.896 Precision:0.727 Recall:0.894 F1:0.801 MCC:0.739.
val Loss: 0.6111
val Accuracy:0.892 Precision:0.788 Recall:0.737 F1:0.762 MCC:0.693.
 
Epoch 2/8
---------------
train Loss: 0.2416
train Accuracy:0.939 Precision:0.826 Recall:0.938 F1:0.879 MCC:0.841.
val Loss: 0.6680
val Accuracy:0.899 Precision:0.827 Recall:0.719 F1:0.769 MCC:0.708.
 
Epoch 3/8
---------------
train Loss: 0.1548
train Accuracy:0.962 Precision:0.887 Recall:0.962 F1:0.923 MCC:0.899.
val Loss: 0.5920
val Accuracy:0.890 Precision:0.740 Recall:0.819 F1:0.777 MCC:0.706.
 
Epoch 4/8
---------------
train Loss: 0.1124
train Accuracy:0.973 Precision:0.916 Recall:0.973 F1:0.943 MCC:0.926.
val Loss: 0.9337
val Accuracy:0.916 Precision:0.890 Recall:0.731 F1:0.803 MCC:0.756.
 
Epoch 5/8
---------------
train Loss: 0.0921
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.8824
val Accuracy:0.904 Precision:0.823 Recall:0.751 F1:0.786 MCC:0.725.
 
Epoch 6/8
---------------
train Loss: 0.0756
train Accuracy:0.982 Precision:0.943 Recall:0.982 F1:0.962 MCC:0.951.
val Loss: 0.7588
val Accuracy:0.915 Precision:0.839 Recall:0.791 F1:0.814 MCC:0.760.
 
Epoch 7/8
---------------
train Loss: 0.0651
train Accuracy:0.984 Precision:0.950 Recall:0.985 F1:0.968 MCC:0.958.
val Loss: 0.9445
val Accuracy:0.908 Precision:0.854 Recall:0.732 F1:0.788 MCC:0.733.
 
Epoch 8/8
---------------
train Loss: 0.0606
train Accuracy:0.986 Precision:0.956 Recall:0.987 F1:0.971 MCC:0.963.
val Loss: 0.7780
val Accuracy:0.905 Precision:0.777 Recall:0.836 F1:0.806 MCC:0.744.
Training complete in 168m 8s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7597500733787718, 'acc': 0.8634803921568628, 'precision': 0.6733581875537712, 'recall': 0.8152777777777778, 'mcc': 0.651827070362521}, {'loss': 0.40644972842660904, 'acc': 0.9205216535433071, 'precision': 0.7875647668393783, 'recall': 0.9047619047619048, 'mcc': 0.7927313618905678}, {'loss': 0.3943081346714473, 'acc': 0.9016978346456693, 'precision': 0.725050916496945, 'recall': 0.9348739495798319, 'mcc': 0.762321924864637}, {'loss': 0.2651843200511057, 'acc': 0.9422982283464567, 'precision': 0.8442347673116903, 'recall': 0.9241946778711485, 'mcc': 0.8457974172181489}, {'loss': 0.5919542481286788, 'acc': 0.8901738845144357, 'precision': 0.7400316455696202, 'recall': 0.8188025210084033, 'mcc': 0.7063637159506122}]
Averge metrics over 5 folds:
average loss:  0.4835293009313225
average accuracy:  0.9036343986413463
average precision:  0.754048056754281
average recall:  0.8795821661998133
average mcc:  0.7518082980572973
cross-validation finished, end of program
