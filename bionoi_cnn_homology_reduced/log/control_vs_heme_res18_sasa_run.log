data directory: ../../bionoi_output/sasa/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_2', '../../bionoi_output/sasa/control/fold_3', '../../bionoi_output/sasa/control/fold_4', '../../bionoi_output/sasa/control/fold_5', '../../bionoi_output/sasa/heme/fold_2', '../../bionoi_output/sasa/heme/fold_3', '../../bionoi_output/sasa/heme/fold_4', '../../bionoi_output/sasa/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_1', '../../bionoi_output/sasa/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4988
train Accuracy:0.857 Precision:0.643 Recall:0.877 F1:0.742 MCC:0.662.
val Loss: 1.6064
val Accuracy:0.807 Precision:0.778 Recall:0.254 F1:0.383 MCC:0.369.
 
Epoch 2/8
---------------
train Loss: 0.3407
train Accuracy:0.909 Precision:0.748 Recall:0.921 F1:0.825 MCC:0.772.
val Loss: 1.0118
val Accuracy:0.781 Precision:0.522 Recall:0.796 F1:0.631 MCC:0.506.
 
Epoch 3/8
---------------
train Loss: 0.2506
train Accuracy:0.935 Precision:0.808 Recall:0.945 F1:0.871 MCC:0.832.
val Loss: 0.7848
val Accuracy:0.835 Precision:0.624 Recall:0.748 F1:0.680 MCC:0.574.
 
Epoch 4/8
---------------
train Loss: 0.1883
train Accuracy:0.951 Precision:0.851 Recall:0.958 F1:0.901 MCC:0.871.
val Loss: 0.8978
val Accuracy:0.871 Precision:0.714 Recall:0.752 F1:0.732 MCC:0.648.
 
Epoch 5/8
---------------
train Loss: 0.1477
train Accuracy:0.961 Precision:0.878 Recall:0.967 F1:0.921 MCC:0.897.
val Loss: 1.9385
val Accuracy:0.842 Precision:0.785 Recall:0.450 F1:0.572 MCC:0.512.
 
Epoch 6/8
---------------
train Loss: 0.1224
train Accuracy:0.968 Precision:0.899 Recall:0.973 F1:0.934 MCC:0.914.
val Loss: 2.0061
val Accuracy:0.864 Precision:0.853 Recall:0.512 F1:0.640 MCC:0.591.
 
Epoch 7/8
---------------
train Loss: 0.1090
train Accuracy:0.972 Precision:0.913 Recall:0.976 F1:0.943 MCC:0.926.
val Loss: 1.1084
val Accuracy:0.765 Precision:0.500 Recall:0.880 F1:0.638 MCC:0.525.
 
Epoch 8/8
---------------
train Loss: 0.0933
train Accuracy:0.977 Precision:0.926 Recall:0.979 F1:0.952 MCC:0.937.
val Loss: 1.7572
val Accuracy:0.848 Precision:0.726 Recall:0.568 F1:0.637 MCC:0.549.
Training complete in 167m 47s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_1', '../../bionoi_output/sasa/control/fold_3', '../../bionoi_output/sasa/control/fold_4', '../../bionoi_output/sasa/control/fold_5', '../../bionoi_output/sasa/heme/fold_1', '../../bionoi_output/sasa/heme/fold_3', '../../bionoi_output/sasa/heme/fold_4', '../../bionoi_output/sasa/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_2', '../../bionoi_output/sasa/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5482
train Accuracy:0.844 Precision:0.622 Recall:0.854 F1:0.720 MCC:0.630.
val Loss: 1.8348
val Accuracy:0.789 Precision:0.617 Recall:0.267 F1:0.373 MCC:0.303.
 
Epoch 2/8
---------------
train Loss: 0.3889
train Accuracy:0.895 Precision:0.722 Recall:0.900 F1:0.801 MCC:0.740.
val Loss: 0.6716
val Accuracy:0.835 Precision:0.602 Recall:0.873 F1:0.712 MCC:0.623.
 
Epoch 3/8
---------------
train Loss: 0.2845
train Accuracy:0.926 Precision:0.789 Recall:0.932 F1:0.854 MCC:0.810.
val Loss: 0.6805
val Accuracy:0.863 Precision:0.704 Recall:0.714 F1:0.709 MCC:0.619.
 
Epoch 4/8
---------------
train Loss: 0.2106
train Accuracy:0.946 Precision:0.839 Recall:0.951 F1:0.891 MCC:0.858.
val Loss: 0.6176
val Accuracy:0.824 Precision:0.581 Recall:0.890 F1:0.703 MCC:0.612.
 
Epoch 5/8
---------------
train Loss: 0.1629
train Accuracy:0.958 Precision:0.871 Recall:0.963 F1:0.915 MCC:0.889.
val Loss: 0.8580
val Accuracy:0.877 Precision:0.780 Recall:0.659 F1:0.714 MCC:0.640.
 
Epoch 6/8
---------------
train Loss: 0.1418
train Accuracy:0.964 Precision:0.887 Recall:0.968 F1:0.926 MCC:0.903.
val Loss: 0.6274
val Accuracy:0.852 Precision:0.629 Recall:0.904 F1:0.742 MCC:0.664.
 
Epoch 7/8
---------------
train Loss: 0.1114
train Accuracy:0.971 Precision:0.910 Recall:0.975 F1:0.941 MCC:0.923.
val Loss: 0.9178
val Accuracy:0.832 Precision:0.599 Recall:0.854 F1:0.704 MCC:0.610.
 
Epoch 8/8
---------------
train Loss: 0.1009
train Accuracy:0.974 Precision:0.918 Recall:0.977 F1:0.947 MCC:0.931.
val Loss: 0.8671
val Accuracy:0.879 Precision:0.713 Recall:0.807 F1:0.757 MCC:0.679.
Training complete in 167m 49s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_1', '../../bionoi_output/sasa/control/fold_2', '../../bionoi_output/sasa/control/fold_4', '../../bionoi_output/sasa/control/fold_5', '../../bionoi_output/sasa/heme/fold_1', '../../bionoi_output/sasa/heme/fold_2', '../../bionoi_output/sasa/heme/fold_4', '../../bionoi_output/sasa/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_3', '../../bionoi_output/sasa/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5414
train Accuracy:0.841 Precision:0.616 Recall:0.859 F1:0.718 MCC:0.628.
val Loss: 0.5217
val Accuracy:0.900 Precision:0.763 Recall:0.833 F1:0.796 MCC:0.731.
 
Epoch 2/8
---------------
train Loss: 0.3583
train Accuracy:0.901 Precision:0.732 Recall:0.914 F1:0.813 MCC:0.755.
val Loss: 0.5603
val Accuracy:0.916 Precision:0.843 Recall:0.788 F1:0.815 MCC:0.761.
 
Epoch 3/8
---------------
train Loss: 0.2589
train Accuracy:0.931 Precision:0.801 Recall:0.940 F1:0.865 MCC:0.824.
val Loss: 0.5378
val Accuracy:0.881 Precision:0.699 Recall:0.860 F1:0.771 MCC:0.698.
 
Epoch 4/8
---------------
train Loss: 0.1968
train Accuracy:0.948 Precision:0.845 Recall:0.954 F1:0.896 MCC:0.865.
val Loss: 0.5181
val Accuracy:0.901 Precision:0.738 Recall:0.895 F1:0.809 MCC:0.749.
 
Epoch 5/8
---------------
train Loss: 0.1510
train Accuracy:0.961 Precision:0.880 Recall:0.967 F1:0.922 MCC:0.898.
val Loss: 0.4537
val Accuracy:0.906 Precision:0.747 Recall:0.908 F1:0.819 MCC:0.764.
 
Epoch 6/8
---------------
train Loss: 0.1256
train Accuracy:0.968 Precision:0.901 Recall:0.971 F1:0.935 MCC:0.915.
val Loss: 0.6559
val Accuracy:0.895 Precision:0.728 Recall:0.882 F1:0.798 MCC:0.734.
 
Epoch 7/8
---------------
train Loss: 0.1053
train Accuracy:0.974 Precision:0.917 Recall:0.976 F1:0.946 MCC:0.929.
val Loss: 1.0641
val Accuracy:0.914 Precision:0.930 Recall:0.684 F1:0.788 MCC:0.749.
 
Epoch 8/8
---------------
train Loss: 0.1016
train Accuracy:0.975 Precision:0.920 Recall:0.978 F1:0.948 MCC:0.932.
val Loss: 0.5672
val Accuracy:0.916 Precision:0.802 Recall:0.852 F1:0.826 MCC:0.772.
Training complete in 167m 55s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_1', '../../bionoi_output/sasa/control/fold_2', '../../bionoi_output/sasa/control/fold_3', '../../bionoi_output/sasa/control/fold_5', '../../bionoi_output/sasa/heme/fold_1', '../../bionoi_output/sasa/heme/fold_2', '../../bionoi_output/sasa/heme/fold_3', '../../bionoi_output/sasa/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_4', '../../bionoi_output/sasa/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5523
train Accuracy:0.838 Precision:0.611 Recall:0.857 F1:0.713 MCC:0.622.
val Loss: 0.7607
val Accuracy:0.870 Precision:0.860 Recall:0.533 F1:0.658 MCC:0.609.
 
Epoch 2/8
---------------
train Loss: 0.3760
train Accuracy:0.897 Precision:0.723 Recall:0.908 F1:0.805 MCC:0.745.
val Loss: 0.3909
val Accuracy:0.921 Precision:0.814 Recall:0.862 F1:0.837 MCC:0.786.
 
Epoch 3/8
---------------
train Loss: 0.2771
train Accuracy:0.926 Precision:0.788 Recall:0.935 F1:0.855 MCC:0.811.
val Loss: 0.6070
val Accuracy:0.786 Precision:0.523 Recall:0.983 F1:0.683 MCC:0.605.
 
Epoch 4/8
---------------
train Loss: 0.2048
train Accuracy:0.946 Precision:0.838 Recall:0.954 F1:0.892 MCC:0.860.
val Loss: 0.4633
val Accuracy:0.911 Precision:0.757 Recall:0.913 F1:0.827 MCC:0.774.
 
Epoch 5/8
---------------
train Loss: 0.1622
train Accuracy:0.958 Precision:0.869 Recall:0.964 F1:0.914 MCC:0.888.
val Loss: 0.4518
val Accuracy:0.903 Precision:0.734 Recall:0.918 F1:0.816 MCC:0.760.
 
Epoch 6/8
---------------
train Loss: 0.1351
train Accuracy:0.966 Precision:0.893 Recall:0.970 F1:0.930 MCC:0.909.
val Loss: 0.5504
val Accuracy:0.866 Precision:0.651 Recall:0.923 F1:0.764 MCC:0.694.
 
Epoch 7/8
---------------
train Loss: 0.1149
train Accuracy:0.971 Precision:0.907 Recall:0.975 F1:0.940 MCC:0.922.
val Loss: 1.3781
val Accuracy:0.870 Precision:0.891 Recall:0.508 F1:0.647 MCC:0.609.
 
Epoch 8/8
---------------
train Loss: 0.1072
train Accuracy:0.973 Precision:0.914 Recall:0.976 F1:0.944 MCC:0.927.
val Loss: 0.5983
val Accuracy:0.857 Precision:0.629 Recall:0.949 F1:0.756 MCC:0.689.
Training complete in 167m 53s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_1', '../../bionoi_output/sasa/control/fold_2', '../../bionoi_output/sasa/control/fold_3', '../../bionoi_output/sasa/control/fold_4', '../../bionoi_output/sasa/heme/fold_1', '../../bionoi_output/sasa/heme/fold_2', '../../bionoi_output/sasa/heme/fold_3', '../../bionoi_output/sasa/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/sasa/control/fold_5', '../../bionoi_output/sasa/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5326
train Accuracy:0.847 Precision:0.625 Recall:0.863 F1:0.725 MCC:0.638.
val Loss: 0.6525
val Accuracy:0.852 Precision:0.654 Recall:0.782 F1:0.712 MCC:0.618.
 
Epoch 2/8
---------------
train Loss: 0.3669
train Accuracy:0.901 Precision:0.731 Recall:0.912 F1:0.812 MCC:0.754.
val Loss: 0.5675
val Accuracy:0.882 Precision:0.723 Recall:0.806 F1:0.762 MCC:0.686.
 
Epoch 3/8
---------------
train Loss: 0.2703
train Accuracy:0.928 Precision:0.795 Recall:0.936 F1:0.860 MCC:0.817.
val Loss: 0.6859
val Accuracy:0.813 Precision:0.565 Recall:0.883 F1:0.689 MCC:0.594.
 
Epoch 4/8
---------------
train Loss: 0.2046
train Accuracy:0.946 Precision:0.838 Recall:0.953 F1:0.892 MCC:0.859.
val Loss: 0.6800
val Accuracy:0.836 Precision:0.603 Recall:0.877 F1:0.715 MCC:0.626.
 
Epoch 5/8
---------------
train Loss: 0.1595
train Accuracy:0.959 Precision:0.873 Recall:0.964 F1:0.916 MCC:0.890.
val Loss: 0.7361
val Accuracy:0.869 Precision:0.677 Recall:0.841 F1:0.750 MCC:0.670.
 
Epoch 6/8
---------------
train Loss: 0.1282
train Accuracy:0.967 Precision:0.897 Recall:0.972 F1:0.933 MCC:0.913.
val Loss: 0.6881
val Accuracy:0.887 Precision:0.724 Recall:0.839 F1:0.777 MCC:0.706.
 
Epoch 7/8
---------------
train Loss: 0.1136
train Accuracy:0.971 Precision:0.909 Recall:0.975 F1:0.941 MCC:0.923.
val Loss: 1.4734
val Accuracy:0.845 Precision:0.718 Recall:0.560 F1:0.629 MCC:0.540.
 
Epoch 8/8
---------------
train Loss: 0.1003
train Accuracy:0.975 Precision:0.920 Recall:0.977 F1:0.948 MCC:0.932.
val Loss: 0.9039
val Accuracy:0.881 Precision:0.746 Recall:0.749 F1:0.748 MCC:0.670.
Training complete in 167m 59s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.784753688721875, 'acc': 0.8345179738562092, 'precision': 0.6237150716664254, 'recall': 0.7479166666666667, 'mcc': 0.574079017365646}, {'loss': 0.6175585418079156, 'acc': 0.8239009186351706, 'precision': 0.5810656300022867, 'recall': 0.8897058823529411, 'mcc': 0.6123867136495763}, {'loss': 0.45369973124598895, 'acc': 0.9063320209973753, 'precision': 0.7469740634005764, 'recall': 0.907563025210084, 'mcc': 0.7635793240291314}, {'loss': 0.3909135906763981, 'acc': 0.9214238845144357, 'precision': 0.8137190082644629, 'recall': 0.8618697478991597, 'mcc': 0.785946968142466}, {'loss': 0.5675168095591656, 'acc': 0.8821358267716536, 'precision': 0.72276295133438, 'recall': 0.8060224089635855, 'mcc': 0.6858898877233015}]
Averge metrics over 5 folds:
average loss:  0.5628884724022687
average accuracy:  0.8736621249549689
average precision:  0.6976473449336262
average recall:  0.8426155462184873
average mcc:  0.6843763821820243
cross-validation finished, end of program
