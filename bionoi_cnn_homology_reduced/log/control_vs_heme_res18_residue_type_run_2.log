data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3783
train Accuracy:0.905 Precision:0.745 Recall:0.902 F1:0.816 MCC:0.759.
val Loss: 0.8873
val Accuracy:0.876 Precision:0.806 Recall:0.621 F1:0.702 MCC:0.633.
 
Epoch 2/8
---------------
train Loss: 0.2365
train Accuracy:0.942 Precision:0.836 Recall:0.938 F1:0.884 MCC:0.848.
val Loss: 0.8362
val Accuracy:0.888 Precision:0.802 Recall:0.698 F1:0.746 MCC:0.678.
 
Epoch 3/8
---------------
train Loss: 0.1545
train Accuracy:0.962 Precision:0.887 Recall:0.962 F1:0.923 MCC:0.899.
val Loss: 0.7826
val Accuracy:0.893 Precision:0.784 Recall:0.754 F1:0.769 MCC:0.700.
 
Epoch 4/8
---------------
train Loss: 0.1080
train Accuracy:0.973 Precision:0.917 Recall:0.974 F1:0.945 MCC:0.928.
val Loss: 1.1904
val Accuracy:0.879 Precision:0.780 Recall:0.678 F1:0.726 MCC:0.651.
 
Epoch 5/8
---------------
train Loss: 0.0835
train Accuracy:0.980 Precision:0.936 Recall:0.980 F1:0.957 MCC:0.944.
val Loss: 1.6366
val Accuracy:0.891 Precision:0.888 Recall:0.616 F1:0.727 MCC:0.680.
 
Epoch 6/8
---------------
train Loss: 0.0699
train Accuracy:0.983 Precision:0.947 Recall:0.983 F1:0.965 MCC:0.954.
val Loss: 1.6539
val Accuracy:0.890 Precision:0.877 Recall:0.618 F1:0.725 MCC:0.674.
 
Epoch 7/8
---------------
train Loss: 0.0610
train Accuracy:0.986 Precision:0.954 Recall:0.986 F1:0.970 MCC:0.961.
val Loss: 2.2369
val Accuracy:0.864 Precision:0.818 Recall:0.545 F1:0.654 MCC:0.592.
 
Epoch 8/8
---------------
train Loss: 0.0561
train Accuracy:0.987 Precision:0.958 Recall:0.987 F1:0.972 MCC:0.964.
val Loss: 1.5151
val Accuracy:0.886 Precision:0.831 Recall:0.650 F1:0.729 MCC:0.667.
Training complete in 168m 2s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4244
train Accuracy:0.889 Precision:0.712 Recall:0.885 F1:0.789 MCC:0.723.
val Loss: 0.5256
val Accuracy:0.921 Precision:0.906 Recall:0.737 F1:0.813 MCC:0.770.
 
Epoch 2/8
---------------
train Loss: 0.2527
train Accuracy:0.937 Precision:0.821 Recall:0.934 F1:0.874 MCC:0.835.
val Loss: 0.4010
val Accuracy:0.922 Precision:0.795 Recall:0.899 F1:0.844 MCC:0.795.
 
Epoch 3/8
---------------
train Loss: 0.1604
train Accuracy:0.962 Precision:0.886 Recall:0.960 F1:0.922 MCC:0.897.
val Loss: 0.4555
val Accuracy:0.907 Precision:0.759 Recall:0.884 F1:0.817 MCC:0.759.
 
Epoch 4/8
---------------
train Loss: 0.1141
train Accuracy:0.972 Precision:0.915 Recall:0.972 F1:0.943 MCC:0.925.
val Loss: 0.4824
val Accuracy:0.925 Precision:0.838 Recall:0.845 F1:0.841 MCC:0.792.
 
Epoch 5/8
---------------
train Loss: 0.0925
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.4667
val Accuracy:0.939 Precision:0.877 Recall:0.863 F1:0.869 MCC:0.830.
 
Epoch 6/8
---------------
train Loss: 0.0767
train Accuracy:0.982 Precision:0.944 Recall:0.981 F1:0.963 MCC:0.951.
val Loss: 0.4173
val Accuracy:0.932 Precision:0.824 Recall:0.901 F1:0.861 MCC:0.818.
 
Epoch 7/8
---------------
train Loss: 0.0682
train Accuracy:0.983 Precision:0.947 Recall:0.984 F1:0.965 MCC:0.955.
val Loss: 0.4229
val Accuracy:0.931 Precision:0.817 Recall:0.908 F1:0.860 MCC:0.816.
 
Epoch 8/8
---------------
train Loss: 0.0581
train Accuracy:0.986 Precision:0.955 Recall:0.987 F1:0.971 MCC:0.962.
val Loss: 0.4376
val Accuracy:0.927 Precision:0.801 Recall:0.915 F1:0.854 MCC:0.809.
Training complete in 168m 39s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4262
train Accuracy:0.888 Precision:0.708 Recall:0.886 F1:0.787 MCC:0.721.
val Loss: 0.4187
val Accuracy:0.930 Precision:0.841 Recall:0.866 F1:0.853 MCC:0.808.
 
Epoch 2/8
---------------
train Loss: 0.2612
train Accuracy:0.933 Precision:0.813 Recall:0.931 F1:0.868 MCC:0.827.
val Loss: 0.3999
val Accuracy:0.920 Precision:0.783 Recall:0.909 F1:0.841 MCC:0.792.
 
Epoch 3/8
---------------
train Loss: 0.1772
train Accuracy:0.956 Precision:0.869 Recall:0.957 F1:0.911 MCC:0.884.
val Loss: 0.5703
val Accuracy:0.927 Precision:0.852 Recall:0.832 F1:0.842 MCC:0.794.
 
Epoch 4/8
---------------
train Loss: 0.1300
train Accuracy:0.967 Precision:0.900 Recall:0.967 F1:0.933 MCC:0.912.
val Loss: 0.3453
val Accuracy:0.925 Precision:0.782 Recall:0.944 F1:0.855 MCC:0.812.
 
Epoch 5/8
---------------
train Loss: 0.1002
train Accuracy:0.976 Precision:0.925 Recall:0.976 F1:0.950 MCC:0.934.
val Loss: 0.3578
val Accuracy:0.936 Precision:0.831 Recall:0.914 F1:0.870 MCC:0.830.
 
Epoch 6/8
---------------
train Loss: 0.0793
train Accuracy:0.981 Precision:0.939 Recall:0.983 F1:0.961 MCC:0.949.
val Loss: 0.5648
val Accuracy:0.940 Precision:0.891 Recall:0.845 F1:0.868 MCC:0.829.
 
Epoch 7/8
---------------
train Loss: 0.0721
train Accuracy:0.983 Precision:0.947 Recall:0.984 F1:0.965 MCC:0.954.
val Loss: 0.4168
val Accuracy:0.950 Precision:0.875 Recall:0.920 F1:0.897 MCC:0.865.
 
Epoch 8/8
---------------
train Loss: 0.0632
train Accuracy:0.985 Precision:0.953 Recall:0.986 F1:0.969 MCC:0.960.
val Loss: 0.5661
val Accuracy:0.949 Precision:0.909 Recall:0.871 F1:0.889 MCC:0.857.
Training complete in 168m 45s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4362
train Accuracy:0.886 Precision:0.706 Recall:0.881 F1:0.784 MCC:0.716.
val Loss: 0.3355
val Accuracy:0.917 Precision:0.778 Recall:0.902 F1:0.835 MCC:0.784.
 
Epoch 2/8
---------------
train Loss: 0.2630
train Accuracy:0.934 Precision:0.814 Recall:0.932 F1:0.869 MCC:0.829.
val Loss: 0.3806
val Accuracy:0.943 Precision:0.890 Recall:0.864 F1:0.877 MCC:0.840.
 
Epoch 3/8
---------------
train Loss: 0.1761
train Accuracy:0.956 Precision:0.869 Recall:0.956 F1:0.911 MCC:0.883.
val Loss: 0.5431
val Accuracy:0.853 Precision:0.617 Recall:0.979 F1:0.757 MCC:0.695.
 
Epoch 4/8
---------------
train Loss: 0.1263
train Accuracy:0.970 Precision:0.907 Recall:0.970 F1:0.938 MCC:0.919.
val Loss: 0.2724
val Accuracy:0.948 Precision:0.870 Recall:0.915 F1:0.892 MCC:0.858.
 
Epoch 5/8
---------------
train Loss: 0.0985
train Accuracy:0.976 Precision:0.924 Recall:0.976 F1:0.950 MCC:0.934.
val Loss: 0.5061
val Accuracy:0.883 Precision:0.678 Recall:0.957 F1:0.794 MCC:0.736.
 
Epoch 6/8
---------------
train Loss: 0.0852
train Accuracy:0.980 Precision:0.937 Recall:0.979 F1:0.958 MCC:0.945.
val Loss: 0.3940
val Accuracy:0.924 Precision:0.777 Recall:0.945 F1:0.853 MCC:0.809.
 
Epoch 7/8
---------------
train Loss: 0.0755
train Accuracy:0.982 Precision:0.944 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.5820
val Accuracy:0.937 Precision:0.920 Recall:0.803 F1:0.857 MCC:0.821.
 
Epoch 8/8
---------------
train Loss: 0.0660
train Accuracy:0.984 Precision:0.951 Recall:0.984 F1:0.967 MCC:0.957.
val Loss: 0.4853
val Accuracy:0.899 Precision:0.717 Recall:0.940 F1:0.813 MCC:0.759.
Training complete in 168m 30s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4037
train Accuracy:0.896 Precision:0.726 Recall:0.893 F1:0.801 MCC:0.739.
val Loss: 0.5455
val Accuracy:0.901 Precision:0.801 Recall:0.771 F1:0.786 MCC:0.722.
 
Epoch 2/8
---------------
train Loss: 0.2407
train Accuracy:0.940 Precision:0.828 Recall:0.939 F1:0.880 MCC:0.843.
val Loss: 0.5957
val Accuracy:0.900 Precision:0.816 Recall:0.738 F1:0.775 MCC:0.712.
 
Epoch 3/8
---------------
train Loss: 0.1530
train Accuracy:0.962 Precision:0.887 Recall:0.963 F1:0.923 MCC:0.900.
val Loss: 0.5777
val Accuracy:0.854 Precision:0.640 Recall:0.864 F1:0.735 MCC:0.652.
 
Epoch 4/8
---------------
train Loss: 0.1099
train Accuracy:0.974 Precision:0.918 Recall:0.975 F1:0.946 MCC:0.929.
val Loss: 0.7488
val Accuracy:0.894 Precision:0.750 Recall:0.823 F1:0.785 MCC:0.716.
 
Epoch 5/8
---------------
train Loss: 0.0898
train Accuracy:0.979 Precision:0.934 Recall:0.979 F1:0.956 MCC:0.942.
val Loss: 0.7851
val Accuracy:0.883 Precision:0.729 Recall:0.800 F1:0.763 MCC:0.687.
 
Epoch 6/8
---------------
train Loss: 0.0775
train Accuracy:0.982 Precision:0.942 Recall:0.982 F1:0.962 MCC:0.950.
val Loss: 0.6665
val Accuracy:0.916 Precision:0.828 Recall:0.811 F1:0.819 MCC:0.765.
 
Epoch 7/8
---------------
train Loss: 0.0671
train Accuracy:0.984 Precision:0.950 Recall:0.984 F1:0.967 MCC:0.956.
val Loss: 0.8338
val Accuracy:0.894 Precision:0.754 Recall:0.816 F1:0.784 MCC:0.715.
 
Epoch 8/8
---------------
train Loss: 0.0612
train Accuracy:0.985 Precision:0.952 Recall:0.986 F1:0.969 MCC:0.959.
val Loss: 0.9666
val Accuracy:0.887 Precision:0.736 Recall:0.809 F1:0.771 MCC:0.698.
Training complete in 168m 33s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7825969003773983, 'acc': 0.8932189542483661, 'precision': 0.7839350180505416, 'recall': 0.7539930555555555, 'mcc': 0.6995203047016383}, {'loss': 0.40103328176419645, 'acc': 0.9220390419947506, 'precision': 0.7950147081591578, 'recall': 0.898984593837535, 'mcc': 0.7947812993052765}, {'loss': 0.3452597766175983, 'acc': 0.9251968503937008, 'precision': 0.7820661636680208, 'recall': 0.9436274509803921, 'mcc': 0.8118982637027579}, {'loss': 0.27240552017868563, 'acc': 0.9481627296587927, 'precision': 0.8704197201865423, 'recall': 0.9149159663865546, 'mcc': 0.8584888707927582}, {'loss': 0.5454850900341363, 'acc': 0.9014927821522309, 'precision': 0.8010185522008003, 'recall': 0.7710084033613446, 'mcc': 0.722024679663785}]
Averge metrics over 5 folds:
average loss:  0.46935611379440295
average accuracy:  0.9180220716895683
average precision:  0.8064908324530127
average recall:  0.8565058940242765
average mcc:  0.7773426836332431
cross-validation finished, end of program
