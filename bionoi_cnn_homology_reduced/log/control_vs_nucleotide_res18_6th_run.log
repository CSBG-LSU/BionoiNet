data directory: ../../data_homology_reduced/images/
batch size: 256
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3461
train Accuracy:0.866 Precision:0.836 Recall:0.868 F1:0.851 MCC:0.729.
val Loss: 0.4908
val Accuracy:0.827 Precision:0.761 Recall:0.888 F1:0.820 MCC:0.662.
 
Epoch 2/8
---------------
train Loss: 0.2136
train Accuracy:0.921 Precision:0.905 Recall:0.918 F1:0.911 MCC:0.839.
val Loss: 0.4586
val Accuracy:0.840 Precision:0.801 Recall:0.849 F1:0.825 MCC:0.678.
 
Epoch 3/8
---------------
train Loss: 0.1438
train Accuracy:0.949 Precision:0.938 Recall:0.947 F1:0.943 MCC:0.897.
val Loss: 0.6264
val Accuracy:0.838 Precision:0.828 Recall:0.801 F1:0.814 MCC:0.671.
 
Epoch 4/8
---------------
train Loss: 0.1040
train Accuracy:0.964 Precision:0.957 Recall:0.963 F1:0.960 MCC:0.928.
val Loss: 0.6407
val Accuracy:0.843 Precision:0.858 Recall:0.773 F1:0.813 MCC:0.681.
 
Epoch 5/8
---------------
train Loss: 0.0750
train Accuracy:0.974 Precision:0.969 Recall:0.973 F1:0.971 MCC:0.948.
val Loss: 0.7799
val Accuracy:0.827 Precision:0.879 Recall:0.709 F1:0.785 MCC:0.654.
 
Epoch 6/8
---------------
train Loss: 0.0605
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.977 MCC:0.959.
val Loss: 0.7755
val Accuracy:0.827 Precision:0.791 Recall:0.830 F1:0.810 MCC:0.652.
 
Epoch 7/8
---------------
train Loss: 0.0525
train Accuracy:0.983 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.965.
val Loss: 0.7612
val Accuracy:0.844 Precision:0.860 Recall:0.774 F1:0.815 MCC:0.684.
 
Epoch 8/8
---------------
train Loss: 0.0478
train Accuracy:0.984 Precision:0.980 Recall:0.984 F1:0.982 MCC:0.967.
val Loss: 0.7396
val Accuracy:0.825 Precision:0.855 Recall:0.729 F1:0.787 MCC:0.646.
Training complete in 130m 1s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3684
train Accuracy:0.854 Precision:0.822 Recall:0.857 F1:0.839 MCC:0.706.
val Loss: 0.4256
val Accuracy:0.827 Precision:0.772 Recall:0.868 F1:0.817 MCC:0.659.
 
Epoch 2/8
---------------
train Loss: 0.2325
train Accuracy:0.913 Precision:0.892 Recall:0.913 F1:0.903 MCC:0.824.
val Loss: 0.5092
val Accuracy:0.844 Precision:0.805 Recall:0.857 F1:0.830 MCC:0.688.
 
Epoch 3/8
---------------
train Loss: 0.1583
train Accuracy:0.943 Precision:0.930 Recall:0.942 F1:0.936 MCC:0.884.
val Loss: 0.5782
val Accuracy:0.852 Precision:0.917 Recall:0.732 F1:0.814 MCC:0.706.
 
Epoch 4/8
---------------
train Loss: 0.1087
train Accuracy:0.963 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.925.
val Loss: 0.4999
val Accuracy:0.863 Precision:0.876 Recall:0.804 F1:0.839 MCC:0.721.
 
Epoch 5/8
---------------
train Loss: 0.0804
train Accuracy:0.972 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.944.
val Loss: 0.5546
val Accuracy:0.875 Precision:0.887 Recall:0.823 F1:0.854 MCC:0.746.
 
Epoch 6/8
---------------
train Loss: 0.0632
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.976 MCC:0.957.
val Loss: 0.6261
val Accuracy:0.869 Precision:0.888 Recall:0.808 F1:0.846 MCC:0.736.
 
Epoch 7/8
---------------
train Loss: 0.0537
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.5877
val Accuracy:0.866 Precision:0.832 Recall:0.875 F1:0.853 MCC:0.731.
 
Epoch 8/8
---------------
train Loss: 0.0471
train Accuracy:0.985 Precision:0.981 Recall:0.985 F1:0.983 MCC:0.969.
val Loss: 0.8067
val Accuracy:0.846 Precision:0.796 Recall:0.878 F1:0.835 MCC:0.693.
Training complete in 130m 16s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3712
train Accuracy:0.852 Precision:0.818 Recall:0.855 F1:0.836 MCC:0.701.
val Loss: 0.4213
val Accuracy:0.827 Precision:0.737 Recall:0.948 F1:0.830 MCC:0.681.
 
Epoch 2/8
---------------
train Loss: 0.2330
train Accuracy:0.912 Precision:0.894 Recall:0.910 F1:0.902 MCC:0.822.
val Loss: 0.3709
val Accuracy:0.879 Precision:0.886 Recall:0.834 F1:0.860 MCC:0.754.
 
Epoch 3/8
---------------
train Loss: 0.1571
train Accuracy:0.944 Precision:0.932 Recall:0.942 F1:0.937 MCC:0.886.
val Loss: 0.5763
val Accuracy:0.867 Precision:0.910 Recall:0.779 F1:0.839 MCC:0.734.
 
Epoch 4/8
---------------
train Loss: 0.1071
train Accuracy:0.963 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.924.
val Loss: 0.6040
val Accuracy:0.858 Precision:0.928 Recall:0.737 F1:0.821 MCC:0.719.
 
Epoch 5/8
---------------
train Loss: 0.0751
train Accuracy:0.975 Precision:0.969 Recall:0.974 F1:0.971 MCC:0.949.
val Loss: 0.7043
val Accuracy:0.846 Precision:0.865 Recall:0.773 F1:0.816 MCC:0.687.
 
Epoch 6/8
---------------
train Loss: 0.0639
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.976 MCC:0.956.
val Loss: 0.6924
val Accuracy:0.869 Precision:0.875 Recall:0.822 F1:0.847 MCC:0.733.
 
Epoch 7/8
---------------
train Loss: 0.0533
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.5530
val Accuracy:0.867 Precision:0.881 Recall:0.810 F1:0.844 MCC:0.730.
 
Epoch 8/8
---------------
train Loss: 0.0471
train Accuracy:0.984 Precision:0.981 Recall:0.984 F1:0.982 MCC:0.968.
val Loss: 0.5155
val Accuracy:0.882 Precision:0.902 Recall:0.824 F1:0.861 MCC:0.762.
Training complete in 130m 22s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3463
train Accuracy:0.864 Precision:0.834 Recall:0.866 F1:0.850 MCC:0.726.
val Loss: 0.4406
val Accuracy:0.834 Precision:0.786 Recall:0.859 F1:0.821 MCC:0.669.
 
Epoch 2/8
---------------
train Loss: 0.2095
train Accuracy:0.923 Precision:0.908 Recall:0.919 F1:0.914 MCC:0.844.
val Loss: 0.4969
val Accuracy:0.839 Precision:0.807 Recall:0.837 F1:0.821 MCC:0.675.
 
Epoch 3/8
---------------
train Loss: 0.1410
train Accuracy:0.950 Precision:0.940 Recall:0.949 F1:0.944 MCC:0.900.
val Loss: 0.6333
val Accuracy:0.826 Precision:0.831 Recall:0.764 F1:0.796 MCC:0.647.
 
Epoch 4/8
---------------
train Loss: 0.0996
train Accuracy:0.965 Precision:0.958 Recall:0.964 F1:0.961 MCC:0.930.
val Loss: 0.5802
val Accuracy:0.852 Precision:0.818 Recall:0.856 F1:0.837 MCC:0.701.
 
Epoch 5/8
---------------
train Loss: 0.0729
train Accuracy:0.975 Precision:0.970 Recall:0.974 F1:0.972 MCC:0.950.
val Loss: 0.8977
val Accuracy:0.824 Precision:0.847 Recall:0.737 F1:0.788 MCC:0.644.
 
Epoch 6/8
---------------
train Loss: 0.0595
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.8375
val Accuracy:0.853 Precision:0.878 Recall:0.776 F1:0.824 MCC:0.703.
 
Epoch 7/8
---------------
train Loss: 0.0528
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6388
val Accuracy:0.843 Precision:0.806 Recall:0.852 F1:0.828 MCC:0.685.
 
Epoch 8/8
---------------
train Loss: 0.0453
train Accuracy:0.985 Precision:0.982 Recall:0.985 F1:0.983 MCC:0.970.
val Loss: 0.8104
val Accuracy:0.837 Precision:0.821 Recall:0.808 F1:0.814 MCC:0.668.
Training complete in 130m 14s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3450
train Accuracy:0.863 Precision:0.833 Recall:0.865 F1:0.849 MCC:0.725.
val Loss: 0.4969
val Accuracy:0.818 Precision:0.751 Recall:0.880 F1:0.811 MCC:0.644.
 
Epoch 2/8
---------------
train Loss: 0.2093
train Accuracy:0.923 Precision:0.907 Recall:0.922 F1:0.915 MCC:0.845.
val Loss: 0.5897
val Accuracy:0.825 Precision:0.857 Recall:0.727 F1:0.787 MCC:0.647.
 
Epoch 3/8
---------------
train Loss: 0.1431
train Accuracy:0.949 Precision:0.938 Recall:0.947 F1:0.943 MCC:0.897.
val Loss: 0.6935
val Accuracy:0.812 Precision:0.745 Recall:0.878 F1:0.806 MCC:0.635.
 
Epoch 4/8
---------------
train Loss: 0.1015
train Accuracy:0.966 Precision:0.958 Recall:0.964 F1:0.961 MCC:0.930.
val Loss: 0.6434
val Accuracy:0.823 Precision:0.847 Recall:0.734 F1:0.786 MCC:0.641.
 
Epoch 5/8
---------------
train Loss: 0.0741
train Accuracy:0.975 Precision:0.969 Recall:0.975 F1:0.972 MCC:0.949.
val Loss: 0.8298
val Accuracy:0.825 Precision:0.799 Recall:0.809 F1:0.804 MCC:0.645.
 
Epoch 6/8
---------------
train Loss: 0.0589
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.978 MCC:0.961.
val Loss: 0.8337
val Accuracy:0.838 Precision:0.802 Recall:0.843 F1:0.822 MCC:0.675.
 
Epoch 7/8
---------------
train Loss: 0.0527
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.9271
val Accuracy:0.841 Precision:0.802 Recall:0.852 F1:0.827 MCC:0.682.
 
Epoch 8/8
---------------
train Loss: 0.0442
train Accuracy:0.985 Precision:0.982 Recall:0.985 F1:0.984 MCC:0.970.
val Loss: 0.9869
val Accuracy:0.818 Precision:0.761 Recall:0.860 F1:0.807 MCC:0.640.
Training complete in 130m 5s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.458620337477991, 'acc': 0.8396932952924394, 'precision': 0.8014417604654104, 'recall': 0.8490085744908896, 'mcc': 0.6781566166710333}, {'loss': 0.4256460610457829, 'acc': 0.8273809523809523, 'precision': 0.771796093377799, 'recall': 0.8681672025723473, 'mcc': 0.6588117035451386}, {'loss': 0.3708632789339338, 'acc': 0.8789583333333333, 'precision': 0.8864849476905559, 'recall': 0.8344051446945338, 'mcc': 0.7544880642536367}, {'loss': 0.4405892053472467, 'acc': 0.833929422985217, 'precision': 0.7861182835362105, 'recall': 0.8593413978494624, 'mcc': 0.6690167324712379}, {'loss': 0.4968863165713971, 'acc': 0.817745588936576, 'precision': 0.7514775922419235, 'recall': 0.8801075268817204, 'mcc': 0.6444885621370671}]
Averge metrics over 5 folds:
average loss:  0.43852103987527036
average accuracy:  0.8395415185857036
average precision:  0.7994637354623798
average recall:  0.8582059692977907
average mcc:  0.6809923358156228
cross-validation finished, end of program
