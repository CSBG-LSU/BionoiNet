data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5455
train Accuracy:0.770 Precision:0.729 Recall:0.767 F1:0.747 MCC:0.537.
val Loss: 0.5047
val Accuracy:0.797 Precision:0.794 Recall:0.731 F1:0.761 MCC:0.586.
 
Epoch 2/8
---------------
train Loss: 0.4654
train Accuracy:0.813 Precision:0.777 Recall:0.810 F1:0.793 MCC:0.622.
val Loss: 0.4651
val Accuracy:0.794 Precision:0.724 Recall:0.867 F1:0.789 MCC:0.601.
 
Epoch 3/8
---------------
train Loss: 0.4181
train Accuracy:0.834 Precision:0.804 Recall:0.828 F1:0.816 MCC:0.665.
val Loss: 0.4331
val Accuracy:0.812 Precision:0.751 Recall:0.861 F1:0.802 MCC:0.629.
 
Epoch 4/8
---------------
train Loss: 0.3969
train Accuracy:0.844 Precision:0.815 Recall:0.839 F1:0.827 MCC:0.685.
val Loss: 0.4676
val Accuracy:0.805 Precision:0.786 Recall:0.771 F1:0.779 MCC:0.605.
 
Epoch 5/8
---------------
train Loss: 0.3839
train Accuracy:0.850 Precision:0.823 Recall:0.844 F1:0.833 MCC:0.697.
val Loss: 0.4719
val Accuracy:0.815 Precision:0.798 Recall:0.779 F1:0.789 MCC:0.624.
 
Epoch 6/8
---------------
train Loss: 0.3736
train Accuracy:0.854 Precision:0.828 Recall:0.849 F1:0.838 MCC:0.706.
val Loss: 0.4577
val Accuracy:0.807 Precision:0.748 Recall:0.851 F1:0.796 MCC:0.619.
 
Epoch 7/8
---------------
train Loss: 0.3637
train Accuracy:0.858 Precision:0.832 Recall:0.852 F1:0.842 MCC:0.713.
val Loss: 0.4105
val Accuracy:0.823 Precision:0.779 Recall:0.838 F1:0.808 MCC:0.645.
 
Epoch 8/8
---------------
train Loss: 0.3593
train Accuracy:0.860 Precision:0.835 Recall:0.853 F1:0.844 MCC:0.717.
val Loss: 0.4121
val Accuracy:0.828 Precision:0.803 Recall:0.812 F1:0.808 MCC:0.653.
Training complete in 207m 44s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.002
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5595
train Accuracy:0.760 Precision:0.719 Recall:0.753 F1:0.735 MCC:0.516.
val Loss: 0.4859
val Accuracy:0.795 Precision:0.757 Recall:0.794 F1:0.775 MCC:0.588.
 
Epoch 2/8
---------------
train Loss: 0.4761
train Accuracy:0.803 Precision:0.765 Recall:0.802 F1:0.783 MCC:0.603.
val Loss: 0.5388
val Accuracy:0.776 Precision:0.872 Recall:0.580 F1:0.696 MCC:0.558.
 
Epoch 3/8
---------------
train Loss: 0.4381
train Accuracy:0.821 Precision:0.787 Recall:0.819 F1:0.802 MCC:0.639.
val Loss: 0.4088
val Accuracy:0.838 Precision:0.792 Recall:0.864 F1:0.826 MCC:0.678.
 
Epoch 4/8
---------------
train Loss: 0.4209
train Accuracy:0.830 Precision:0.797 Recall:0.826 F1:0.811 MCC:0.656.
val Loss: 0.4566
val Accuracy:0.812 Precision:0.727 Recall:0.924 F1:0.814 MCC:0.649.
 
Epoch 5/8
---------------
train Loss: 0.4087
train Accuracy:0.835 Precision:0.804 Recall:0.830 F1:0.817 MCC:0.667.
val Loss: 0.4195
val Accuracy:0.834 Precision:0.810 Recall:0.818 F1:0.814 MCC:0.664.
 
Epoch 6/8
---------------
