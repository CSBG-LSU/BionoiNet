data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3761
train Accuracy:0.905 Precision:0.746 Recall:0.904 F1:0.817 MCC:0.761.
val Loss: 1.0534
val Accuracy:0.862 Precision:0.790 Recall:0.563 F1:0.658 MCC:0.587.
 
Epoch 2/8
---------------
train Loss: 0.2352
train Accuracy:0.943 Precision:0.838 Recall:0.940 F1:0.886 MCC:0.851.
val Loss: 0.7737
val Accuracy:0.867 Precision:0.698 Recall:0.768 F1:0.732 MCC:0.645.
 
Epoch 3/8
---------------
train Loss: 0.1505
train Accuracy:0.964 Precision:0.891 Recall:0.964 F1:0.926 MCC:0.904.
val Loss: 0.7597
val Accuracy:0.846 Precision:0.636 Recall:0.812 F1:0.713 MCC:0.619.
 
Epoch 4/8
---------------
train Loss: 0.1081
train Accuracy:0.974 Precision:0.919 Recall:0.975 F1:0.946 MCC:0.930.
val Loss: 1.2048
val Accuracy:0.877 Precision:0.787 Recall:0.654 F1:0.714 MCC:0.641.
 
Epoch 5/8
---------------
train Loss: 0.0838
train Accuracy:0.980 Precision:0.937 Recall:0.980 F1:0.958 MCC:0.945.
val Loss: 1.2191
val Accuracy:0.884 Precision:0.750 Recall:0.762 F1:0.756 MCC:0.681.
 
Epoch 6/8
---------------
train Loss: 0.0710
train Accuracy:0.983 Precision:0.944 Recall:0.984 F1:0.964 MCC:0.953.
val Loss: 2.0601
val Accuracy:0.881 Precision:0.910 Recall:0.550 F1:0.685 MCC:0.648.
 
Epoch 7/8
---------------
train Loss: 0.0626
train Accuracy:0.985 Precision:0.953 Recall:0.987 F1:0.969 MCC:0.960.
val Loss: 1.8091
val Accuracy:0.889 Precision:0.881 Recall:0.613 F1:0.723 MCC:0.673.
 
Epoch 8/8
---------------
train Loss: 0.0589
train Accuracy:0.986 Precision:0.955 Recall:0.987 F1:0.971 MCC:0.962.
val Loss: 1.5140
val Accuracy:0.887 Precision:0.818 Recall:0.668 F1:0.735 MCC:0.670.
Training complete in 168m 28s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4254
train Accuracy:0.889 Precision:0.711 Recall:0.886 F1:0.789 MCC:0.723.
val Loss: 1.0089
val Accuracy:0.867 Precision:0.946 Recall:0.459 F1:0.618 MCC:0.602.
 
Epoch 2/8
---------------
train Loss: 0.2568
train Accuracy:0.935 Precision:0.817 Recall:0.933 F1:0.871 MCC:0.831.
val Loss: 0.4650
val Accuracy:0.887 Precision:0.695 Recall:0.924 F1:0.793 MCC:0.732.
 
Epoch 3/8
---------------
train Loss: 0.1626
train Accuracy:0.959 Precision:0.879 Recall:0.959 F1:0.917 MCC:0.892.
val Loss: 0.4789
val Accuracy:0.883 Precision:0.686 Recall:0.925 F1:0.788 MCC:0.725.
 
Epoch 4/8
---------------
train Loss: 0.1191
train Accuracy:0.971 Precision:0.913 Recall:0.971 F1:0.941 MCC:0.923.
val Loss: 0.4089
val Accuracy:0.928 Precision:0.814 Recall:0.899 F1:0.854 MCC:0.808.
 
Epoch 5/8
---------------
train Loss: 0.0921
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.954 MCC:0.941.
val Loss: 0.6564
val Accuracy:0.918 Precision:0.802 Recall:0.864 F1:0.832 MCC:0.778.
 
Epoch 6/8
---------------
train Loss: 0.0786
train Accuracy:0.981 Precision:0.942 Recall:0.981 F1:0.961 MCC:0.949.
val Loss: 0.5242
val Accuracy:0.942 Precision:0.878 Recall:0.876 F1:0.877 MCC:0.839.
 
Epoch 7/8
---------------
train Loss: 0.0711
train Accuracy:0.983 Precision:0.946 Recall:0.984 F1:0.965 MCC:0.954.
val Loss: 0.4866
val Accuracy:0.925 Precision:0.800 Recall:0.907 F1:0.851 MCC:0.804.
 
Epoch 8/8
---------------
train Loss: 0.0591
train Accuracy:0.986 Precision:0.955 Recall:0.987 F1:0.970 MCC:0.961.
val Loss: 0.8191
val Accuracy:0.922 Precision:0.875 Recall:0.780 F1:0.825 MCC:0.777.
Training complete in 168m 31s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4290
train Accuracy:0.887 Precision:0.708 Recall:0.885 F1:0.787 MCC:0.720.
val Loss: 0.4186
val Accuracy:0.916 Precision:0.801 Recall:0.851 F1:0.825 MCC:0.771.
 
Epoch 2/8
---------------
train Loss: 0.2586
train Accuracy:0.934 Precision:0.814 Recall:0.931 F1:0.869 MCC:0.828.
val Loss: 0.4016
val Accuracy:0.924 Precision:0.784 Recall:0.933 F1:0.852 MCC:0.807.
 
Epoch 3/8
---------------
train Loss: 0.1733
train Accuracy:0.957 Precision:0.873 Recall:0.956 F1:0.913 MCC:0.886.
val Loss: 0.5059
val Accuracy:0.914 Precision:0.804 Recall:0.838 F1:0.821 MCC:0.765.
 
Epoch 4/8
---------------
train Loss: 0.1259
train Accuracy:0.969 Precision:0.904 Recall:0.970 F1:0.936 MCC:0.916.
val Loss: 0.3597
val Accuracy:0.940 Precision:0.836 Recall:0.925 F1:0.878 MCC:0.841.
 
Epoch 5/8
---------------
train Loss: 0.0981
train Accuracy:0.977 Precision:0.927 Recall:0.978 F1:0.951 MCC:0.937.
val Loss: 0.3802
val Accuracy:0.933 Precision:0.823 Recall:0.909 F1:0.864 MCC:0.822.
 
Epoch 6/8
---------------
train Loss: 0.0783
train Accuracy:0.981 Precision:0.940 Recall:0.981 F1:0.960 MCC:0.948.
val Loss: 0.4348
val Accuracy:0.944 Precision:0.860 Recall:0.909 F1:0.884 MCC:0.847.
 
Epoch 7/8
---------------
train Loss: 0.0734
train Accuracy:0.982 Precision:0.943 Recall:0.983 F1:0.963 MCC:0.951.
val Loss: 0.5007
val Accuracy:0.955 Precision:0.912 Recall:0.893 F1:0.902 MCC:0.873.
 
Epoch 8/8
---------------
train Loss: 0.0657
train Accuracy:0.985 Precision:0.953 Recall:0.985 F1:0.968 MCC:0.959.
val Loss: 0.5040
val Accuracy:0.934 Precision:0.827 Recall:0.909 F1:0.866 MCC:0.824.
Training complete in 168m 28s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4372
train Accuracy:0.885 Precision:0.704 Recall:0.881 F1:0.783 MCC:0.714.
val Loss: 0.4168
val Accuracy:0.933 Precision:0.880 Recall:0.827 F1:0.853 MCC:0.810.
 
Epoch 2/8
---------------
train Loss: 0.2635
train Accuracy:0.933 Precision:0.811 Recall:0.932 F1:0.867 MCC:0.826.
val Loss: 0.3897
val Accuracy:0.939 Precision:0.868 Recall:0.873 F1:0.871 MCC:0.831.
 
Epoch 3/8
---------------
train Loss: 0.1777
train Accuracy:0.956 Precision:0.869 Recall:0.956 F1:0.910 MCC:0.883.
val Loss: 0.6207
val Accuracy:0.845 Precision:0.604 Recall:0.984 F1:0.748 MCC:0.686.
 
Epoch 4/8
---------------
train Loss: 0.1262
train Accuracy:0.969 Precision:0.904 Recall:0.969 F1:0.935 MCC:0.916.
val Loss: 0.3086
val Accuracy:0.925 Precision:0.787 Recall:0.933 F1:0.854 MCC:0.810.
 
Epoch 5/8
---------------
train Loss: 0.1026
train Accuracy:0.975 Precision:0.923 Recall:0.975 F1:0.948 MCC:0.932.
val Loss: 0.4348
val Accuracy:0.926 Precision:0.811 Recall:0.894 F1:0.850 MCC:0.803.
 
Epoch 6/8
---------------
train Loss: 0.0840
train Accuracy:0.980 Precision:0.936 Recall:0.981 F1:0.958 MCC:0.945.
val Loss: 0.3785
val Accuracy:0.927 Precision:0.789 Recall:0.939 F1:0.857 MCC:0.814.
 
Epoch 7/8
---------------
train Loss: 0.0766
train Accuracy:0.982 Precision:0.943 Recall:0.982 F1:0.962 MCC:0.951.
val Loss: 0.5746
val Accuracy:0.937 Precision:0.912 Recall:0.810 F1:0.858 MCC:0.820.
 
Epoch 8/8
---------------
train Loss: 0.0651
train Accuracy:0.984 Precision:0.950 Recall:0.985 F1:0.967 MCC:0.957.
val Loss: 0.3732
val Accuracy:0.939 Precision:0.834 Recall:0.924 F1:0.877 MCC:0.838.
Training complete in 168m 33s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4080
train Accuracy:0.895 Precision:0.725 Recall:0.893 F1:0.800 MCC:0.738.
val Loss: 0.5610
val Accuracy:0.856 Precision:0.642 Recall:0.876 F1:0.741 MCC:0.660.
 
Epoch 2/8
---------------
train Loss: 0.2486
train Accuracy:0.936 Precision:0.818 Recall:0.936 F1:0.873 MCC:0.834.
val Loss: 0.4847
val Accuracy:0.893 Precision:0.737 Recall:0.848 F1:0.789 MCC:0.721.
 
Epoch 3/8
---------------
train Loss: 0.1580
train Accuracy:0.961 Precision:0.882 Recall:0.962 F1:0.920 MCC:0.896.
val Loss: 0.5498
val Accuracy:0.906 Precision:0.790 Recall:0.816 F1:0.803 MCC:0.741.
 
Epoch 4/8
---------------
train Loss: 0.1100
train Accuracy:0.973 Precision:0.917 Recall:0.974 F1:0.945 MCC:0.928.
val Loss: 0.7399
val Accuracy:0.909 Precision:0.806 Recall:0.806 F1:0.806 MCC:0.747.
 
Epoch 5/8
---------------
train Loss: 0.0906
train Accuracy:0.978 Precision:0.930 Recall:0.978 F1:0.953 MCC:0.939.
val Loss: 0.6781
val Accuracy:0.894 Precision:0.745 Recall:0.833 F1:0.787 MCC:0.718.
 
Epoch 6/8
---------------
train Loss: 0.0748
train Accuracy:0.983 Precision:0.944 Recall:0.983 F1:0.964 MCC:0.952.
val Loss: 0.5490
val Accuracy:0.883 Precision:0.694 Recall:0.898 F1:0.783 MCC:0.716.
 
Epoch 7/8
---------------
train Loss: 0.0655
train Accuracy:0.984 Precision:0.951 Recall:0.985 F1:0.967 MCC:0.958.
val Loss: 0.7277
val Accuracy:0.906 Precision:0.798 Recall:0.804 F1:0.801 MCC:0.740.
 
Epoch 8/8
---------------
train Loss: 0.0584
train Accuracy:0.986 Precision:0.956 Recall:0.987 F1:0.971 MCC:0.962.
val Loss: 0.8122
val Accuracy:0.892 Precision:0.736 Recall:0.838 F1:0.784 MCC:0.714.
Training complete in 168m 24s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7596857673397251, 'acc': 0.8464869281045752, 'precision': 0.6361163992385096, 'recall': 0.8121527777777777, 'mcc': 0.6192028524417728}, {'loss': 0.4088655047312995, 'acc': 0.9280265748031497, 'precision': 0.8135996195910604, 'recall': 0.8986344537815126, 'mcc': 0.8081570988781139}, {'loss': 0.3596769520106024, 'acc': 0.9400426509186351, 'precision': 0.8364471184293857, 'recall': 0.9248949579831933, 'mcc': 0.8406567491669171}, {'loss': 0.3085939782290301, 'acc': 0.9252378608923885, 'precision': 0.7870110701107011, 'recall': 0.9334733893557423, 'mcc': 0.8095406036254857}, {'loss': 0.4846623925995717, 'acc': 0.8934547244094488, 'precision': 0.7369141813755326, 'recall': 0.8478641456582633, 'mcc': 0.72091506962493}]
Averge metrics over 5 folds:
average loss:  0.4642969189820458
average accuracy:  0.9066497478256395
average precision:  0.7620176777490377
average recall:  0.8834039449112978
average mcc:  0.7596944747474439
cross-validation finished, end of program
