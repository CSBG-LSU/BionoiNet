data directory: ../../bionoi_output/center_dist/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/nucleotide/fold_2', '../../bionoi_output/center_dist/nucleotide/fold_3', '../../bionoi_output/center_dist/nucleotide/fold_4', '../../bionoi_output/center_dist/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5357
train Accuracy:0.761 Precision:0.716 Recall:0.764 F1:0.739 MCC:0.520.
val Loss: 0.6439
val Accuracy:0.740 Precision:0.710 Recall:0.701 F1:0.705 MCC:0.473.
 
Epoch 2/8
---------------
train Loss: 0.3703
train Accuracy:0.853 Precision:0.823 Recall:0.851 F1:0.837 MCC:0.703.
val Loss: 0.8632
val Accuracy:0.714 Precision:0.721 Recall:0.581 F1:0.644 MCC:0.417.
 
Epoch 3/8
---------------
train Loss: 0.2478
train Accuracy:0.908 Precision:0.888 Recall:0.907 F1:0.897 MCC:0.814.
val Loss: 0.8626
val Accuracy:0.727 Precision:0.736 Recall:0.602 F1:0.662 MCC:0.444.
 
Epoch 4/8
---------------
train Loss: 0.1706
train Accuracy:0.939 Precision:0.925 Recall:0.939 F1:0.932 MCC:0.877.
val Loss: 0.9501
val Accuracy:0.757 Precision:0.804 Recall:0.597 F1:0.685 MCC:0.508.
 
Epoch 5/8
---------------
train Loss: 0.1284
train Accuracy:0.955 Precision:0.944 Recall:0.955 F1:0.950 MCC:0.909.
val Loss: 0.8300
val Accuracy:0.766 Precision:0.750 Recall:0.708 F1:0.729 MCC:0.524.
 
Epoch 6/8
---------------
train Loss: 0.1048
train Accuracy:0.964 Precision:0.954 Recall:0.964 F1:0.959 MCC:0.926.
val Loss: 0.9691
val Accuracy:0.766 Precision:0.772 Recall:0.671 F1:0.718 MCC:0.524.
 
Epoch 7/8
---------------
train Loss: 0.0903
train Accuracy:0.969 Precision:0.961 Recall:0.970 F1:0.965 MCC:0.938.
val Loss: 1.0599
val Accuracy:0.775 Precision:0.794 Recall:0.665 F1:0.724 MCC:0.543.
 
Epoch 8/8
---------------
train Loss: 0.0818
train Accuracy:0.972 Precision:0.965 Recall:0.972 F1:0.968 MCC:0.943.
val Loss: 1.1952
val Accuracy:0.762 Precision:0.808 Recall:0.609 F1:0.695 MCC:0.520.
Training complete in 231m 15s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/nucleotide/fold_1', '../../bionoi_output/center_dist/nucleotide/fold_3', '../../bionoi_output/center_dist/nucleotide/fold_4', '../../bionoi_output/center_dist/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5648
train Accuracy:0.743 Precision:0.692 Recall:0.756 F1:0.723 MCC:0.485.
val Loss: 0.5232
val Accuracy:0.769 Precision:0.696 Recall:0.851 F1:0.766 MCC:0.553.
 
Epoch 2/8
---------------
train Loss: 0.3966
train Accuracy:0.841 Precision:0.806 Recall:0.844 F1:0.824 MCC:0.679.
val Loss: 0.5175
val Accuracy:0.800 Precision:0.776 Recall:0.772 F1:0.774 MCC:0.594.
 
Epoch 3/8
---------------
train Loss: 0.2664
train Accuracy:0.900 Precision:0.877 Recall:0.901 F1:0.889 MCC:0.798.
val Loss: 0.6487
val Accuracy:0.786 Precision:0.715 Recall:0.864 F1:0.782 MCC:0.586.
 
Epoch 4/8
---------------
train Loss: 0.1823
train Accuracy:0.935 Precision:0.918 Recall:0.936 F1:0.927 MCC:0.868.
val Loss: 0.8655
val Accuracy:0.759 Precision:0.681 Recall:0.860 F1:0.760 MCC:0.538.
 
Epoch 5/8
---------------
train Loss: 0.1353
train Accuracy:0.952 Precision:0.941 Recall:0.952 F1:0.946 MCC:0.903.
val Loss: 0.8180
val Accuracy:0.773 Precision:0.684 Recall:0.911 F1:0.781 MCC:0.581.
 
Epoch 6/8
---------------
train Loss: 0.1108
train Accuracy:0.961 Precision:0.952 Recall:0.962 F1:0.957 MCC:0.922.
val Loss: 0.7294
val Accuracy:0.825 Precision:0.847 Recall:0.740 F1:0.790 MCC:0.645.
 
Epoch 7/8
---------------
train Loss: 0.0956
train Accuracy:0.968 Precision:0.959 Recall:0.968 F1:0.964 MCC:0.934.
val Loss: 0.6580
val Accuracy:0.828 Precision:0.790 Recall:0.836 F1:0.812 MCC:0.656.
 
Epoch 8/8
---------------
train Loss: 0.0859
train Accuracy:0.971 Precision:0.963 Recall:0.972 F1:0.968 MCC:0.942.
val Loss: 0.7295
val Accuracy:0.819 Precision:0.776 Recall:0.833 F1:0.803 MCC:0.638.
Training complete in 231m 19s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/nucleotide/fold_1', '../../bionoi_output/center_dist/nucleotide/fold_2', '../../bionoi_output/center_dist/nucleotide/fold_4', '../../bionoi_output/center_dist/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5552
train Accuracy:0.750 Precision:0.701 Recall:0.761 F1:0.730 MCC:0.499.
val Loss: 0.5107
val Accuracy:0.772 Precision:0.711 Recall:0.820 F1:0.762 MCC:0.550.
 
Epoch 2/8
---------------
train Loss: 0.3829
train Accuracy:0.849 Precision:0.818 Recall:0.848 F1:0.833 MCC:0.695.
val Loss: 0.5479
val Accuracy:0.778 Precision:0.747 Recall:0.756 F1:0.752 MCC:0.551.
 
Epoch 3/8
---------------
train Loss: 0.2540
train Accuracy:0.905 Precision:0.885 Recall:0.905 F1:0.895 MCC:0.809.
val Loss: 0.7233
val Accuracy:0.755 Precision:0.720 Recall:0.735 F1:0.727 MCC:0.505.
 
Epoch 4/8
---------------
train Loss: 0.1740
train Accuracy:0.939 Precision:0.924 Recall:0.939 F1:0.931 MCC:0.876.
val Loss: 0.6568
val Accuracy:0.800 Precision:0.792 Recall:0.747 F1:0.769 MCC:0.594.
 
Epoch 5/8
---------------
train Loss: 0.1293
train Accuracy:0.955 Precision:0.944 Recall:0.955 F1:0.949 MCC:0.909.
val Loss: 0.7196
val Accuracy:0.800 Precision:0.769 Recall:0.785 F1:0.777 MCC:0.595.
 
Epoch 6/8
---------------
train Loss: 0.1071
train Accuracy:0.963 Precision:0.954 Recall:0.963 F1:0.959 MCC:0.925.
val Loss: 1.0717
val Accuracy:0.782 Precision:0.885 Recall:0.585 F1:0.705 MCC:0.572.
 
Epoch 7/8
---------------
train Loss: 0.0934
train Accuracy:0.968 Precision:0.960 Recall:0.968 F1:0.964 MCC:0.935.
val Loss: 0.7807
val Accuracy:0.788 Precision:0.723 Recall:0.848 F1:0.780 MCC:0.585.
 
Epoch 8/8
---------------
train Loss: 0.0833
train Accuracy:0.972 Precision:0.965 Recall:0.972 F1:0.968 MCC:0.943.
val Loss: 0.8218
val Accuracy:0.802 Precision:0.789 Recall:0.758 F1:0.773 MCC:0.599.
Training complete in 231m 13s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/nucleotide/fold_1', '../../bionoi_output/center_dist/nucleotide/fold_2', '../../bionoi_output/center_dist/nucleotide/fold_3', '../../bionoi_output/center_dist/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5404
train Accuracy:0.757 Precision:0.712 Recall:0.763 F1:0.736 MCC:0.513.
val Loss: 0.6192
val Accuracy:0.741 Precision:0.740 Recall:0.640 F1:0.686 MCC:0.471.
 
Epoch 2/8
---------------
train Loss: 0.3595
train Accuracy:0.858 Precision:0.829 Recall:0.857 F1:0.843 MCC:0.714.
val Loss: 0.6354
val Accuracy:0.743 Precision:0.671 Recall:0.822 F1:0.739 MCC:0.500.
 
Epoch 3/8
---------------
train Loss: 0.2412
train Accuracy:0.911 Precision:0.891 Recall:0.910 F1:0.900 MCC:0.820.
val Loss: 0.6584
val Accuracy:0.763 Precision:0.721 Recall:0.759 F1:0.740 MCC:0.523.
 
Epoch 4/8
---------------
train Loss: 0.1622
train Accuracy:0.942 Precision:0.928 Recall:0.943 F1:0.935 MCC:0.883.
val Loss: 0.8555
val Accuracy:0.770 Precision:0.778 Recall:0.672 F1:0.721 MCC:0.531.
 
Epoch 5/8
---------------
train Loss: 0.1245
train Accuracy:0.957 Precision:0.946 Recall:0.957 F1:0.951 MCC:0.912.
val Loss: 0.8494
val Accuracy:0.768 Precision:0.765 Recall:0.688 F1:0.724 MCC:0.527.
 
Epoch 6/8
---------------
train Loss: 0.1026
train Accuracy:0.964 Precision:0.956 Recall:0.964 F1:0.960 MCC:0.928.
val Loss: 0.9378
val Accuracy:0.768 Precision:0.810 Recall:0.625 F1:0.705 MCC:0.532.
 
Epoch 7/8
---------------
train Loss: 0.0888
train Accuracy:0.970 Precision:0.963 Recall:0.970 F1:0.966 MCC:0.939.
val Loss: 0.9737
val Accuracy:0.762 Precision:0.744 Recall:0.705 F1:0.724 MCC:0.515.
 
Epoch 8/8
---------------
train Loss: 0.0799
train Accuracy:0.973 Precision:0.967 Recall:0.974 F1:0.970 MCC:0.946.
val Loss: 0.9952
val Accuracy:0.759 Precision:0.765 Recall:0.659 F1:0.708 MCC:0.509.
Training complete in 231m 17s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_1', '../../bionoi_output/center_dist/control/fold_2', '../../bionoi_output/center_dist/control/fold_3', '../../bionoi_output/center_dist/control/fold_4', '../../bionoi_output/center_dist/nucleotide/fold_1', '../../bionoi_output/center_dist/nucleotide/fold_2', '../../bionoi_output/center_dist/nucleotide/fold_3', '../../bionoi_output/center_dist/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/center_dist/control/fold_5', '../../bionoi_output/center_dist/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5552
train Accuracy:0.749 Precision:0.698 Recall:0.763 F1:0.729 MCC:0.497.
val Loss: 0.5931
val Accuracy:0.754 Precision:0.792 Recall:0.604 F1:0.685 MCC:0.501.
 
Epoch 2/8
---------------
train Loss: 0.3814
train Accuracy:0.847 Precision:0.815 Recall:0.848 F1:0.831 MCC:0.692.
val Loss: 0.6319
val Accuracy:0.760 Precision:0.690 Recall:0.834 F1:0.755 MCC:0.533.
 
Epoch 3/8
---------------
train Loss: 0.2549
train Accuracy:0.905 Precision:0.883 Recall:0.905 F1:0.894 MCC:0.808.
val Loss: 0.6852
val Accuracy:0.763 Precision:0.707 Recall:0.795 F1:0.749 MCC:0.529.
 
Epoch 4/8
---------------
train Loss: 0.1719
train Accuracy:0.938 Precision:0.924 Recall:0.938 F1:0.931 MCC:0.875.
val Loss: 0.7483
val Accuracy:0.786 Precision:0.800 Recall:0.690 F1:0.741 MCC:0.565.
 
Epoch 5/8
---------------
train Loss: 0.1289
train Accuracy:0.955 Precision:0.943 Recall:0.956 F1:0.950 MCC:0.909.
val Loss: 0.9286
val Accuracy:0.760 Precision:0.798 Recall:0.614 F1:0.694 MCC:0.514.
 
Epoch 6/8
---------------
train Loss: 0.1035
train Accuracy:0.964 Precision:0.955 Recall:0.965 F1:0.960 MCC:0.928.
val Loss: 0.8619
val Accuracy:0.782 Precision:0.815 Recall:0.658 F1:0.728 MCC:0.558.
 
Epoch 7/8
---------------
train Loss: 0.0906
train Accuracy:0.969 Precision:0.962 Recall:0.970 F1:0.966 MCC:0.938.
val Loss: 0.8973
val Accuracy:0.777 Precision:0.777 Recall:0.697 F1:0.735 MCC:0.546.
 
Epoch 8/8
---------------
train Loss: 0.0826
train Accuracy:0.972 Precision:0.965 Recall:0.973 F1:0.969 MCC:0.944.
val Loss: 0.9137
val Accuracy:0.782 Precision:0.812 Recall:0.661 F1:0.728 MCC:0.557.
Training complete in 231m 8s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.643871128828368, 'acc': 0.7403114598193058, 'precision': 0.7099443766110433, 'recall': 0.7010986066452305, 'mcc': 0.47330680788123447}, {'loss': 0.5174950473081498, 'acc': 0.7995238095238095, 'precision': 0.775528050585228, 'recall': 0.7723070739549839, 'mcc': 0.5938416992319859}, {'loss': 0.5106526684193384, 'acc': 0.7720238095238096, 'precision': 0.7110827137546468, 'recall': 0.820069667738478, 'mcc': 0.5504021772196476}, {'loss': 0.6192225447056915, 'acc': 0.7405519790176442, 'precision': 0.7397685796381145, 'recall': 0.6401881720430107, 'mcc': 0.4706578898107806}, {'loss': 0.5931426030599224, 'acc': 0.7539639961850262, 'precision': 0.791618980544062, 'recall': 0.6043010752688172, 'mcc': 0.5013290548596638}]
Averge metrics over 5 folds:
average loss:  0.576876798464294
average accuracy:  0.7612750108139191
average precision:  0.7455885402266189
average recall:  0.7075929191301041
average mcc:  0.5179075258006625
cross-validation finished, end of program
