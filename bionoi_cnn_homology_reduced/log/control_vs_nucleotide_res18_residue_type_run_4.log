data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3745
train Accuracy:0.854 Precision:0.827 Recall:0.850 F1:0.838 MCC:0.706.
val Loss: 0.4724
val Accuracy:0.829 Precision:0.850 Recall:0.745 F1:0.794 MCC:0.652.
 
Epoch 2/8
---------------
train Loss: 0.2510
train Accuracy:0.908 Precision:0.891 Recall:0.904 F1:0.897 MCC:0.814.
val Loss: 0.4674
val Accuracy:0.839 Precision:0.837 Recall:0.791 F1:0.813 MCC:0.673.
 
Epoch 3/8
---------------
train Loss: 0.1646
train Accuracy:0.942 Precision:0.930 Recall:0.939 F1:0.935 MCC:0.882.
val Loss: 0.4484
val Accuracy:0.852 Precision:0.811 Recall:0.869 F1:0.839 MCC:0.703.
 
Epoch 4/8
---------------
train Loss: 0.1100
train Accuracy:0.962 Precision:0.954 Recall:0.961 F1:0.957 MCC:0.923.
val Loss: 0.7064
val Accuracy:0.832 Precision:0.837 Recall:0.773 F1:0.804 MCC:0.659.
 
Epoch 5/8
---------------
train Loss: 0.0855
train Accuracy:0.971 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.5440
val Accuracy:0.852 Precision:0.855 Recall:0.804 F1:0.829 MCC:0.700.
 
Epoch 6/8
---------------
train Loss: 0.0697
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.6187
val Accuracy:0.848 Precision:0.847 Recall:0.801 F1:0.823 MCC:0.690.
 
Epoch 7/8
---------------
train Loss: 0.0595
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.7243
val Accuracy:0.843 Precision:0.836 Recall:0.804 F1:0.820 MCC:0.682.
 
Epoch 8/8
---------------
train Loss: 0.0542
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.963.
val Loss: 0.7927
val Accuracy:0.833 Precision:0.877 Recall:0.725 F1:0.794 MCC:0.664.
Training complete in 230m 42s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3797
train Accuracy:0.850 Precision:0.820 Recall:0.848 F1:0.834 MCC:0.697.
val Loss: 0.3639
val Accuracy:0.855 Precision:0.809 Recall:0.880 F1:0.843 MCC:0.710.
 
Epoch 2/8
---------------
train Loss: 0.2433
train Accuracy:0.910 Precision:0.890 Recall:0.910 F1:0.900 MCC:0.818.
val Loss: 0.3702
val Accuracy:0.879 Precision:0.874 Recall:0.849 F1:0.862 MCC:0.754.
 
Epoch 3/8
---------------
train Loss: 0.1555
train Accuracy:0.945 Precision:0.932 Recall:0.944 F1:0.938 MCC:0.888.
val Loss: 0.4711
val Accuracy:0.864 Precision:0.826 Recall:0.877 F1:0.851 MCC:0.727.
 
Epoch 4/8
---------------
train Loss: 0.1086
train Accuracy:0.962 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.924.
val Loss: 0.4764
val Accuracy:0.863 Precision:0.814 Recall:0.895 F1:0.853 MCC:0.727.
 
Epoch 5/8
---------------
train Loss: 0.0806
train Accuracy:0.972 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.943.
val Loss: 0.4909
val Accuracy:0.877 Precision:0.854 Recall:0.871 F1:0.862 MCC:0.751.
 
Epoch 6/8
---------------
train Loss: 0.0689
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.5155
val Accuracy:0.880 Precision:0.860 Recall:0.871 F1:0.866 MCC:0.757.
 
Epoch 7/8
---------------
train Loss: 0.0598
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.978 MCC:0.961.
val Loss: 0.5100
val Accuracy:0.875 Precision:0.848 Recall:0.875 F1:0.861 MCC:0.747.
 
Epoch 8/8
---------------
train Loss: 0.0533
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.980 MCC:0.965.
val Loss: 0.5739
val Accuracy:0.882 Precision:0.901 Recall:0.825 F1:0.861 MCC:0.761.
Training complete in 230m 20s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3858
train Accuracy:0.848 Precision:0.818 Recall:0.845 F1:0.831 MCC:0.693.
val Loss: 0.3326
val Accuracy:0.870 Precision:0.870 Recall:0.833 F1:0.851 MCC:0.737.
 
Epoch 2/8
---------------
train Loss: 0.2537
train Accuracy:0.906 Precision:0.888 Recall:0.903 F1:0.895 MCC:0.810.
val Loss: 0.4176
val Accuracy:0.841 Precision:0.770 Recall:0.916 F1:0.837 MCC:0.694.
 
Epoch 3/8
---------------
train Loss: 0.1654
train Accuracy:0.941 Precision:0.928 Recall:0.940 F1:0.934 MCC:0.880.
val Loss: 0.3662
val Accuracy:0.877 Precision:0.815 Recall:0.935 F1:0.871 MCC:0.761.
 
Epoch 4/8
---------------
train Loss: 0.1123
train Accuracy:0.961 Precision:0.952 Recall:0.960 F1:0.956 MCC:0.921.
val Loss: 0.5597
val Accuracy:0.847 Precision:0.784 Recall:0.905 F1:0.840 MCC:0.702.
 
Epoch 5/8
---------------
train Loss: 0.0866
train Accuracy:0.971 Precision:0.964 Recall:0.971 F1:0.967 MCC:0.941.
val Loss: 0.4508
val Accuracy:0.876 Precision:0.867 Recall:0.850 F1:0.859 MCC:0.748.
 
Epoch 6/8
---------------
train Loss: 0.0709
train Accuracy:0.976 Precision:0.970 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.6799
val Accuracy:0.853 Precision:0.941 Recall:0.715 F1:0.812 MCC:0.714.
 
Epoch 7/8
---------------
train Loss: 0.0626
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.977 MCC:0.958.
val Loss: 0.4543
val Accuracy:0.878 Precision:0.882 Recall:0.839 F1:0.860 MCC:0.753.
 
Epoch 8/8
---------------
train Loss: 0.0563
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.4926
val Accuracy:0.866 Precision:0.836 Recall:0.869 F1:0.852 MCC:0.731.
Training complete in 230m 50s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3653
train Accuracy:0.856 Precision:0.828 Recall:0.854 F1:0.841 MCC:0.710.
val Loss: 0.4068
val Accuracy:0.832 Precision:0.768 Recall:0.891 F1:0.825 MCC:0.673.
 
Epoch 2/8
---------------
train Loss: 0.2270
train Accuracy:0.917 Precision:0.901 Recall:0.914 F1:0.907 MCC:0.833.
val Loss: 0.5051
val Accuracy:0.844 Precision:0.896 Recall:0.734 F1:0.807 MCC:0.688.
 
Epoch 3/8
---------------
train Loss: 0.1462
train Accuracy:0.949 Precision:0.938 Recall:0.948 F1:0.943 MCC:0.897.
val Loss: 0.5366
val Accuracy:0.841 Precision:0.869 Recall:0.755 F1:0.808 MCC:0.678.
 
Epoch 4/8
---------------
train Loss: 0.1015
train Accuracy:0.965 Precision:0.957 Recall:0.964 F1:0.961 MCC:0.929.
val Loss: 0.6069
val Accuracy:0.859 Precision:0.861 Recall:0.813 F1:0.836 MCC:0.713.
 
Epoch 5/8
---------------
train Loss: 0.0779
train Accuracy:0.974 Precision:0.968 Recall:0.974 F1:0.971 MCC:0.948.
val Loss: 0.7177
val Accuracy:0.821 Precision:0.784 Recall:0.824 F1:0.803 MCC:0.640.
 
Epoch 6/8
---------------
train Loss: 0.0663
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.7361
val Accuracy:0.843 Precision:0.871 Recall:0.759 F1:0.811 MCC:0.683.
 
Epoch 7/8
---------------
train Loss: 0.0594
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.6470
val Accuracy:0.849 Precision:0.845 Recall:0.809 F1:0.826 MCC:0.694.
 
Epoch 8/8
---------------
train Loss: 0.0535
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.980 MCC:0.965.
val Loss: 0.6837
val Accuracy:0.855 Precision:0.853 Recall:0.813 F1:0.832 MCC:0.705.
Training complete in 231m 31s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3602
train Accuracy:0.858 Precision:0.831 Recall:0.855 F1:0.843 MCC:0.714.
val Loss: 0.4256
val Accuracy:0.842 Precision:0.819 Recall:0.828 F1:0.823 MCC:0.681.
 
Epoch 2/8
---------------
train Loss: 0.2281
train Accuracy:0.916 Precision:0.899 Recall:0.914 F1:0.906 MCC:0.831.
val Loss: 0.4830
val Accuracy:0.838 Precision:0.790 Recall:0.864 F1:0.825 MCC:0.677.
 
Epoch 3/8
---------------
train Loss: 0.1478
train Accuracy:0.948 Precision:0.936 Recall:0.947 F1:0.942 MCC:0.894.
val Loss: 0.5182
val Accuracy:0.842 Precision:0.799 Recall:0.859 F1:0.828 MCC:0.683.
 
Epoch 4/8
---------------
train Loss: 0.1030
train Accuracy:0.965 Precision:0.957 Recall:0.964 F1:0.960 MCC:0.929.
val Loss: 0.7704
val Accuracy:0.825 Precision:0.879 Recall:0.701 F1:0.780 MCC:0.649.
 
Epoch 5/8
---------------
train Loss: 0.0782
train Accuracy:0.974 Precision:0.968 Recall:0.974 F1:0.971 MCC:0.947.
val Loss: 0.6801
val Accuracy:0.837 Precision:0.828 Recall:0.797 F1:0.813 MCC:0.669.
 
Epoch 6/8
---------------
train Loss: 0.0656
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.7433
val Accuracy:0.846 Precision:0.869 Recall:0.769 F1:0.816 MCC:0.688.
 
Epoch 7/8
---------------
train Loss: 0.0561
train Accuracy:0.982 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.963.
val Loss: 0.8473
val Accuracy:0.834 Precision:0.846 Recall:0.765 F1:0.804 MCC:0.663.
 
Epoch 8/8
---------------
train Loss: 0.0510
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.8193
val Accuracy:0.837 Precision:0.829 Recall:0.797 F1:0.813 MCC:0.670.
Training complete in 232m 0s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4484087751130518, 'acc': 0.8517593913456967, 'precision': 0.8107026756689172, 'recall': 0.8687031082529475, 'mcc': 0.7032996056728323}, {'loss': 0.36387391946145464, 'acc': 0.8545535714285715, 'precision': 0.8090869913193376, 'recall': 0.8803590568060021, 'mcc': 0.710223740407931}, {'loss': 0.3325600366152468, 'acc': 0.8702380952380953, 'precision': 0.8696138780078344, 'recall': 0.8327974276527331, 'mcc': 0.7366323734013069}, {'loss': 0.4068121822976361, 'acc': 0.8324093943729137, 'precision': 0.7680546707592517, 'recall': 0.891263440860215, 'mcc': 0.6727231883864638}, {'loss': 0.4256375322298715, 'acc': 0.842274678111588, 'precision': 0.81875, 'recall': 0.8275537634408602, 'mcc': 0.680848113479675}]
Averge metrics over 5 folds:
average loss:  0.39545848914345216
average accuracy:  0.8502470260993729
average precision:  0.8152416431510682
average recall:  0.8601353594025515
average mcc:  0.7007454042696418
cross-validation finished, end of program
