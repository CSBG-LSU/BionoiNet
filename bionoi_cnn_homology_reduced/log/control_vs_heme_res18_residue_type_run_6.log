data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3774
train Accuracy:0.905 Precision:0.744 Recall:0.904 F1:0.816 MCC:0.759.
val Loss: 1.2454
val Accuracy:0.864 Precision:0.895 Recall:0.479 F1:0.624 MCC:0.590.
 
Epoch 2/8
---------------
train Loss: 0.2363
train Accuracy:0.943 Precision:0.835 Recall:0.941 F1:0.885 MCC:0.850.
val Loss: 0.9414
val Accuracy:0.870 Precision:0.734 Recall:0.704 F1:0.718 MCC:0.634.
 
Epoch 3/8
---------------
train Loss: 0.1535
train Accuracy:0.963 Precision:0.888 Recall:0.964 F1:0.924 MCC:0.901.
val Loss: 0.7706
val Accuracy:0.867 Precision:0.694 Recall:0.780 F1:0.734 MCC:0.648.
 
Epoch 4/8
---------------
train Loss: 0.1068
train Accuracy:0.974 Precision:0.919 Recall:0.975 F1:0.946 MCC:0.930.
val Loss: 1.3672
val Accuracy:0.879 Precision:0.792 Recall:0.659 F1:0.719 MCC:0.648.
 
Epoch 5/8
---------------
train Loss: 0.0845
train Accuracy:0.979 Precision:0.935 Recall:0.980 F1:0.957 MCC:0.944.
val Loss: 1.6749
val Accuracy:0.880 Precision:0.865 Recall:0.582 F1:0.696 MCC:0.644.
 
Epoch 6/8
---------------
train Loss: 0.0679
train Accuracy:0.984 Precision:0.948 Recall:0.984 F1:0.966 MCC:0.955.
val Loss: 1.7493
val Accuracy:0.883 Precision:0.908 Recall:0.561 F1:0.693 MCC:0.654.
 
Epoch 7/8
---------------
train Loss: 0.0648
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.968 MCC:0.958.
val Loss: 1.4670
val Accuracy:0.887 Precision:0.815 Recall:0.672 F1:0.736 MCC:0.670.
 
Epoch 8/8
---------------
train Loss: 0.0560
train Accuracy:0.987 Precision:0.957 Recall:0.988 F1:0.972 MCC:0.964.
val Loss: 1.6911
val Accuracy:0.888 Precision:0.875 Recall:0.614 F1:0.721 MCC:0.670.
Training complete in 167m 38s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4258
train Accuracy:0.889 Precision:0.711 Recall:0.884 F1:0.788 MCC:0.722.
val Loss: 0.7598
val Accuracy:0.897 Precision:0.936 Recall:0.604 F1:0.734 MCC:0.699.
 
Epoch 2/8
---------------
train Loss: 0.2548
train Accuracy:0.936 Precision:0.819 Recall:0.933 F1:0.872 MCC:0.833.
val Loss: 0.4106
val Accuracy:0.893 Precision:0.702 Recall:0.941 F1:0.804 MCC:0.747.
 
Epoch 3/8
---------------
train Loss: 0.1618
train Accuracy:0.961 Precision:0.883 Recall:0.960 F1:0.920 MCC:0.895.
val Loss: 0.4422
val Accuracy:0.926 Precision:0.834 Recall:0.852 F1:0.843 MCC:0.794.
 
Epoch 4/8
---------------
train Loss: 0.1156
train Accuracy:0.972 Precision:0.914 Recall:0.971 F1:0.942 MCC:0.924.
val Loss: 0.5622
val Accuracy:0.924 Precision:0.850 Recall:0.821 F1:0.835 MCC:0.786.
 
Epoch 5/8
---------------
train Loss: 0.0955
train Accuracy:0.977 Precision:0.930 Recall:0.977 F1:0.953 MCC:0.938.
val Loss: 0.7619
val Accuracy:0.913 Precision:0.872 Recall:0.739 F1:0.800 MCC:0.749.
 
Epoch 6/8
---------------
train Loss: 0.0769
train Accuracy:0.982 Precision:0.942 Recall:0.982 F1:0.962 MCC:0.950.
val Loss: 0.5152
val Accuracy:0.930 Precision:0.830 Recall:0.885 F1:0.856 MCC:0.811.
 
Epoch 7/8
---------------
train Loss: 0.0691
train Accuracy:0.984 Precision:0.949 Recall:0.984 F1:0.966 MCC:0.956.
val Loss: 0.6101
val Accuracy:0.931 Precision:0.841 Recall:0.870 F1:0.855 MCC:0.810.
 
Epoch 8/8
---------------
train Loss: 0.0615
train Accuracy:0.986 Precision:0.955 Recall:0.985 F1:0.970 MCC:0.961.
val Loss: 0.5683
val Accuracy:0.932 Precision:0.868 Recall:0.839 F1:0.853 MCC:0.809.
Training complete in 167m 52s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4281
train Accuracy:0.886 Precision:0.706 Recall:0.884 F1:0.785 MCC:0.717.
val Loss: 0.3752
val Accuracy:0.909 Precision:0.758 Recall:0.899 F1:0.822 MCC:0.767.
 
Epoch 2/8
---------------
train Loss: 0.2557
train Accuracy:0.936 Precision:0.819 Recall:0.933 F1:0.872 MCC:0.833.
val Loss: 0.3888
val Accuracy:0.920 Precision:0.780 Recall:0.918 F1:0.843 MCC:0.795.
 
Epoch 3/8
---------------
train Loss: 0.1737
train Accuracy:0.958 Precision:0.875 Recall:0.957 F1:0.914 MCC:0.888.
val Loss: 0.4107
val Accuracy:0.954 Precision:0.945 Recall:0.854 F1:0.897 MCC:0.869.
 
Epoch 4/8
---------------
train Loss: 0.1280
train Accuracy:0.969 Precision:0.904 Recall:0.970 F1:0.936 MCC:0.916.
val Loss: 0.3577
val Accuracy:0.942 Precision:0.839 Recall:0.933 F1:0.883 MCC:0.847.
 
Epoch 5/8
---------------
train Loss: 0.0927
train Accuracy:0.978 Precision:0.930 Recall:0.978 F1:0.953 MCC:0.939.
val Loss: 0.4927
val Accuracy:0.905 Precision:0.731 Recall:0.939 F1:0.822 MCC:0.769.
 
Epoch 6/8
---------------
train Loss: 0.0805
train Accuracy:0.981 Precision:0.942 Recall:0.981 F1:0.961 MCC:0.949.
val Loss: 0.4267
val Accuracy:0.928 Precision:0.804 Recall:0.916 F1:0.856 MCC:0.812.
 
Epoch 7/8
---------------
train Loss: 0.0741
train Accuracy:0.982 Precision:0.944 Recall:0.982 F1:0.963 MCC:0.952.
val Loss: 0.4642
val Accuracy:0.945 Precision:0.857 Recall:0.919 F1:0.887 MCC:0.852.
 
Epoch 8/8
---------------
train Loss: 0.0603
train Accuracy:0.986 Precision:0.955 Recall:0.986 F1:0.970 MCC:0.961.
val Loss: 0.5162
val Accuracy:0.954 Precision:0.919 Recall:0.883 F1:0.900 MCC:0.871.
Training complete in 167m 45s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4286
train Accuracy:0.888 Precision:0.710 Recall:0.883 F1:0.787 MCC:0.720.
val Loss: 0.3200
val Accuracy:0.925 Precision:0.801 Recall:0.905 F1:0.850 MCC:0.803.
 
Epoch 2/8
---------------
train Loss: 0.2592
train Accuracy:0.934 Precision:0.814 Recall:0.933 F1:0.870 MCC:0.829.
val Loss: 0.3573
val Accuracy:0.925 Precision:0.807 Recall:0.894 F1:0.848 MCC:0.800.
 
Epoch 3/8
---------------
train Loss: 0.1724
train Accuracy:0.957 Precision:0.871 Recall:0.958 F1:0.912 MCC:0.886.
val Loss: 0.4276
val Accuracy:0.886 Precision:0.678 Recall:0.976 F1:0.800 MCC:0.747.
 
Epoch 4/8
---------------
train Loss: 0.1271
train Accuracy:0.968 Precision:0.903 Recall:0.969 F1:0.935 MCC:0.915.
val Loss: 0.3855
val Accuracy:0.922 Precision:0.789 Recall:0.913 F1:0.846 MCC:0.798.
 
Epoch 5/8
---------------
train Loss: 0.0995
train Accuracy:0.975 Precision:0.923 Recall:0.976 F1:0.949 MCC:0.933.
val Loss: 0.3844
val Accuracy:0.913 Precision:0.746 Recall:0.954 F1:0.837 MCC:0.790.
 
Epoch 6/8
---------------
train Loss: 0.0812
train Accuracy:0.981 Precision:0.939 Recall:0.981 F1:0.959 MCC:0.947.
val Loss: 0.3533
val Accuracy:0.930 Precision:0.795 Recall:0.947 F1:0.864 MCC:0.824.
 
Epoch 7/8
---------------
train Loss: 0.0741
train Accuracy:0.983 Precision:0.944 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.3748
val Accuracy:0.948 Precision:0.894 Recall:0.884 F1:0.889 MCC:0.855.
 
Epoch 8/8
---------------
train Loss: 0.0665
train Accuracy:0.984 Precision:0.951 Recall:0.985 F1:0.967 MCC:0.957.
val Loss: 0.3949
val Accuracy:0.917 Precision:0.758 Recall:0.947 F1:0.842 MCC:0.796.
Training complete in 167m 45s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4005
train Accuracy:0.897 Precision:0.728 Recall:0.894 F1:0.802 MCC:0.741.
val Loss: 0.5165
val Accuracy:0.892 Precision:0.747 Recall:0.814 F1:0.779 MCC:0.709.
 
Epoch 2/8
---------------
train Loss: 0.2374
train Accuracy:0.940 Precision:0.828 Recall:0.939 F1:0.880 MCC:0.843.
val Loss: 0.7573
val Accuracy:0.911 Precision:0.879 Recall:0.721 F1:0.792 MCC:0.743.
 
Epoch 3/8
---------------
train Loss: 0.1504
train Accuracy:0.962 Precision:0.887 Recall:0.963 F1:0.923 MCC:0.900.
val Loss: 0.5730
val Accuracy:0.868 Precision:0.674 Recall:0.848 F1:0.751 MCC:0.671.
 
Epoch 4/8
---------------
train Loss: 0.1070
train Accuracy:0.974 Precision:0.920 Recall:0.973 F1:0.946 MCC:0.929.
val Loss: 0.6324
val Accuracy:0.905 Precision:0.776 Recall:0.834 F1:0.804 MCC:0.742.
 
Epoch 5/8
---------------
train Loss: 0.0894
train Accuracy:0.979 Precision:0.935 Recall:0.979 F1:0.957 MCC:0.943.
val Loss: 0.6673
val Accuracy:0.886 Precision:0.723 Recall:0.831 F1:0.773 MCC:0.700.
 
Epoch 6/8
---------------
train Loss: 0.0761
train Accuracy:0.982 Precision:0.944 Recall:0.982 F1:0.963 MCC:0.951.
val Loss: 0.6463
val Accuracy:0.909 Precision:0.792 Recall:0.832 F1:0.811 MCC:0.752.
 
Epoch 7/8
---------------
train Loss: 0.0618
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.969 MCC:0.959.
val Loss: 0.7415
val Accuracy:0.917 Precision:0.830 Recall:0.815 F1:0.822 MCC:0.768.
 
Epoch 8/8
---------------
train Loss: 0.0612
train Accuracy:0.986 Precision:0.954 Recall:0.986 F1:0.970 MCC:0.961.
val Loss: 0.9137
val Accuracy:0.896 Precision:0.768 Recall:0.796 F1:0.782 MCC:0.713.
Training complete in 167m 48s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7705790811309627, 'acc': 0.8672385620915033, 'precision': 0.6939721792890263, 'recall': 0.7795138888888888, 'mcc': 0.6481126557064436}, {'loss': 0.41061722116148847, 'acc': 0.8927165354330708, 'precision': 0.7023529411764706, 'recall': 0.9406512605042017, 'mcc': 0.7472842168018922}, {'loss': 0.3576732582096108, 'acc': 0.9422162073490814, 'precision': 0.8387655487324831, 'recall': 0.9325980392156863, 'mcc': 0.8470490458003673}, {'loss': 0.31996613906163557, 'acc': 0.9249917979002624, 'precision': 0.8006814310051107, 'recall': 0.9051120448179272, 'mcc': 0.8026437896226548}, {'loss': 0.5165149075299345, 'acc': 0.8919373359580053, 'precision': 0.74714859437751, 'recall': 0.814250700280112, 'mcc': 0.7090371432953865}]
Averge metrics over 5 folds:
average loss:  0.47507012141872645
average accuracy:  0.9038200877463846
average precision:  0.7565841389161202
average recall:  0.874425186741363
average mcc:  0.7508253702453489
cross-validation finished, end of program
