data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5858
train Accuracy:0.836 Precision:0.606 Recall:0.851 F1:0.708 MCC:0.615.
val Loss: 0.8520
val Accuracy:0.855 Precision:0.743 Recall:0.584 F1:0.654 MCC:0.570.
 
Epoch 2/8
---------------
train Loss: 0.4527
train Accuracy:0.882 Precision:0.697 Recall:0.879 F1:0.778 MCC:0.708.
val Loss: 0.7587
val Accuracy:0.854 Precision:0.681 Recall:0.715 F1:0.698 MCC:0.602.
 
Epoch 3/8
---------------
train Loss: 0.4073
train Accuracy:0.896 Precision:0.728 Recall:0.890 F1:0.800 MCC:0.738.
val Loss: 0.7219
val Accuracy:0.851 Precision:0.665 Recall:0.743 F1:0.702 MCC:0.605.
 
Epoch 4/8
---------------
train Loss: 0.3765
train Accuracy:0.907 Precision:0.754 Recall:0.895 F1:0.819 MCC:0.762.
val Loss: 0.7680
val Accuracy:0.869 Precision:0.768 Recall:0.632 F1:0.694 MCC:0.616.
 
Epoch 5/8
---------------
train Loss: 0.3527
train Accuracy:0.914 Precision:0.770 Recall:0.902 F1:0.831 MCC:0.778.
val Loss: 0.7670
val Accuracy:0.871 Precision:0.754 Recall:0.669 F1:0.709 MCC:0.628.
 
Epoch 6/8
---------------
train Loss: 0.3354
train Accuracy:0.918 Precision:0.779 Recall:0.906 F1:0.838 MCC:0.787.
val Loss: 1.1161
val Accuracy:0.872 Precision:0.868 Recall:0.537 F1:0.663 MCC:0.615.
 
Epoch 7/8
---------------
train Loss: 0.3230
train Accuracy:0.922 Precision:0.790 Recall:0.909 F1:0.845 MCC:0.797.
val Loss: 0.8510
val Accuracy:0.877 Precision:0.791 Recall:0.650 F1:0.714 MCC:0.642.
 
Epoch 8/8
---------------
train Loss: 0.3081
train Accuracy:0.927 Precision:0.802 Recall:0.914 F1:0.854 MCC:0.809.
val Loss: 1.1230
val Accuracy:0.874 Precision:0.923 Recall:0.505 F1:0.653 MCC:0.623.
Training complete in 150m 28s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.6267
train Accuracy:0.823 Precision:0.587 Recall:0.827 F1:0.687 MCC:0.584.
val Loss: 0.8351
val Accuracy:0.851 Precision:0.898 Recall:0.410 F1:0.563 MCC:0.543.
 
Epoch 2/8
---------------
train Loss: 0.5117
train Accuracy:0.865 Precision:0.667 Recall:0.851 F1:0.748 MCC:0.667.
val Loss: 0.5116
val Accuracy:0.814 Precision:0.561 Recall:0.956 F1:0.707 MCC:0.628.
 
Epoch 3/8
---------------
train Loss: 0.4584
train Accuracy:0.882 Precision:0.702 Recall:0.866 F1:0.776 MCC:0.704.
val Loss: 0.4809
val Accuracy:0.862 Precision:0.645 Recall:0.914 F1:0.756 MCC:0.683.
 
Epoch 4/8
---------------
train Loss: 0.4237
train Accuracy:0.893 Precision:0.724 Recall:0.875 F1:0.792 MCC:0.727.
val Loss: 1.0210
val Accuracy:0.856 Precision:0.817 Recall:0.499 F1:0.620 MCC:0.562.
 
Epoch 5/8
---------------
train Loss: 0.3976
train Accuracy:0.899 Precision:0.737 Recall:0.883 F1:0.804 MCC:0.742.
val Loss: 0.4408
val Accuracy:0.916 Precision:0.811 Recall:0.838 F1:0.824 MCC:0.769.
 
Epoch 6/8
---------------
train Loss: 0.3729
train Accuracy:0.905 Precision:0.751 Recall:0.891 F1:0.815 MCC:0.757.
val Loss: 0.4490
val Accuracy:0.893 Precision:0.719 Recall:0.890 F1:0.795 MCC:0.731.
 
Epoch 7/8
---------------
train Loss: 0.3487
train Accuracy:0.911 Precision:0.763 Recall:0.900 F1:0.826 MCC:0.771.
val Loss: 0.4006
val Accuracy:0.912 Precision:0.770 Recall:0.888 F1:0.825 MCC:0.770.
 
Epoch 8/8
---------------
train Loss: 0.3275
train Accuracy:0.917 Precision:0.776 Recall:0.909 F1:0.837 MCC:0.786.
val Loss: 0.3915
val Accuracy:0.903 Precision:0.743 Recall:0.894 F1:0.812 MCC:0.752.
Training complete in 150m 31s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.6485
train Accuracy:0.812 Precision:0.568 Recall:0.827 F1:0.673 MCC:0.567.
val Loss: 0.5227
val Accuracy:0.911 Precision:0.785 Recall:0.857 F1:0.819 MCC:0.762.
 
Epoch 2/8
---------------
train Loss: 0.5269
train Accuracy:0.855 Precision:0.644 Recall:0.855 F1:0.735 MCC:0.650.
val Loss: 0.4095
val Accuracy:0.889 Precision:0.698 Recall:0.932 F1:0.798 MCC:0.738.
 
Epoch 3/8
---------------
train Loss: 0.4614
train Accuracy:0.875 Precision:0.683 Recall:0.869 F1:0.765 MCC:0.690.
val Loss: 0.3897
val Accuracy:0.913 Precision:0.758 Recall:0.924 F1:0.833 MCC:0.782.
 
Epoch 4/8
---------------
train Loss: 0.4278
train Accuracy:0.884 Precision:0.704 Recall:0.877 F1:0.781 MCC:0.711.
val Loss: 0.4029
val Accuracy:0.902 Precision:0.733 Recall:0.916 F1:0.815 MCC:0.758.
 
Epoch 5/8
---------------
train Loss: 0.3965
train Accuracy:0.895 Precision:0.727 Recall:0.883 F1:0.798 MCC:0.734.
val Loss: 0.4021
val Accuracy:0.924 Precision:0.800 Recall:0.903 F1:0.848 MCC:0.801.
 
Epoch 6/8
---------------
train Loss: 0.3722
train Accuracy:0.904 Precision:0.747 Recall:0.893 F1:0.814 MCC:0.755.
val Loss: 0.3878
val Accuracy:0.889 Precision:0.700 Recall:0.922 F1:0.796 MCC:0.735.
 
Epoch 7/8
---------------
train Loss: 0.3470
train Accuracy:0.912 Precision:0.766 Recall:0.899 F1:0.827 MCC:0.773.
val Loss: 0.3921
val Accuracy:0.907 Precision:0.739 Recall:0.932 F1:0.825 MCC:0.772.
 
Epoch 8/8
---------------
train Loss: 0.3273
train Accuracy:0.916 Precision:0.775 Recall:0.905 F1:0.835 MCC:0.784.
val Loss: 0.3859
val Accuracy:0.925 Precision:0.805 Recall:0.894 F1:0.847 MCC:0.799.
Training complete in 150m 40s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.6571
train Accuracy:0.809 Precision:0.565 Recall:0.817 F1:0.668 MCC:0.559.
val Loss: 0.5757
val Accuracy:0.910 Precision:0.879 Recall:0.716 F1:0.789 MCC:0.740.
 
Epoch 2/8
---------------
train Loss: 0.5423
train Accuracy:0.853 Precision:0.642 Recall:0.840 F1:0.728 MCC:0.640.
val Loss: 0.4364
val Accuracy:0.813 Precision:0.557 Recall:0.972 F1:0.709 MCC:0.634.
 
Epoch 3/8
---------------
train Loss: 0.4809
train Accuracy:0.873 Precision:0.685 Recall:0.851 F1:0.759 MCC:0.682.
val Loss: 0.3270
val Accuracy:0.888 Precision:0.687 Recall:0.955 F1:0.799 MCC:0.743.
 
Epoch 4/8
---------------
train Loss: 0.4444
train Accuracy:0.884 Precision:0.705 Recall:0.868 F1:0.778 MCC:0.707.
val Loss: 0.3400
val Accuracy:0.887 Precision:0.687 Recall:0.955 F1:0.799 MCC:0.742.
 
Epoch 5/8
---------------
train Loss: 0.4128
train Accuracy:0.894 Precision:0.726 Recall:0.883 F1:0.797 MCC:0.733.
val Loss: 0.3385
val Accuracy:0.882 Precision:0.675 Recall:0.960 F1:0.793 MCC:0.736.
 
Epoch 6/8
---------------
train Loss: 0.3810
train Accuracy:0.901 Precision:0.739 Recall:0.892 F1:0.808 MCC:0.748.
val Loss: 0.3397
val Accuracy:0.897 Precision:0.710 Recall:0.944 F1:0.810 MCC:0.755.
 
Epoch 7/8
---------------
train Loss: 0.3575
train Accuracy:0.908 Precision:0.755 Recall:0.898 F1:0.820 MCC:0.764.
val Loss: 0.3274
val Accuracy:0.866 Precision:0.640 Recall:0.974 F1:0.773 MCC:0.713.
 
Epoch 8/8
---------------
train Loss: 0.3325
train Accuracy:0.914 Precision:0.766 Recall:0.908 F1:0.831 MCC:0.779.
val Loss: 0.3536
val Accuracy:0.928 Precision:0.836 Recall:0.862 F1:0.849 MCC:0.802.
Training complete in 150m 24s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.6018
train Accuracy:0.833 Precision:0.603 Recall:0.844 F1:0.704 MCC:0.608.
val Loss: 0.5426
val Accuracy:0.847 Precision:0.631 Recall:0.834 F1:0.719 MCC:0.628.
 
Epoch 2/8
---------------
train Loss: 0.4780
train Accuracy:0.878 Precision:0.690 Recall:0.870 F1:0.769 MCC:0.696.
val Loss: 0.4663
val Accuracy:0.866 Precision:0.666 Recall:0.859 F1:0.750 MCC:0.671.
 
Epoch 3/8
---------------
train Loss: 0.4323
train Accuracy:0.891 Precision:0.717 Recall:0.882 F1:0.791 MCC:0.725.
val Loss: 0.4940
val Accuracy:0.872 Precision:0.689 Recall:0.823 F1:0.750 MCC:0.670.
 
Epoch 4/8
---------------
train Loss: 0.4028
train Accuracy:0.898 Precision:0.732 Recall:0.888 F1:0.803 MCC:0.741.
val Loss: 0.5281
val Accuracy:0.889 Precision:0.754 Recall:0.780 F1:0.767 MCC:0.694.
 
Epoch 5/8
---------------
train Loss: 0.3815
train Accuracy:0.904 Precision:0.747 Recall:0.894 F1:0.814 MCC:0.755.
val Loss: 0.4638
val Accuracy:0.861 Precision:0.651 Recall:0.874 F1:0.746 MCC:0.666.
 
Epoch 6/8
---------------
train Loss: 0.3573
train Accuracy:0.910 Precision:0.760 Recall:0.900 F1:0.824 MCC:0.769.
val Loss: 0.4729
val Accuracy:0.878 Precision:0.700 Recall:0.840 F1:0.764 MCC:0.688.
 
Epoch 7/8
---------------
train Loss: 0.3404
train Accuracy:0.913 Precision:0.768 Recall:0.903 F1:0.830 MCC:0.777.
val Loss: 0.4961
val Accuracy:0.860 Precision:0.658 Recall:0.836 F1:0.737 MCC:0.651.
 
Epoch 8/8
---------------
train Loss: 0.3264
train Accuracy:0.918 Precision:0.778 Recall:0.908 F1:0.838 MCC:0.787.
val Loss: 0.4789
val Accuracy:0.854 Precision:0.635 Recall:0.880 F1:0.738 MCC:0.656.
Training complete in 151m 4s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7219141075034546, 'acc': 0.8514705882352941, 'precision': 0.6650093225605966, 'recall': 0.7430555555555556, 'mcc': 0.6050197878364318}, {'loss': 0.39153469170583044, 'acc': 0.9027230971128609, 'precision': 0.7430151338766007, 'recall': 0.8939075630252101, 'mcc': 0.7524970344977996}, {'loss': 0.3859342681464013, 'acc': 0.9245816929133859, 'precision': 0.8053934710613468, 'recall': 0.8940826330532213, 'mcc': 0.7994359103533526}, {'loss': 0.32702550849586415, 'acc': 0.8875082020997376, 'precision': 0.6870354038049641, 'recall': 0.9546568627450981, 'mcc': 0.7426613197928474}, {'loss': 0.46382286396058486, 'acc': 0.8606463254593176, 'precision': 0.6508474576271186, 'recall': 0.8739495798319328, 'mcc': 0.666327100622143}]
Averge metrics over 5 folds:
average loss:  0.4580462879624271
average accuracy:  0.8853859811641192
average precision:  0.7102601577861254
average recall:  0.8719304388422036
average mcc:  0.7131882306205148
cross-validation finished, end of program
