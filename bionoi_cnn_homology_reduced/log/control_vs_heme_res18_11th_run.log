data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4452
train Accuracy:0.884 Precision:0.698 Recall:0.886 F1:0.781 MCC:0.712.
val Loss: 0.7208
val Accuracy:0.846 Precision:0.653 Recall:0.739 F1:0.693 MCC:0.593.
 
Epoch 2/8
---------------
train Loss: 0.2864
train Accuracy:0.933 Precision:0.817 Recall:0.923 F1:0.866 MCC:0.825.
val Loss: 0.7815
val Accuracy:0.882 Precision:0.779 Recall:0.696 F1:0.735 MCC:0.661.
 
Epoch 3/8
---------------
train Loss: 0.2045
train Accuracy:0.953 Precision:0.865 Recall:0.946 F1:0.904 MCC:0.874.
val Loss: 0.7683
val Accuracy:0.866 Precision:0.690 Recall:0.780 F1:0.732 MCC:0.645.
 
Epoch 4/8
---------------
train Loss: 0.1407
train Accuracy:0.967 Precision:0.902 Recall:0.964 F1:0.932 MCC:0.911.
val Loss: 1.1651
val Accuracy:0.874 Precision:0.765 Recall:0.670 F1:0.714 MCC:0.636.
 
Epoch 5/8
---------------
train Loss: 0.1102
train Accuracy:0.974 Precision:0.922 Recall:0.973 F1:0.947 MCC:0.930.
val Loss: 1.1905
val Accuracy:0.877 Precision:0.782 Recall:0.663 F1:0.717 MCC:0.643.
 
Epoch 6/8
---------------
train Loss: 0.0876
train Accuracy:0.979 Precision:0.936 Recall:0.979 F1:0.957 MCC:0.944.
val Loss: 1.8304
val Accuracy:0.877 Precision:0.891 Recall:0.545 F1:0.677 MCC:0.634.
 
Epoch 7/8
---------------
train Loss: 0.0778
train Accuracy:0.981 Precision:0.941 Recall:0.981 F1:0.961 MCC:0.948.
val Loss: 1.4467
val Accuracy:0.889 Precision:0.821 Recall:0.673 F1:0.740 MCC:0.675.
 
Epoch 8/8
---------------
train Loss: 0.0702
train Accuracy:0.984 Precision:0.949 Recall:0.983 F1:0.965 MCC:0.955.
val Loss: 1.2474
val Accuracy:0.883 Precision:0.791 Recall:0.684 F1:0.733 MCC:0.662.
Training complete in 159m 6s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5004
train Accuracy:0.866 Precision:0.666 Recall:0.862 F1:0.751 MCC:0.672.
val Loss: 0.4894
val Accuracy:0.911 Precision:0.829 Recall:0.782 F1:0.805 MCC:0.748.
 
Epoch 2/8
---------------
train Loss: 0.3173
train Accuracy:0.923 Precision:0.794 Recall:0.909 F1:0.848 MCC:0.800.
val Loss: 0.3474
val Accuracy:0.908 Precision:0.738 Recall:0.944 F1:0.828 MCC:0.778.
 
Epoch 3/8
---------------
train Loss: 0.2148
train Accuracy:0.948 Precision:0.854 Recall:0.940 F1:0.895 MCC:0.862.
val Loss: 0.4854
val Accuracy:0.879 Precision:0.674 Recall:0.935 F1:0.784 MCC:0.721.
 
Epoch 4/8
---------------
train Loss: 0.1524
train Accuracy:0.963 Precision:0.892 Recall:0.960 F1:0.925 MCC:0.902.
val Loss: 0.4509
val Accuracy:0.896 Precision:0.719 Recall:0.913 F1:0.805 MCC:0.745.
 
Epoch 5/8
---------------
train Loss: 0.1207
train Accuracy:0.971 Precision:0.915 Recall:0.969 F1:0.941 MCC:0.923.
val Loss: 0.6003
val Accuracy:0.925 Precision:0.859 Recall:0.814 F1:0.836 MCC:0.788.
 
Epoch 6/8
---------------
train Loss: 0.1003
train Accuracy:0.976 Precision:0.926 Recall:0.974 F1:0.949 MCC:0.934.
val Loss: 0.4227
val Accuracy:0.923 Precision:0.804 Recall:0.887 F1:0.843 MCC:0.794.
 
Epoch 7/8
---------------
train Loss: 0.0823
train Accuracy:0.981 Precision:0.941 Recall:0.980 F1:0.960 MCC:0.948.
val Loss: 0.6848
val Accuracy:0.921 Precision:0.860 Recall:0.790 F1:0.823 MCC:0.773.
 
Epoch 8/8
---------------
train Loss: 0.0759
train Accuracy:0.982 Precision:0.945 Recall:0.981 F1:0.963 MCC:0.951.
val Loss: 0.4861
val Accuracy:0.931 Precision:0.824 Recall:0.898 F1:0.859 MCC:0.815.
Training complete in 159m 24s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5105
train Accuracy:0.860 Precision:0.652 Recall:0.860 F1:0.742 MCC:0.660.
val Loss: 0.3355
val Accuracy:0.933 Precision:0.831 Recall:0.897 F1:0.862 MCC:0.819.
 
Epoch 2/8
---------------
train Loss: 0.3168
train Accuracy:0.921 Precision:0.784 Recall:0.913 F1:0.844 MCC:0.795.
val Loss: 0.3960
val Accuracy:0.944 Precision:0.913 Recall:0.841 F1:0.876 MCC:0.841.
 
Epoch 3/8
---------------
train Loss: 0.2145
train Accuracy:0.948 Precision:0.850 Recall:0.943 F1:0.894 MCC:0.861.
val Loss: 0.4137
val Accuracy:0.933 Precision:0.857 Recall:0.857 F1:0.857 MCC:0.814.
 
Epoch 4/8
---------------
train Loss: 0.1573
train Accuracy:0.962 Precision:0.886 Recall:0.960 F1:0.921 MCC:0.897.
val Loss: 0.3621
val Accuracy:0.923 Precision:0.787 Recall:0.920 F1:0.848 MCC:0.801.
 
Epoch 5/8
---------------
train Loss: 0.1172
train Accuracy:0.972 Precision:0.914 Recall:0.971 F1:0.941 MCC:0.924.
val Loss: 0.4415
val Accuracy:0.941 Precision:0.859 Recall:0.894 F1:0.876 MCC:0.837.
 
Epoch 6/8
---------------
train Loss: 0.0953
train Accuracy:0.978 Precision:0.931 Recall:0.977 F1:0.953 MCC:0.939.
val Loss: 0.4402
val Accuracy:0.938 Precision:0.853 Recall:0.886 F1:0.869 MCC:0.829.
 
Epoch 7/8
---------------
train Loss: 0.0842
train Accuracy:0.980 Precision:0.938 Recall:0.980 F1:0.958 MCC:0.946.
val Loss: 0.4591
val Accuracy:0.932 Precision:0.813 Recall:0.920 F1:0.863 MCC:0.821.
 
Epoch 8/8
---------------
train Loss: 0.0735
train Accuracy:0.982 Precision:0.944 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.5012
val Accuracy:0.943 Precision:0.870 Recall:0.887 F1:0.878 MCC:0.841.
Training complete in 159m 27s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5125
train Accuracy:0.862 Precision:0.658 Recall:0.859 F1:0.745 MCC:0.663.
val Loss: 1.2449
val Accuracy:0.852 Precision:0.964 Recall:0.384 F1:0.550 MCC:0.553.
 
Epoch 2/8
---------------
train Loss: 0.3301
train Accuracy:0.918 Precision:0.780 Recall:0.905 F1:0.838 MCC:0.787.
val Loss: 0.3335
val Accuracy:0.938 Precision:0.850 Recall:0.894 F1:0.872 MCC:0.832.
 
Epoch 3/8
---------------
train Loss: 0.2198
train Accuracy:0.946 Precision:0.847 Recall:0.938 F1:0.890 MCC:0.856.
val Loss: 0.3276
val Accuracy:0.910 Precision:0.737 Recall:0.959 F1:0.833 MCC:0.786.
 
Epoch 4/8
---------------
train Loss: 0.1571
train Accuracy:0.961 Precision:0.886 Recall:0.959 F1:0.921 MCC:0.896.
val Loss: 0.3573
val Accuracy:0.936 Precision:0.847 Recall:0.887 F1:0.867 MCC:0.825.
 
Epoch 5/8
---------------
train Loss: 0.1226
train Accuracy:0.970 Precision:0.909 Recall:0.969 F1:0.938 MCC:0.919.
val Loss: 0.3469
val Accuracy:0.929 Precision:0.805 Recall:0.917 F1:0.858 MCC:0.813.
 
Epoch 6/8
---------------
train Loss: 0.1003
train Accuracy:0.976 Precision:0.927 Recall:0.975 F1:0.950 MCC:0.935.
val Loss: 0.3789
val Accuracy:0.933 Precision:0.839 Recall:0.885 F1:0.861 MCC:0.818.
 
Epoch 7/8
---------------
train Loss: 0.0877
train Accuracy:0.979 Precision:0.935 Recall:0.979 F1:0.956 MCC:0.943.
val Loss: 0.4269
val Accuracy:0.919 Precision:0.776 Recall:0.920 F1:0.842 MCC:0.794.
 
Epoch 8/8
---------------
train Loss: 0.0781
train Accuracy:0.981 Precision:0.942 Recall:0.981 F1:0.961 MCC:0.949.
val Loss: 0.4058
val Accuracy:0.910 Precision:0.741 Recall:0.945 F1:0.830 MCC:0.781.
Training complete in 159m 13s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4753
train Accuracy:0.877 Precision:0.687 Recall:0.873 F1:0.769 MCC:0.696.
val Loss: 0.4950
val Accuracy:0.861 Precision:0.656 Recall:0.856 F1:0.743 MCC:0.661.
 
Epoch 2/8
---------------
train Loss: 0.3087
train Accuracy:0.927 Precision:0.802 Recall:0.913 F1:0.854 MCC:0.809.
val Loss: 0.4899
val Accuracy:0.890 Precision:0.718 Recall:0.873 F1:0.788 MCC:0.721.
 
Epoch 3/8
---------------
train Loss: 0.2017
train Accuracy:0.952 Precision:0.863 Recall:0.945 F1:0.902 MCC:0.872.
val Loss: 0.6052
val Accuracy:0.893 Precision:0.757 Recall:0.803 F1:0.779 MCC:0.710.
 
Epoch 4/8
---------------
train Loss: 0.1421
train Accuracy:0.966 Precision:0.899 Recall:0.964 F1:0.930 MCC:0.909.
val Loss: 0.6678
val Accuracy:0.908 Precision:0.800 Recall:0.810 F1:0.805 MCC:0.745.
 
Epoch 5/8
---------------
train Loss: 0.1116
train Accuracy:0.974 Precision:0.919 Recall:0.973 F1:0.945 MCC:0.929.
val Loss: 0.6351
val Accuracy:0.913 Precision:0.811 Recall:0.821 F1:0.816 MCC:0.759.
 
Epoch 6/8
---------------
train Loss: 0.0917
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.5906
val Accuracy:0.917 Precision:0.806 Recall:0.847 F1:0.826 MCC:0.772.
 
Epoch 7/8
---------------
train Loss: 0.0764
train Accuracy:0.982 Precision:0.943 Recall:0.981 F1:0.962 MCC:0.950.
val Loss: 0.8320
val Accuracy:0.890 Precision:0.736 Recall:0.827 F1:0.779 MCC:0.708.
 
Epoch 8/8
---------------
train Loss: 0.0714
train Accuracy:0.983 Precision:0.947 Recall:0.983 F1:0.965 MCC:0.954.
val Loss: 0.7347
val Accuracy:0.916 Precision:0.828 Recall:0.808 F1:0.818 MCC:0.764.
Training complete in 159m 15s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7208362002729201, 'acc': 0.8459967320261438, 'precision': 0.6525605642440969, 'recall': 0.7388888888888889, 'mcc': 0.5928190166369742}, {'loss': 0.34744272307612567, 'acc': 0.9083415354330708, 'precision': 0.737987679671458, 'recall': 0.9438025210084033, 'mcc': 0.777852160009818}, {'loss': 0.33551245930255086, 'acc': 0.9329478346456693, 'precision': 0.8305497000162153, 'recall': 0.8967086834733894, 'mcc': 0.8191758362156203}, {'loss': 0.3275975635769628, 'acc': 0.9100639763779528, 'precision': 0.7365237263072993, 'recall': 0.9592086834733894, 'mcc': 0.7857613856246463}, {'loss': 0.489915993076864, 'acc': 0.8898458005249343, 'precision': 0.7177605066206102, 'recall': 0.8730742296918768, 'mcc': 0.7206527582231389}]
Averge metrics over 5 folds:
average loss:  0.4442609878610847
average accuracy:  0.8974391758015543
average precision:  0.7350764353719359
average recall:  0.8823366013071896
average mcc:  0.7392522313420395
cross-validation finished, end of program
