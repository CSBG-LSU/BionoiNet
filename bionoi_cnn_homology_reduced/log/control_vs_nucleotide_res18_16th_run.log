data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4368
train Accuracy:0.824 Precision:0.790 Recall:0.822 F1:0.806 MCC:0.646.
val Loss: 0.4283
val Accuracy:0.826 Precision:0.782 Recall:0.843 F1:0.812 MCC:0.653.
 
Epoch 2/8
---------------
train Loss: 0.3242
train Accuracy:0.877 Precision:0.854 Recall:0.872 F1:0.863 MCC:0.752.
val Loss: 0.3948
val Accuracy:0.842 Precision:0.821 Recall:0.824 F1:0.823 MCC:0.681.
 
Epoch 3/8
---------------
train Loss: 0.2557
train Accuracy:0.905 Precision:0.887 Recall:0.900 F1:0.893 MCC:0.807.
val Loss: 0.4473
val Accuracy:0.830 Precision:0.774 Recall:0.871 F1:0.820 MCC:0.664.
 
Epoch 4/8
---------------
train Loss: 0.1991
train Accuracy:0.928 Precision:0.915 Recall:0.923 F1:0.919 MCC:0.854.
val Loss: 0.4697
val Accuracy:0.847 Precision:0.823 Recall:0.833 F1:0.828 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.1577
train Accuracy:0.944 Precision:0.934 Recall:0.941 F1:0.937 MCC:0.887.
val Loss: 0.5265
val Accuracy:0.835 Precision:0.815 Recall:0.812 F1:0.814 MCC:0.665.
 
Epoch 6/8
---------------
train Loss: 0.1308
train Accuracy:0.955 Precision:0.946 Recall:0.953 F1:0.950 MCC:0.909.
val Loss: 0.5611
val Accuracy:0.830 Precision:0.846 Recall:0.754 F1:0.797 MCC:0.655.
 
Epoch 7/8
---------------
train Loss: 0.1087
train Accuracy:0.963 Precision:0.955 Recall:0.962 F1:0.958 MCC:0.925.
val Loss: 0.6235
val Accuracy:0.833 Precision:0.811 Recall:0.813 F1:0.812 MCC:0.662.
 
Epoch 8/8
---------------
train Loss: 0.0989
train Accuracy:0.966 Precision:0.959 Recall:0.964 F1:0.962 MCC:0.931.
val Loss: 0.6253
val Accuracy:0.836 Precision:0.820 Recall:0.807 F1:0.814 MCC:0.668.
Training complete in 208m 4s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4507
train Accuracy:0.817 Precision:0.782 Recall:0.815 F1:0.798 MCC:0.631.
val Loss: 0.3929
val Accuracy:0.848 Precision:0.819 Recall:0.844 F1:0.831 MCC:0.693.
 
Epoch 2/8
---------------
train Loss: 0.3373
train Accuracy:0.868 Precision:0.840 Recall:0.869 F1:0.854 MCC:0.734.
val Loss: 0.3940
val Accuracy:0.857 Precision:0.875 Recall:0.791 F1:0.831 MCC:0.710.
 
Epoch 3/8
---------------
train Loss: 0.2636
train Accuracy:0.901 Precision:0.878 Recall:0.902 F1:0.890 MCC:0.800.
val Loss: 0.3891
val Accuracy:0.861 Precision:0.841 Recall:0.846 F1:0.844 MCC:0.718.
 
Epoch 4/8
---------------
train Loss: 0.2044
train Accuracy:0.925 Precision:0.907 Recall:0.925 F1:0.916 MCC:0.848.
val Loss: 0.4234
val Accuracy:0.840 Precision:0.775 Recall:0.903 F1:0.834 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.1594
train Accuracy:0.943 Precision:0.929 Recall:0.943 F1:0.936 MCC:0.884.
val Loss: 0.4790
val Accuracy:0.856 Precision:0.800 Recall:0.901 F1:0.847 MCC:0.716.
 
Epoch 6/8
---------------
train Loss: 0.1301
train Accuracy:0.954 Precision:0.943 Recall:0.954 F1:0.949 MCC:0.907.
val Loss: 0.4941
val Accuracy:0.851 Precision:0.801 Recall:0.883 F1:0.840 MCC:0.704.
 
Epoch 7/8
---------------
train Loss: 0.1123
train Accuracy:0.961 Precision:0.951 Recall:0.961 F1:0.956 MCC:0.921.
val Loss: 0.5216
val Accuracy:0.851 Precision:0.798 Recall:0.889 F1:0.841 MCC:0.704.
 
Epoch 8/8
---------------
train Loss: 0.0991
train Accuracy:0.966 Precision:0.958 Recall:0.966 F1:0.962 MCC:0.932.
val Loss: 0.5715
val Accuracy:0.852 Precision:0.873 Recall:0.780 F1:0.824 MCC:0.700.
Training complete in 207m 45s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4568
train Accuracy:0.813 Precision:0.776 Recall:0.814 F1:0.795 MCC:0.624.
val Loss: 0.3532
val Accuracy:0.858 Precision:0.797 Recall:0.914 F1:0.851 MCC:0.723.
 
Epoch 2/8
---------------
train Loss: 0.3405
train Accuracy:0.869 Precision:0.841 Recall:0.869 F1:0.855 MCC:0.736.
val Loss: 0.3126
val Accuracy:0.880 Precision:0.847 Recall:0.890 F1:0.868 MCC:0.758.
 
Epoch 3/8
---------------
train Loss: 0.2672
train Accuracy:0.900 Precision:0.880 Recall:0.898 F1:0.889 MCC:0.798.
val Loss: 0.3059
val Accuracy:0.888 Precision:0.850 Recall:0.908 F1:0.878 MCC:0.775.
 
Epoch 4/8
---------------
train Loss: 0.2049
train Accuracy:0.926 Precision:0.910 Recall:0.924 F1:0.917 MCC:0.850.
val Loss: 0.3541
val Accuracy:0.869 Precision:0.831 Recall:0.885 F1:0.857 MCC:0.737.
 
Epoch 5/8
---------------
train Loss: 0.1643
train Accuracy:0.942 Precision:0.929 Recall:0.941 F1:0.935 MCC:0.882.
val Loss: 0.4382
val Accuracy:0.859 Precision:0.831 Recall:0.856 F1:0.843 MCC:0.715.
 
Epoch 6/8
---------------
train Loss: 0.1333
train Accuracy:0.953 Precision:0.943 Recall:0.953 F1:0.948 MCC:0.906.
val Loss: 0.3954
val Accuracy:0.875 Precision:0.858 Recall:0.861 F1:0.859 MCC:0.746.
 
Epoch 7/8
---------------
train Loss: 0.1148
train Accuracy:0.960 Precision:0.951 Recall:0.960 F1:0.955 MCC:0.919.
val Loss: 0.3939
val Accuracy:0.878 Precision:0.859 Recall:0.868 F1:0.864 MCC:0.754.
 
Epoch 8/8
---------------
train Loss: 0.0980
train Accuracy:0.967 Precision:0.958 Recall:0.966 F1:0.962 MCC:0.932.
val Loss: 0.4440
val Accuracy:0.878 Precision:0.889 Recall:0.830 F1:0.859 MCC:0.753.
Training complete in 207m 57s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4333
train Accuracy:0.826 Precision:0.792 Recall:0.824 F1:0.808 MCC:0.649.
val Loss: 0.4444
val Accuracy:0.822 Precision:0.824 Recall:0.761 F1:0.791 MCC:0.638.
 
Epoch 2/8
---------------
train Loss: 0.3120
train Accuracy:0.881 Precision:0.857 Recall:0.878 F1:0.867 MCC:0.759.
val Loss: 0.4415
val Accuracy:0.842 Precision:0.856 Recall:0.775 F1:0.813 MCC:0.680.
 
Epoch 3/8
---------------
train Loss: 0.2418
train Accuracy:0.911 Precision:0.894 Recall:0.907 F1:0.900 MCC:0.820.
val Loss: 0.5003
val Accuracy:0.837 Precision:0.784 Recall:0.873 F1:0.826 MCC:0.677.
 
Epoch 4/8
---------------
train Loss: 0.1828
train Accuracy:0.935 Precision:0.921 Recall:0.933 F1:0.927 MCC:0.868.
val Loss: 0.5305
val Accuracy:0.840 Precision:0.899 Recall:0.721 F1:0.800 MCC:0.681.
 
Epoch 5/8
---------------
train Loss: 0.1450
train Accuracy:0.949 Precision:0.939 Recall:0.948 F1:0.943 MCC:0.897.
val Loss: 0.5030
val Accuracy:0.853 Precision:0.847 Recall:0.816 F1:0.831 MCC:0.701.
 
Epoch 6/8
---------------
train Loss: 0.1183
train Accuracy:0.959 Precision:0.951 Recall:0.957 F1:0.954 MCC:0.918.
val Loss: 0.6975
val Accuracy:0.839 Precision:0.855 Recall:0.766 F1:0.808 MCC:0.673.
 
Epoch 7/8
---------------
train Loss: 0.1026
train Accuracy:0.965 Precision:0.957 Recall:0.964 F1:0.961 MCC:0.929.
val Loss: 0.5676
val Accuracy:0.842 Precision:0.795 Recall:0.869 F1:0.830 MCC:0.686.
 
Epoch 8/8
---------------
train Loss: 0.0909
train Accuracy:0.969 Precision:0.962 Recall:0.968 F1:0.965 MCC:0.937.
val Loss: 0.7587
val Accuracy:0.838 Precision:0.835 Recall:0.792 F1:0.813 MCC:0.671.
Training complete in 208m 17s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4327
train Accuracy:0.826 Precision:0.794 Recall:0.821 F1:0.807 MCC:0.649.
val Loss: 0.4446
val Accuracy:0.829 Precision:0.842 Recall:0.758 F1:0.798 MCC:0.654.
 
Epoch 2/8
---------------
train Loss: 0.3110
train Accuracy:0.881 Precision:0.858 Recall:0.878 F1:0.868 MCC:0.760.
val Loss: 0.4395
val Accuracy:0.840 Precision:0.834 Recall:0.797 F1:0.815 MCC:0.674.
 
Epoch 3/8
---------------
train Loss: 0.2403
train Accuracy:0.911 Precision:0.894 Recall:0.908 F1:0.901 MCC:0.821.
val Loss: 0.5088
val Accuracy:0.829 Precision:0.762 Recall:0.892 F1:0.822 MCC:0.666.
 
Epoch 4/8
---------------
train Loss: 0.1846
train Accuracy:0.934 Precision:0.921 Recall:0.931 F1:0.926 MCC:0.867.
val Loss: 0.5475
val Accuracy:0.842 Precision:0.802 Recall:0.854 F1:0.827 MCC:0.683.
 
Epoch 5/8
---------------
train Loss: 0.1459
train Accuracy:0.949 Precision:0.938 Recall:0.947 F1:0.943 MCC:0.896.
val Loss: 0.5801
val Accuracy:0.838 Precision:0.830 Recall:0.799 F1:0.814 MCC:0.671.
 
Epoch 6/8
---------------
train Loss: 0.1207
train Accuracy:0.959 Precision:0.950 Recall:0.958 F1:0.954 MCC:0.917.
val Loss: 0.7123
val Accuracy:0.803 Precision:0.731 Recall:0.879 F1:0.798 MCC:0.619.
 
Epoch 7/8
---------------
train Loss: 0.1054
train Accuracy:0.964 Precision:0.957 Recall:0.963 F1:0.960 MCC:0.927.
val Loss: 0.6073
val Accuracy:0.829 Precision:0.814 Recall:0.796 F1:0.805 MCC:0.653.
 
Epoch 8/8
---------------
train Loss: 0.0937
train Accuracy:0.969 Precision:0.962 Recall:0.968 F1:0.965 MCC:0.937.
val Loss: 0.6992
val Accuracy:0.836 Precision:0.825 Recall:0.799 F1:0.812 MCC:0.666.
Training complete in 208m 30s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.3948048803099722, 'acc': 0.8423383262006657, 'precision': 0.8213450878247512, 'recall': 0.8238210075026795, 'mcc': 0.6807203738249833}, {'loss': 0.3891024934119057, 'acc': 0.8607738095238096, 'precision': 0.8412117177097204, 'recall': 0.8463960342979635, 'mcc': 0.7182319288523948}, {'loss': 0.3059339993775246, 'acc': 0.8876488095238095, 'precision': 0.8496019058366246, 'recall': 0.9078242229367631, 'mcc': 0.7754805400255339}, {'loss': 0.44150755807586833, 'acc': 0.8423640915593705, 'precision': 0.85603979508501, 'recall': 0.7748655913978495, 'mcc': 0.6800651943503419}, {'loss': 0.43953174136447576, 'acc': 0.8395624701955174, 'precision': 0.8341895981420226, 'recall': 0.7965725806451613, 'mcc': 0.6740367170958835}]
Averge metrics over 5 folds:
average loss:  0.3941761345079493
average accuracy:  0.8545375014006344
average precision:  0.8404776209196256
average recall:  0.8298958873560833
average mcc:  0.7057069508298276
cross-validation finished, end of program
