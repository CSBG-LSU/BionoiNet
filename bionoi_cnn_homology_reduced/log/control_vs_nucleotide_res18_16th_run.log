data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4368
train Accuracy:0.824 Precision:0.790 Recall:0.822 F1:0.806 MCC:0.646.
val Loss: 0.4283
val Accuracy:0.826 Precision:0.782 Recall:0.843 F1:0.812 MCC:0.653.
 
Epoch 2/8
---------------
train Loss: 0.3242
train Accuracy:0.877 Precision:0.854 Recall:0.872 F1:0.863 MCC:0.752.
val Loss: 0.3948
val Accuracy:0.842 Precision:0.821 Recall:0.824 F1:0.823 MCC:0.681.
 
Epoch 3/8
---------------
train Loss: 0.2557
train Accuracy:0.905 Precision:0.887 Recall:0.900 F1:0.893 MCC:0.807.
val Loss: 0.4473
val Accuracy:0.830 Precision:0.774 Recall:0.871 F1:0.820 MCC:0.664.
 
Epoch 4/8
---------------
train Loss: 0.1991
train Accuracy:0.928 Precision:0.915 Recall:0.923 F1:0.919 MCC:0.854.
val Loss: 0.4697
val Accuracy:0.847 Precision:0.823 Recall:0.833 F1:0.828 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.1577
train Accuracy:0.944 Precision:0.934 Recall:0.941 F1:0.937 MCC:0.887.
val Loss: 0.5265
val Accuracy:0.835 Precision:0.815 Recall:0.812 F1:0.814 MCC:0.665.
 
Epoch 6/8
---------------
train Loss: 0.1308
train Accuracy:0.955 Precision:0.946 Recall:0.953 F1:0.950 MCC:0.909.
val Loss: 0.5611
val Accuracy:0.830 Precision:0.846 Recall:0.754 F1:0.797 MCC:0.655.
 
Epoch 7/8
---------------
train Loss: 0.1087
train Accuracy:0.963 Precision:0.955 Recall:0.962 F1:0.958 MCC:0.925.
val Loss: 0.6235
val Accuracy:0.833 Precision:0.811 Recall:0.813 F1:0.812 MCC:0.662.
 
Epoch 8/8
---------------
train Loss: 0.0989
train Accuracy:0.966 Precision:0.959 Recall:0.964 F1:0.962 MCC:0.931.
val Loss: 0.6253
val Accuracy:0.836 Precision:0.820 Recall:0.807 F1:0.814 MCC:0.668.
Training complete in 208m 4s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4507
train Accuracy:0.817 Precision:0.782 Recall:0.815 F1:0.798 MCC:0.631.
val Loss: 0.3929
val Accuracy:0.848 Precision:0.819 Recall:0.844 F1:0.831 MCC:0.693.
 
Epoch 2/8
---------------
train Loss: 0.3373
train Accuracy:0.868 Precision:0.840 Recall:0.869 F1:0.854 MCC:0.734.
val Loss: 0.3940
val Accuracy:0.857 Precision:0.875 Recall:0.791 F1:0.831 MCC:0.710.
 
Epoch 3/8
---------------
train Loss: 0.2636
train Accuracy:0.901 Precision:0.878 Recall:0.902 F1:0.890 MCC:0.800.
val Loss: 0.3891
val Accuracy:0.861 Precision:0.841 Recall:0.846 F1:0.844 MCC:0.718.
 
Epoch 4/8
---------------
train Loss: 0.2044
train Accuracy:0.925 Precision:0.907 Recall:0.925 F1:0.916 MCC:0.848.
val Loss: 0.4234
val Accuracy:0.840 Precision:0.775 Recall:0.903 F1:0.834 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.1594
train Accuracy:0.943 Precision:0.929 Recall:0.943 F1:0.936 MCC:0.884.
val Loss: 0.4790
val Accuracy:0.856 Precision:0.800 Recall:0.901 F1:0.847 MCC:0.716.
 
Epoch 6/8
---------------
train Loss: 0.1301
train Accuracy:0.954 Precision:0.943 Recall:0.954 F1:0.949 MCC:0.907.
val Loss: 0.4941
val Accuracy:0.851 Precision:0.801 Recall:0.883 F1:0.840 MCC:0.704.
 
Epoch 7/8
---------------
