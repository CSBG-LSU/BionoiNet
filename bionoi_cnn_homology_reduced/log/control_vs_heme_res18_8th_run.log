data directory: ../../data_homology_reduced/images/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3736
train Accuracy:0.905 Precision:0.745 Recall:0.905 F1:0.818 MCC:0.761.
val Loss: 0.9675
val Accuracy:0.876 Precision:0.873 Recall:0.556 F1:0.679 MCC:0.631.
 
Epoch 2/8
---------------
train Loss: 0.2207
train Accuracy:0.947 Precision:0.847 Recall:0.944 F1:0.893 MCC:0.860.
val Loss: 0.8700
val Accuracy:0.874 Precision:0.718 Recall:0.762 F1:0.740 MCC:0.657.
 
Epoch 3/8
---------------
train Loss: 0.1383
train Accuracy:0.966 Precision:0.897 Recall:0.967 F1:0.931 MCC:0.909.
val Loss: 0.8161
val Accuracy:0.872 Precision:0.705 Recall:0.780 F1:0.741 MCC:0.657.
 
Epoch 4/8
---------------
train Loss: 0.0982
train Accuracy:0.977 Precision:0.928 Recall:0.978 F1:0.952 MCC:0.938.
val Loss: 1.2583
val Accuracy:0.869 Precision:0.741 Recall:0.684 F1:0.711 MCC:0.628.
 
Epoch 5/8
---------------
train Loss: 0.0776
train Accuracy:0.982 Precision:0.943 Recall:0.981 F1:0.962 MCC:0.950.
val Loss: 1.3892
val Accuracy:0.894 Precision:0.870 Recall:0.646 F1:0.742 MCC:0.689.
 
Epoch 6/8
---------------
train Loss: 0.0656
train Accuracy:0.985 Precision:0.951 Recall:0.986 F1:0.968 MCC:0.959.
val Loss: 1.5583
val Accuracy:0.891 Precision:0.881 Recall:0.621 F1:0.728 MCC:0.678.
 
Epoch 7/8
---------------
train Loss: 0.0549
train Accuracy:0.987 Precision:0.958 Recall:0.988 F1:0.972 MCC:0.964.
val Loss: 1.8272
val Accuracy:0.884 Precision:0.832 Recall:0.638 F1:0.722 MCC:0.660.
 
Epoch 8/8
---------------
train Loss: 0.0514
train Accuracy:0.988 Precision:0.962 Recall:0.988 F1:0.975 MCC:0.967.
val Loss: 1.5230
val Accuracy:0.885 Precision:0.825 Recall:0.651 F1:0.728 MCC:0.664.
Training complete in 167m 47s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4177
train Accuracy:0.891 Precision:0.715 Recall:0.887 F1:0.792 MCC:0.727.
val Loss: 0.8511
val Accuracy:0.881 Precision:0.879 Recall:0.570 F1:0.691 MCC:0.644.
 
Epoch 2/8
---------------
train Loss: 0.2338
train Accuracy:0.942 Precision:0.834 Recall:0.939 F1:0.883 MCC:0.847.
val Loss: 0.3579
val Accuracy:0.924 Precision:0.797 Recall:0.905 F1:0.848 MCC:0.800.
 
Epoch 3/8
---------------
train Loss: 0.1475
train Accuracy:0.964 Precision:0.893 Recall:0.964 F1:0.927 MCC:0.904.
val Loss: 0.4901
val Accuracy:0.884 Precision:0.688 Recall:0.922 F1:0.788 MCC:0.724.
 
Epoch 4/8
---------------
train Loss: 0.1040
train Accuracy:0.974 Precision:0.921 Recall:0.974 F1:0.947 MCC:0.931.
val Loss: 0.6030
val Accuracy:0.928 Precision:0.858 Recall:0.828 F1:0.843 MCC:0.796.
 
Epoch 5/8
---------------
train Loss: 0.0846
train Accuracy:0.980 Precision:0.936 Recall:0.981 F1:0.958 MCC:0.945.
val Loss: 1.5731
val Accuracy:0.882 Precision:0.953 Recall:0.522 F1:0.675 MCC:0.652.
 
Epoch 6/8
---------------
train Loss: 0.0718
train Accuracy:0.983 Precision:0.946 Recall:0.983 F1:0.964 MCC:0.953.
val Loss: 0.4904
val Accuracy:0.932 Precision:0.817 Recall:0.913 F1:0.863 MCC:0.820.
 
Epoch 7/8
---------------
train Loss: 0.0626
train Accuracy:0.985 Precision:0.953 Recall:0.985 F1:0.969 MCC:0.959.
val Loss: 0.4051
val Accuracy:0.928 Precision:0.803 Recall:0.916 F1:0.856 MCC:0.811.
 
Epoch 8/8
---------------
train Loss: 0.0554
train Accuracy:0.987 Precision:0.958 Recall:0.987 F1:0.972 MCC:0.964.
val Loss: 0.8014
val Accuracy:0.920 Precision:0.849 Recall:0.802 F1:0.825 MCC:0.774.
Training complete in 167m 48s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4282
train Accuracy:0.887 Precision:0.708 Recall:0.885 F1:0.786 MCC:0.719.
val Loss: 0.3861
val Accuracy:0.911 Precision:0.758 Recall:0.911 F1:0.827 MCC:0.774.
 
Epoch 2/8
---------------
train Loss: 0.2499
train Accuracy:0.936 Precision:0.819 Recall:0.935 F1:0.873 MCC:0.835.
val Loss: 0.3720
val Accuracy:0.927 Precision:0.801 Recall:0.914 F1:0.853 MCC:0.808.
 
Epoch 3/8
---------------
train Loss: 0.1600
train Accuracy:0.961 Precision:0.882 Recall:0.962 F1:0.920 MCC:0.896.
val Loss: 0.4732
val Accuracy:0.931 Precision:0.820 Recall:0.902 F1:0.859 MCC:0.815.
 
Epoch 4/8
---------------
train Loss: 0.1172
train Accuracy:0.971 Precision:0.912 Recall:0.972 F1:0.941 MCC:0.923.
val Loss: 0.4063
val Accuracy:0.947 Precision:0.868 Recall:0.912 F1:0.890 MCC:0.855.
 
Epoch 5/8
---------------
train Loss: 0.0891
train Accuracy:0.979 Precision:0.934 Recall:0.980 F1:0.956 MCC:0.943.
val Loss: 0.4929
val Accuracy:0.917 Precision:0.786 Recall:0.885 F1:0.833 MCC:0.780.
 
Epoch 6/8
---------------
train Loss: 0.0750
train Accuracy:0.982 Precision:0.944 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.4723
val Accuracy:0.929 Precision:0.822 Recall:0.891 F1:0.855 MCC:0.809.
 
Epoch 7/8
---------------
train Loss: 0.0613
train Accuracy:0.986 Precision:0.955 Recall:0.986 F1:0.970 MCC:0.961.
val Loss: 0.4793
val Accuracy:0.940 Precision:0.847 Recall:0.909 F1:0.877 MCC:0.839.
 
Epoch 8/8
---------------
train Loss: 0.0607
train Accuracy:0.986 Precision:0.956 Recall:0.985 F1:0.971 MCC:0.962.
val Loss: 0.5641
val Accuracy:0.911 Precision:0.749 Recall:0.935 F1:0.832 MCC:0.781.
Training complete in 167m 48s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4264
train Accuracy:0.889 Precision:0.712 Recall:0.884 F1:0.789 MCC:0.722.
val Loss: 0.3753
val Accuracy:0.938 Precision:0.885 Recall:0.848 F1:0.866 MCC:0.826.
 
Epoch 2/8
---------------
train Loss: 0.2421
train Accuracy:0.940 Precision:0.827 Recall:0.938 F1:0.879 MCC:0.842.
val Loss: 0.4108
val Accuracy:0.927 Precision:0.832 Recall:0.864 F1:0.848 MCC:0.800.
 
Epoch 3/8
---------------
train Loss: 0.1564
train Accuracy:0.961 Precision:0.883 Recall:0.962 F1:0.921 MCC:0.897.
val Loss: 0.5655
val Accuracy:0.872 Precision:0.654 Recall:0.962 F1:0.779 MCC:0.719.
 
Epoch 4/8
---------------
train Loss: 0.1117
train Accuracy:0.973 Precision:0.916 Recall:0.974 F1:0.944 MCC:0.927.
val Loss: 0.2798
val Accuracy:0.946 Precision:0.867 Recall:0.907 F1:0.887 MCC:0.852.
 
Epoch 5/8
---------------
train Loss: 0.0894
train Accuracy:0.979 Precision:0.933 Recall:0.979 F1:0.956 MCC:0.942.
val Loss: 0.3588
val Accuracy:0.925 Precision:0.776 Recall:0.954 F1:0.856 MCC:0.814.
 
Epoch 6/8
---------------
train Loss: 0.0757
train Accuracy:0.982 Precision:0.945 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.4586
val Accuracy:0.907 Precision:0.722 Recall:0.978 F1:0.831 MCC:0.785.
 
Epoch 7/8
---------------
train Loss: 0.0678
train Accuracy:0.984 Precision:0.950 Recall:0.984 F1:0.967 MCC:0.957.
val Loss: 0.5232
val Accuracy:0.935 Precision:0.873 Recall:0.844 F1:0.858 MCC:0.816.
 
Epoch 8/8
---------------
train Loss: 0.0585
train Accuracy:0.986 Precision:0.957 Recall:0.987 F1:0.972 MCC:0.963.
val Loss: 0.5147
val Accuracy:0.880 Precision:0.669 Recall:0.970 F1:0.792 MCC:0.736.
Training complete in 167m 46s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0002
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3960
train Accuracy:0.898 Precision:0.730 Recall:0.896 F1:0.804 MCC:0.743.
val Loss: 0.5090
val Accuracy:0.886 Precision:0.734 Recall:0.804 F1:0.767 MCC:0.693.
 
Epoch 2/8
---------------
train Loss: 0.2175
train Accuracy:0.945 Precision:0.841 Recall:0.944 F1:0.890 MCC:0.856.
val Loss: 0.4993
val Accuracy:0.902 Precision:0.764 Recall:0.841 F1:0.801 MCC:0.738.
 
Epoch 3/8
---------------
train Loss: 0.1346
train Accuracy:0.967 Precision:0.899 Recall:0.968 F1:0.932 MCC:0.911.
val Loss: 0.7666
val Accuracy:0.916 Precision:0.870 Recall:0.757 F1:0.809 MCC:0.759.
 
Epoch 4/8
---------------
train Loss: 0.0975
train Accuracy:0.976 Precision:0.925 Recall:0.977 F1:0.950 MCC:0.935.
val Loss: 0.7703
val Accuracy:0.893 Precision:0.737 Recall:0.842 F1:0.786 MCC:0.718.
 
Epoch 5/8
---------------
train Loss: 0.0832
train Accuracy:0.980 Precision:0.938 Recall:0.980 F1:0.959 MCC:0.946.
val Loss: 0.7205
val Accuracy:0.919 Precision:0.847 Recall:0.796 F1:0.821 MCC:0.769.
 
Epoch 6/8
---------------
train Loss: 0.0641
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.968 MCC:0.959.
val Loss: 0.5467
val Accuracy:0.901 Precision:0.741 Recall:0.888 F1:0.808 MCC:0.748.
 
Epoch 7/8
---------------
train Loss: 0.0598
train Accuracy:0.986 Precision:0.956 Recall:0.986 F1:0.971 MCC:0.962.
val Loss: 0.8064
val Accuracy:0.911 Precision:0.813 Recall:0.805 F1:0.809 MCC:0.751.
 
Epoch 8/8
---------------
train Loss: 0.0547
train Accuracy:0.987 Precision:0.960 Recall:0.987 F1:0.973 MCC:0.965.
val Loss: 0.9186
val Accuracy:0.912 Precision:0.830 Recall:0.786 F1:0.807 MCC:0.751.
Training complete in 167m 49s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.8161169441550775, 'acc': 0.8715277777777778, 'precision': 0.7054202670856246, 'recall': 0.7795138888888888, 'mcc': 0.6569641825605347}, {'loss': 0.35792559022059434, 'acc': 0.9238435039370079, 'precision': 0.7971327269924464, 'recall': 0.9052871148459384, 'mcc': 0.8001357292770185}, {'loss': 0.37203642754055305, 'acc': 0.926509186351706, 'precision': 0.8007057379564283, 'recall': 0.9136904761904762, 'mcc': 0.8078363950119181}, {'loss': 0.2797552921608814, 'acc': 0.9457841207349081, 'precision': 0.8673025435073628, 'recall': 0.9073879551820728, 'mcc': 0.8516395662680948}, {'loss': 0.4992809067028049, 'acc': 0.9020259186351706, 'precision': 0.7644437370682795, 'recall': 0.8408613445378151, 'mcc': 0.737531642091149}]
Averge metrics over 5 folds:
average loss:  0.4650230321559822
average accuracy:  0.9139381014873139
average precision:  0.7870010025220283
average recall:  0.8693481559290384
average mcc:  0.7708215030417429
cross-validation finished, end of program
