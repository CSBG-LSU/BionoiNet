data directory: ../../bionoi_output/hydrophobicity/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/nucleotide/fold_2', '../../bionoi_output/hydrophobicity/nucleotide/fold_3', '../../bionoi_output/hydrophobicity/nucleotide/fold_4', '../../bionoi_output/hydrophobicity/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4328
train Accuracy:0.826 Precision:0.791 Recall:0.826 F1:0.808 MCC:0.649.
val Loss: 0.4141
val Accuracy:0.837 Precision:0.811 Recall:0.825 F1:0.818 MCC:0.670.
 
Epoch 2/8
---------------
train Loss: 0.3052
train Accuracy:0.884 Precision:0.863 Recall:0.880 F1:0.871 MCC:0.766.
val Loss: 0.8690
val Accuracy:0.744 Precision:0.892 Recall:0.482 F1:0.626 MCC:0.507.
 
Epoch 3/8
---------------
train Loss: 0.2101
train Accuracy:0.924 Precision:0.909 Recall:0.921 F1:0.915 MCC:0.846.
val Loss: 0.4313
val Accuracy:0.848 Precision:0.832 Recall:0.825 F1:0.828 MCC:0.692.
 
Epoch 4/8
---------------
train Loss: 0.1433
train Accuracy:0.950 Precision:0.939 Recall:0.948 F1:0.944 MCC:0.898.
val Loss: 0.8037
val Accuracy:0.812 Precision:0.905 Recall:0.643 F1:0.752 MCC:0.630.
 
Epoch 5/8
---------------
train Loss: 0.1050
train Accuracy:0.964 Precision:0.956 Recall:0.963 F1:0.960 MCC:0.927.
val Loss: 0.5394
val Accuracy:0.852 Precision:0.829 Recall:0.841 F1:0.835 MCC:0.702.
 
Epoch 6/8
---------------
train Loss: 0.0857
train Accuracy:0.971 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.6810
val Accuracy:0.840 Precision:0.906 Recall:0.714 F1:0.799 MCC:0.682.
 
Epoch 7/8
---------------
train Loss: 0.0710
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.5922
val Accuracy:0.853 Precision:0.855 Recall:0.806 F1:0.830 MCC:0.702.
 
Epoch 8/8
---------------
train Loss: 0.0638
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.977 MCC:0.958.
val Loss: 0.7811
val Accuracy:0.837 Precision:0.862 Recall:0.752 F1:0.803 MCC:0.669.
Training complete in 230m 53s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/nucleotide/fold_1', '../../bionoi_output/hydrophobicity/nucleotide/fold_3', '../../bionoi_output/hydrophobicity/nucleotide/fold_4', '../../bionoi_output/hydrophobicity/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4379
train Accuracy:0.820 Precision:0.781 Recall:0.826 F1:0.803 MCC:0.639.
val Loss: 0.3993
val Accuracy:0.848 Precision:0.817 Recall:0.848 F1:0.832 MCC:0.694.
 
Epoch 2/8
---------------
train Loss: 0.3041
train Accuracy:0.883 Precision:0.855 Recall:0.887 F1:0.871 MCC:0.765.
val Loss: 0.4192
val Accuracy:0.860 Precision:0.877 Recall:0.795 F1:0.834 MCC:0.716.
 
Epoch 3/8
---------------
train Loss: 0.2105
train Accuracy:0.923 Precision:0.905 Recall:0.924 F1:0.914 MCC:0.845.
val Loss: 0.3655
val Accuracy:0.876 Precision:0.870 Recall:0.848 F1:0.859 MCC:0.749.
 
Epoch 4/8
---------------
train Loss: 0.1432
train Accuracy:0.949 Precision:0.937 Recall:0.950 F1:0.943 MCC:0.898.
val Loss: 0.4508
val Accuracy:0.863 Precision:0.824 Recall:0.880 F1:0.851 MCC:0.726.
 
Epoch 5/8
---------------
train Loss: 0.1038
train Accuracy:0.964 Precision:0.954 Recall:0.964 F1:0.959 MCC:0.927.
val Loss: 0.6426
val Accuracy:0.832 Precision:0.766 Recall:0.896 F1:0.826 MCC:0.673.
 
Epoch 6/8
---------------
train Loss: 0.0835
train Accuracy:0.972 Precision:0.964 Recall:0.972 F1:0.968 MCC:0.943.
val Loss: 0.4566
val Accuracy:0.883 Precision:0.873 Recall:0.863 F1:0.868 MCC:0.763.
 
Epoch 7/8
---------------
train Loss: 0.0699
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.5413
val Accuracy:0.865 Precision:0.838 Recall:0.862 F1:0.850 MCC:0.727.
 
Epoch 8/8
---------------
train Loss: 0.0638
train Accuracy:0.979 Precision:0.973 Recall:0.979 F1:0.976 MCC:0.957.
val Loss: 0.4901
val Accuracy:0.883 Precision:0.883 Recall:0.848 F1:0.865 MCC:0.762.
Training complete in 230m 57s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/nucleotide/fold_1', '../../bionoi_output/hydrophobicity/nucleotide/fold_2', '../../bionoi_output/hydrophobicity/nucleotide/fold_4', '../../bionoi_output/hydrophobicity/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4436
train Accuracy:0.817 Precision:0.778 Recall:0.822 F1:0.799 MCC:0.632.
val Loss: 0.3664
val Accuracy:0.857 Precision:0.785 Recall:0.934 F1:0.853 MCC:0.726.
 
Epoch 2/8
---------------
train Loss: 0.3067
train Accuracy:0.883 Precision:0.858 Recall:0.884 F1:0.870 MCC:0.764.
val Loss: 0.3809
val Accuracy:0.854 Precision:0.814 Recall:0.870 F1:0.841 MCC:0.707.
 
Epoch 3/8
---------------
train Loss: 0.2106
train Accuracy:0.923 Precision:0.906 Recall:0.922 F1:0.914 MCC:0.844.
val Loss: 0.4129
val Accuracy:0.854 Precision:0.780 Recall:0.935 F1:0.850 MCC:0.721.
 
Epoch 4/8
---------------
train Loss: 0.1420
train Accuracy:0.950 Precision:0.939 Recall:0.950 F1:0.944 MCC:0.899.
val Loss: 0.4419
val Accuracy:0.856 Precision:0.824 Recall:0.860 F1:0.842 MCC:0.711.
 
Epoch 5/8
---------------
train Loss: 0.1055
train Accuracy:0.964 Precision:0.955 Recall:0.964 F1:0.959 MCC:0.927.
val Loss: 0.5204
val Accuracy:0.859 Precision:0.868 Recall:0.804 F1:0.835 MCC:0.714.
 
Epoch 6/8
---------------
train Loss: 0.0867
train Accuracy:0.971 Precision:0.963 Recall:0.970 F1:0.967 MCC:0.940.
val Loss: 1.0229
val Accuracy:0.772 Precision:0.879 Recall:0.564 F1:0.687 MCC:0.552.
 
Epoch 7/8
---------------
train Loss: 0.0732
train Accuracy:0.975 Precision:0.970 Recall:0.975 F1:0.972 MCC:0.950.
val Loss: 0.5986
val Accuracy:0.849 Precision:0.793 Recall:0.893 F1:0.840 MCC:0.702.
 
Epoch 8/8
---------------
train Loss: 0.0657
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.976 MCC:0.956.
val Loss: 0.5346
val Accuracy:0.868 Precision:0.882 Recall:0.810 F1:0.845 MCC:0.732.
Training complete in 231m 10s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/nucleotide/fold_1', '../../bionoi_output/hydrophobicity/nucleotide/fold_2', '../../bionoi_output/hydrophobicity/nucleotide/fold_3', '../../bionoi_output/hydrophobicity/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4349
train Accuracy:0.823 Precision:0.785 Recall:0.829 F1:0.806 MCC:0.645.
val Loss: 0.4043
val Accuracy:0.835 Precision:0.790 Recall:0.856 F1:0.822 MCC:0.671.
 
Epoch 2/8
---------------
train Loss: 0.2924
train Accuracy:0.889 Precision:0.865 Recall:0.888 F1:0.877 MCC:0.776.
val Loss: 0.4595
val Accuracy:0.824 Precision:0.779 Recall:0.843 F1:0.810 MCC:0.649.
 
Epoch 3/8
---------------
train Loss: 0.2031
train Accuracy:0.927 Precision:0.911 Recall:0.926 F1:0.918 MCC:0.852.
val Loss: 0.4241
val Accuracy:0.846 Precision:0.811 Recall:0.851 F1:0.831 MCC:0.691.
 
Epoch 4/8
---------------
train Loss: 0.1401
train Accuracy:0.951 Precision:0.940 Recall:0.951 F1:0.945 MCC:0.901.
val Loss: 0.5381
val Accuracy:0.838 Precision:0.831 Recall:0.796 F1:0.813 MCC:0.670.
 
Epoch 5/8
---------------
train Loss: 0.1041
train Accuracy:0.964 Precision:0.956 Recall:0.964 F1:0.960 MCC:0.928.
val Loss: 0.6380
val Accuracy:0.845 Precision:0.887 Recall:0.746 F1:0.810 MCC:0.689.
 
Epoch 6/8
---------------
train Loss: 0.0853
train Accuracy:0.971 Precision:0.963 Recall:0.971 F1:0.967 MCC:0.941.
val Loss: 0.8954
val Accuracy:0.811 Precision:0.902 Recall:0.643 F1:0.751 MCC:0.627.
 
Epoch 7/8
---------------
train Loss: 0.0737
train Accuracy:0.975 Precision:0.969 Recall:0.975 F1:0.972 MCC:0.950.
val Loss: 0.6167
val Accuracy:0.850 Precision:0.861 Recall:0.789 F1:0.823 MCC:0.695.
 
Epoch 8/8
---------------
train Loss: 0.0639
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.976 MCC:0.957.
val Loss: 0.6582
val Accuracy:0.857 Precision:0.857 Recall:0.813 F1:0.835 MCC:0.710.
Training complete in 230m 54s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/nucleotide/fold_1', '../../bionoi_output/hydrophobicity/nucleotide/fold_2', '../../bionoi_output/hydrophobicity/nucleotide/fold_3', '../../bionoi_output/hydrophobicity/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4172
train Accuracy:0.831 Precision:0.795 Recall:0.833 F1:0.814 MCC:0.659.
val Loss: 0.4816
val Accuracy:0.808 Precision:0.799 Recall:0.758 F1:0.778 MCC:0.610.
 
Epoch 2/8
---------------
train Loss: 0.2807
train Accuracy:0.895 Precision:0.872 Recall:0.893 F1:0.883 MCC:0.787.
val Loss: 0.4664
val Accuracy:0.831 Precision:0.778 Recall:0.867 F1:0.820 MCC:0.665.
 
Epoch 3/8
---------------
train Loss: 0.1944
train Accuracy:0.930 Precision:0.914 Recall:0.929 F1:0.922 MCC:0.858.
val Loss: 0.4815
val Accuracy:0.835 Precision:0.808 Recall:0.825 F1:0.816 MCC:0.667.
 
Epoch 4/8
---------------
train Loss: 0.1363
train Accuracy:0.953 Precision:0.942 Recall:0.951 F1:0.947 MCC:0.904.
val Loss: 0.5954
val Accuracy:0.835 Precision:0.825 Recall:0.797 F1:0.811 MCC:0.665.
 
Epoch 5/8
---------------
train Loss: 0.1009
train Accuracy:0.966 Precision:0.958 Recall:0.965 F1:0.961 MCC:0.930.
val Loss: 0.7724
val Accuracy:0.822 Precision:0.863 Recall:0.711 F1:0.779 MCC:0.640.
 
Epoch 6/8
---------------
train Loss: 0.0834
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.7282
val Accuracy:0.826 Precision:0.830 Recall:0.763 F1:0.795 MCC:0.646.
 
Epoch 7/8
---------------
train Loss: 0.0708
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.6762
val Accuracy:0.834 Precision:0.821 Recall:0.802 F1:0.811 MCC:0.664.
 
Epoch 8/8
---------------
train Loss: 0.0630
train Accuracy:0.979 Precision:0.973 Recall:0.979 F1:0.976 MCC:0.957.
val Loss: 0.9282
val Accuracy:0.816 Precision:0.836 Recall:0.729 F1:0.779 MCC:0.627.
Training complete in 230m 52s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4141405638107163, 'acc': 0.8368996671421779, 'precision': 0.810894480305625, 'recall': 0.8246918542336549, 'mcc': 0.6702496525037576}, {'loss': 0.36549410371198543, 'acc': 0.8764880952380952, 'precision': 0.8704289249381358, 'recall': 0.8482717041800643, 'mcc': 0.7494281089426166}, {'loss': 0.3664099278407437, 'acc': 0.8567857142857143, 'precision': 0.7847011144883486, 'recall': 0.9338826366559485, 'mcc': 0.7256910259214269}, {'loss': 0.40425133803201163, 'acc': 0.8353600381497377, 'precision': 0.7904147007698038, 'recall': 0.8556451612903225, 'mcc': 0.6710480898343261}, {'loss': 0.4664426238183243, 'acc': 0.8311278016213639, 'precision': 0.7778984195922307, 'recall': 0.8666666666666667, 'mcc': 0.6652299440077614}]
Averge metrics over 5 folds:
average loss:  0.4033477114427563
average accuracy:  0.8473322632874177
average precision:  0.8068675280188288
average recall:  0.8658316046053314
average mcc:  0.6963293642419777
cross-validation finished, end of program
