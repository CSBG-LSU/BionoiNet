data directory: ../../bionoi_output/charge/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/nucleotide/fold_2', '../../bionoi_output/charge/nucleotide/fold_3', '../../bionoi_output/charge/nucleotide/fold_4', '../../bionoi_output/charge/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4730
train Accuracy:0.801 Precision:0.759 Recall:0.811 F1:0.784 MCC:0.602.
val Loss: 0.5010
val Accuracy:0.801 Precision:0.812 Recall:0.719 F1:0.763 MCC:0.596.
 
Epoch 2/8
---------------
train Loss: 0.2975
train Accuracy:0.887 Precision:0.866 Recall:0.883 F1:0.874 MCC:0.772.
val Loss: 0.4667
val Accuracy:0.815 Precision:0.780 Recall:0.811 F1:0.795 MCC:0.627.
 
Epoch 3/8
---------------
train Loss: 0.1950
train Accuracy:0.930 Precision:0.916 Recall:0.926 F1:0.921 MCC:0.858.
val Loss: 0.5737
val Accuracy:0.814 Precision:0.795 Recall:0.783 F1:0.789 MCC:0.623.
 
Epoch 4/8
---------------
train Loss: 0.1338
train Accuracy:0.953 Precision:0.944 Recall:0.952 F1:0.948 MCC:0.906.
val Loss: 0.6943
val Accuracy:0.802 Precision:0.824 Recall:0.705 F1:0.760 MCC:0.599.
 
Epoch 5/8
---------------
train Loss: 0.1009
train Accuracy:0.966 Precision:0.959 Recall:0.965 F1:0.962 MCC:0.931.
val Loss: 0.5897
val Accuracy:0.829 Precision:0.814 Recall:0.799 F1:0.806 MCC:0.654.
 
Epoch 6/8
---------------
train Loss: 0.0851
train Accuracy:0.971 Precision:0.965 Recall:0.970 F1:0.968 MCC:0.942.
val Loss: 0.7171
val Accuracy:0.831 Precision:0.838 Recall:0.766 F1:0.800 MCC:0.656.
 
Epoch 7/8
---------------
train Loss: 0.0729
train Accuracy:0.976 Precision:0.970 Recall:0.975 F1:0.973 MCC:0.951.
val Loss: 0.7771
val Accuracy:0.823 Precision:0.852 Recall:0.726 F1:0.784 MCC:0.641.
 
Epoch 8/8
---------------
train Loss: 0.0665
train Accuracy:0.978 Precision:0.974 Recall:0.977 F1:0.975 MCC:0.956.
val Loss: 0.8005
val Accuracy:0.816 Precision:0.828 Recall:0.740 F1:0.782 MCC:0.627.
Training complete in 231m 3s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/nucleotide/fold_1', '../../bionoi_output/charge/nucleotide/fold_3', '../../bionoi_output/charge/nucleotide/fold_4', '../../bionoi_output/charge/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4998
train Accuracy:0.785 Precision:0.737 Recall:0.802 F1:0.768 MCC:0.571.
val Loss: 0.4176
val Accuracy:0.832 Precision:0.782 Recall:0.862 F1:0.820 MCC:0.666.
 
Epoch 2/8
---------------
train Loss: 0.3229
train Accuracy:0.875 Precision:0.846 Recall:0.877 F1:0.861 MCC:0.748.
val Loss: 0.3954
val Accuracy:0.855 Precision:0.829 Recall:0.850 F1:0.839 MCC:0.708.
 
Epoch 3/8
---------------
train Loss: 0.2119
train Accuracy:0.922 Precision:0.903 Recall:0.923 F1:0.913 MCC:0.842.
val Loss: 1.0041
val Accuracy:0.747 Precision:0.900 Recall:0.484 F1:0.629 MCC:0.514.
 
Epoch 4/8
---------------
train Loss: 0.1447
train Accuracy:0.949 Precision:0.937 Recall:0.948 F1:0.942 MCC:0.896.
val Loss: 0.6530
val Accuracy:0.803 Precision:0.715 Recall:0.926 F1:0.807 MCC:0.634.
 
Epoch 5/8
---------------
train Loss: 0.1104
train Accuracy:0.961 Precision:0.951 Recall:0.961 F1:0.956 MCC:0.921.
val Loss: 0.4886
val Accuracy:0.857 Precision:0.817 Recall:0.874 F1:0.845 MCC:0.715.
 
Epoch 6/8
---------------
train Loss: 0.0905
train Accuracy:0.969 Precision:0.962 Recall:0.970 F1:0.966 MCC:0.938.
val Loss: 0.8303
val Accuracy:0.816 Precision:0.872 Recall:0.686 F1:0.768 MCC:0.631.
 
Epoch 7/8
---------------
train Loss: 0.0795
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.6558
val Accuracy:0.843 Precision:0.887 Recall:0.740 F1:0.807 MCC:0.684.
 
Epoch 8/8
---------------
train Loss: 0.0715
train Accuracy:0.976 Precision:0.970 Recall:0.976 F1:0.973 MCC:0.951.
val Loss: 0.5759
val Accuracy:0.856 Precision:0.806 Recall:0.889 F1:0.846 MCC:0.714.
Training complete in 231m 9s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/nucleotide/fold_1', '../../bionoi_output/charge/nucleotide/fold_2', '../../bionoi_output/charge/nucleotide/fold_4', '../../bionoi_output/charge/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4963
train Accuracy:0.788 Precision:0.744 Recall:0.796 F1:0.769 MCC:0.574.
val Loss: 0.5248
val Accuracy:0.790 Precision:0.693 Recall:0.947 F1:0.800 MCC:0.622.
 
Epoch 2/8
---------------
train Loss: 0.3202
train Accuracy:0.876 Precision:0.851 Recall:0.874 F1:0.863 MCC:0.751.
val Loss: 0.5198
val Accuracy:0.809 Precision:0.773 Recall:0.807 F1:0.789 MCC:0.615.
 
Epoch 3/8
---------------
train Loss: 0.2127
train Accuracy:0.923 Precision:0.906 Recall:0.921 F1:0.914 MCC:0.844.
val Loss: 0.6144
val Accuracy:0.791 Precision:0.694 Recall:0.947 F1:0.801 MCC:0.624.
 
Epoch 4/8
---------------
train Loss: 0.1507
train Accuracy:0.947 Precision:0.935 Recall:0.946 F1:0.940 MCC:0.892.
val Loss: 0.4636
val Accuracy:0.852 Precision:0.857 Recall:0.800 F1:0.827 MCC:0.699.
 
Epoch 5/8
---------------
train Loss: 0.1158
train Accuracy:0.960 Precision:0.951 Recall:0.959 F1:0.955 MCC:0.919.
val Loss: 0.4922
val Accuracy:0.848 Precision:0.808 Recall:0.864 F1:0.835 MCC:0.696.
 
Epoch 6/8
---------------
train Loss: 0.0933
train Accuracy:0.968 Precision:0.960 Recall:0.969 F1:0.964 MCC:0.936.
val Loss: 0.5380
val Accuracy:0.853 Precision:0.815 Recall:0.866 F1:0.840 MCC:0.705.
 
Epoch 7/8
---------------
train Loss: 0.0836
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.5749
val Accuracy:0.856 Precision:0.855 Recall:0.815 F1:0.834 MCC:0.708.
 
Epoch 8/8
---------------
train Loss: 0.0727
train Accuracy:0.975 Precision:0.970 Recall:0.975 F1:0.972 MCC:0.950.
val Loss: 0.7136
val Accuracy:0.834 Precision:0.900 Recall:0.705 F1:0.791 MCC:0.670.
Training complete in 231m 15s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/nucleotide/fold_1', '../../bionoi_output/charge/nucleotide/fold_2', '../../bionoi_output/charge/nucleotide/fold_3', '../../bionoi_output/charge/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4878
train Accuracy:0.793 Precision:0.750 Recall:0.801 F1:0.775 MCC:0.585.
val Loss: 0.4884
val Accuracy:0.788 Precision:0.738 Recall:0.808 F1:0.771 MCC:0.576.
 
Epoch 2/8
---------------
train Loss: 0.3154
train Accuracy:0.880 Precision:0.856 Recall:0.877 F1:0.866 MCC:0.757.
val Loss: 0.4794
val Accuracy:0.809 Precision:0.790 Recall:0.775 F1:0.782 MCC:0.612.
 
Epoch 3/8
---------------
train Loss: 0.2074
train Accuracy:0.925 Precision:0.909 Recall:0.922 F1:0.916 MCC:0.848.
val Loss: 0.5678
val Accuracy:0.814 Precision:0.817 Recall:0.747 F1:0.781 MCC:0.621.
 
Epoch 4/8
---------------
train Loss: 0.1370
train Accuracy:0.952 Precision:0.942 Recall:0.951 F1:0.947 MCC:0.904.
val Loss: 0.7513
val Accuracy:0.796 Precision:0.829 Recall:0.681 F1:0.748 MCC:0.588.
 
Epoch 5/8
---------------
train Loss: 0.1059
train Accuracy:0.964 Precision:0.956 Recall:0.963 F1:0.959 MCC:0.927.
val Loss: 0.9610
val Accuracy:0.773 Precision:0.906 Recall:0.546 F1:0.681 MCC:0.562.
 
Epoch 6/8
---------------
train Loss: 0.0873
train Accuracy:0.970 Precision:0.963 Recall:0.970 F1:0.966 MCC:0.940.
val Loss: 0.8986
val Accuracy:0.796 Precision:0.887 Recall:0.618 F1:0.729 MCC:0.597.
 
Epoch 7/8
---------------
train Loss: 0.0752
train Accuracy:0.975 Precision:0.969 Recall:0.974 F1:0.972 MCC:0.949.
val Loss: 0.7048
val Accuracy:0.827 Precision:0.865 Recall:0.723 F1:0.788 MCC:0.651.
 
Epoch 8/8
---------------
train Loss: 0.0673
train Accuracy:0.977 Precision:0.972 Recall:0.977 F1:0.975 MCC:0.954.
val Loss: 0.6122
val Accuracy:0.837 Precision:0.827 Recall:0.800 F1:0.813 MCC:0.669.
Training complete in 231m 1s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_1', '../../bionoi_output/charge/control/fold_2', '../../bionoi_output/charge/control/fold_3', '../../bionoi_output/charge/control/fold_4', '../../bionoi_output/charge/nucleotide/fold_1', '../../bionoi_output/charge/nucleotide/fold_2', '../../bionoi_output/charge/nucleotide/fold_3', '../../bionoi_output/charge/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/charge/control/fold_5', '../../bionoi_output/charge/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4750
train Accuracy:0.798 Precision:0.752 Recall:0.813 F1:0.781 MCC:0.596.
val Loss: 0.5808
val Accuracy:0.782 Precision:0.782 Recall:0.706 F1:0.742 MCC:0.557.
 
Epoch 2/8
---------------
train Loss: 0.2940
train Accuracy:0.887 Precision:0.862 Recall:0.886 F1:0.874 MCC:0.771.
val Loss: 0.5822
val Accuracy:0.807 Precision:0.812 Recall:0.735 F1:0.771 MCC:0.607.
 
Epoch 3/8
---------------
train Loss: 0.1943
train Accuracy:0.929 Precision:0.914 Recall:0.928 F1:0.921 MCC:0.857.
val Loss: 0.6045
val Accuracy:0.787 Precision:0.718 Recall:0.855 F1:0.781 MCC:0.585.
 
Epoch 4/8
---------------
train Loss: 0.1341
train Accuracy:0.953 Precision:0.942 Recall:0.952 F1:0.947 MCC:0.905.
val Loss: 0.7237
val Accuracy:0.817 Precision:0.833 Recall:0.734 F1:0.780 MCC:0.628.
 
Epoch 5/8
---------------
train Loss: 0.1012
train Accuracy:0.965 Precision:0.956 Recall:0.966 F1:0.961 MCC:0.929.
val Loss: 0.8227
val Accuracy:0.796 Precision:0.822 Recall:0.690 F1:0.750 MCC:0.587.
 
Epoch 6/8
---------------
train Loss: 0.0847
train Accuracy:0.971 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.7216
val Accuracy:0.812 Precision:0.813 Recall:0.749 F1:0.780 MCC:0.618.
 
Epoch 7/8
---------------
train Loss: 0.0733
train Accuracy:0.975 Precision:0.969 Recall:0.975 F1:0.972 MCC:0.950.
val Loss: 0.7667
val Accuracy:0.814 Precision:0.797 Recall:0.780 F1:0.789 MCC:0.623.
 
Epoch 8/8
---------------
train Loss: 0.0661
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.954.
val Loss: 0.7869
val Accuracy:0.818 Precision:0.794 Recall:0.796 F1:0.795 MCC:0.631.
Training complete in 230m 60s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4667316566208573, 'acc': 0.814877555872563, 'precision': 0.7804862320242472, 'recall': 0.8107583065380493, 'mcc': 0.6268377155772378}, {'loss': 0.39540605560654685, 'acc': 0.855297619047619, 'precision': 0.8287393860222078, 'recall': 0.84994640943194, 'mcc': 0.7078932976713842}, {'loss': 0.46360134784309637, 'acc': 0.8516666666666667, 'precision': 0.8567226287846176, 'recall': 0.799906216505895, 'mcc': 0.6988548093487729}, {'loss': 0.4794441048849976, 'acc': 0.8088042441583214, 'precision': 0.790076074292372, 'recall': 0.774731182795699, 'mcc': 0.6119890735310255}, {'loss': 0.5808174373723236, 'acc': 0.782397472579876, 'precision': 0.7819778257310812, 'recall': 0.70625, 'mcc': 0.5569404124502962}]
Averge metrics over 5 folds:
average loss:  0.4772001204655643
average accuracy:  0.8226087116650092
average precision:  0.8076004293709051
average recall:  0.7883184230543167
average mcc:  0.6405030617157432
cross-validation finished, end of program
