data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3708
train Accuracy:0.855 Precision:0.828 Recall:0.851 F1:0.839 MCC:0.708.
val Loss: 0.4352
val Accuracy:0.835 Precision:0.821 Recall:0.804 F1:0.812 MCC:0.665.
 
Epoch 2/8
---------------
train Loss: 0.2453
train Accuracy:0.911 Precision:0.894 Recall:0.905 F1:0.900 MCC:0.819.
val Loss: 0.4323
val Accuracy:0.851 Precision:0.848 Recall:0.809 F1:0.828 MCC:0.697.
 
Epoch 3/8
---------------
train Loss: 0.1587
train Accuracy:0.943 Precision:0.932 Recall:0.941 F1:0.936 MCC:0.885.
val Loss: 0.4628
val Accuracy:0.854 Precision:0.832 Recall:0.841 F1:0.837 MCC:0.705.
 
Epoch 4/8
---------------
train Loss: 0.1063
train Accuracy:0.963 Precision:0.956 Recall:0.962 F1:0.959 MCC:0.926.
val Loss: 0.5443
val Accuracy:0.855 Precision:0.871 Recall:0.789 F1:0.828 MCC:0.705.
 
Epoch 5/8
---------------
train Loss: 0.0821
train Accuracy:0.972 Precision:0.967 Recall:0.971 F1:0.969 MCC:0.944.
val Loss: 0.5441
val Accuracy:0.857 Precision:0.855 Recall:0.816 F1:0.835 MCC:0.710.
 
Epoch 6/8
---------------
train Loss: 0.0689
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.6178
val Accuracy:0.855 Precision:0.867 Recall:0.795 F1:0.830 MCC:0.706.
 
Epoch 7/8
---------------
train Loss: 0.0592
train Accuracy:0.981 Precision:0.977 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.6363
val Accuracy:0.858 Precision:0.845 Recall:0.831 F1:0.838 MCC:0.711.
 
Epoch 8/8
---------------
train Loss: 0.0537
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6413
val Accuracy:0.856 Precision:0.856 Recall:0.812 F1:0.833 MCC:0.707.
Training complete in 230m 36s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3817
train Accuracy:0.848 Precision:0.818 Recall:0.846 F1:0.832 MCC:0.694.
val Loss: 0.3793
val Accuracy:0.846 Precision:0.788 Recall:0.894 F1:0.838 MCC:0.698.
 
Epoch 2/8
---------------
train Loss: 0.2482
train Accuracy:0.908 Precision:0.887 Recall:0.907 F1:0.897 MCC:0.814.
val Loss: 0.3937
val Accuracy:0.876 Precision:0.902 Recall:0.809 F1:0.853 MCC:0.750.
 
Epoch 3/8
---------------
train Loss: 0.1591
train Accuracy:0.944 Precision:0.931 Recall:0.944 F1:0.937 MCC:0.886.
val Loss: 0.3830
val Accuracy:0.880 Precision:0.856 Recall:0.878 F1:0.867 MCC:0.758.
 
Epoch 4/8
---------------
train Loss: 0.1105
train Accuracy:0.962 Precision:0.953 Recall:0.962 F1:0.957 MCC:0.923.
val Loss: 0.4695
val Accuracy:0.864 Precision:0.808 Recall:0.909 F1:0.856 MCC:0.732.
 
Epoch 5/8
---------------
train Loss: 0.0836
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.4587
val Accuracy:0.886 Precision:0.859 Recall:0.891 F1:0.875 MCC:0.771.
 
Epoch 6/8
---------------
train Loss: 0.0684
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.954.
val Loss: 0.6335
val Accuracy:0.860 Precision:0.824 Recall:0.871 F1:0.847 MCC:0.719.
 
Epoch 7/8
---------------
train Loss: 0.0605
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.5474
val Accuracy:0.867 Precision:0.850 Recall:0.849 F1:0.850 MCC:0.730.
 
Epoch 8/8
---------------
train Loss: 0.0547
train Accuracy:0.982 Precision:0.977 Recall:0.982 F1:0.980 MCC:0.963.
val Loss: 0.5299
val Accuracy:0.884 Precision:0.887 Recall:0.847 F1:0.866 MCC:0.764.
Training complete in 230m 50s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3848
train Accuracy:0.848 Precision:0.818 Recall:0.845 F1:0.832 MCC:0.693.
val Loss: 0.3731
val Accuracy:0.854 Precision:0.839 Recall:0.832 F1:0.835 MCC:0.705.
 
Epoch 2/8
---------------
train Loss: 0.2543
train Accuracy:0.906 Precision:0.888 Recall:0.903 F1:0.895 MCC:0.811.
val Loss: 0.3930
val Accuracy:0.853 Precision:0.783 Recall:0.927 F1:0.849 MCC:0.718.
 
Epoch 3/8
---------------
train Loss: 0.1653
train Accuracy:0.942 Precision:0.929 Recall:0.941 F1:0.935 MCC:0.882.
val Loss: 0.3386
val Accuracy:0.883 Precision:0.846 Recall:0.900 F1:0.872 MCC:0.765.
 
Epoch 4/8
---------------
train Loss: 0.1111
train Accuracy:0.961 Precision:0.953 Recall:0.961 F1:0.957 MCC:0.922.
val Loss: 0.5774
val Accuracy:0.846 Precision:0.773 Recall:0.924 F1:0.842 MCC:0.704.
 
Epoch 5/8
---------------
train Loss: 0.0829
train Accuracy:0.972 Precision:0.965 Recall:0.972 F1:0.968 MCC:0.943.
val Loss: 0.4429
val Accuracy:0.876 Precision:0.849 Recall:0.877 F1:0.863 MCC:0.751.
 
Epoch 6/8
---------------
train Loss: 0.0694
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.8713
val Accuracy:0.829 Precision:0.908 Recall:0.684 F1:0.780 MCC:0.662.
 
Epoch 7/8
---------------
train Loss: 0.0609
train Accuracy:0.980 Precision:0.975 Recall:0.979 F1:0.977 MCC:0.959.
val Loss: 0.4856
val Accuracy:0.872 Precision:0.829 Recall:0.897 F1:0.861 MCC:0.744.
 
Epoch 8/8
---------------
train Loss: 0.0537
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.4964
val Accuracy:0.883 Precision:0.879 Recall:0.854 F1:0.867 MCC:0.763.
Training complete in 231m 1s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3651
train Accuracy:0.856 Precision:0.828 Recall:0.855 F1:0.841 MCC:0.710.
val Loss: 0.4141
val Accuracy:0.832 Precision:0.776 Recall:0.873 F1:0.822 MCC:0.668.
 
Epoch 2/8
---------------
train Loss: 0.2281
train Accuracy:0.917 Precision:0.902 Recall:0.913 F1:0.907 MCC:0.833.
val Loss: 0.5665
val Accuracy:0.824 Precision:0.911 Recall:0.669 F1:0.771 MCC:0.654.
 
Epoch 3/8
---------------
train Loss: 0.1468
train Accuracy:0.948 Precision:0.938 Recall:0.946 F1:0.942 MCC:0.895.
val Loss: 0.4904
val Accuracy:0.845 Precision:0.852 Recall:0.787 F1:0.819 MCC:0.686.
 
Epoch 4/8
---------------
train Loss: 0.1002
train Accuracy:0.966 Precision:0.958 Recall:0.965 F1:0.962 MCC:0.931.
val Loss: 0.5580
val Accuracy:0.852 Precision:0.848 Recall:0.811 F1:0.829 MCC:0.699.
 
Epoch 5/8
---------------
train Loss: 0.0790
train Accuracy:0.973 Precision:0.967 Recall:0.972 F1:0.970 MCC:0.945.
val Loss: 0.5987
val Accuracy:0.853 Precision:0.872 Recall:0.784 F1:0.826 MCC:0.703.
 
Epoch 6/8
---------------
train Loss: 0.0665
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.975 MCC:0.956.
val Loss: 0.8399
val Accuracy:0.826 Precision:0.923 Recall:0.664 F1:0.772 MCC:0.660.
 
Epoch 7/8
---------------
train Loss: 0.0574
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.5480
val Accuracy:0.864 Precision:0.857 Recall:0.831 F1:0.844 MCC:0.723.
 
Epoch 8/8
---------------
train Loss: 0.0513
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.6983
val Accuracy:0.853 Precision:0.879 Recall:0.776 F1:0.824 MCC:0.703.
Training complete in 231m 13s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3574
train Accuracy:0.860 Precision:0.833 Recall:0.857 F1:0.845 MCC:0.718.
val Loss: 0.4641
val Accuracy:0.832 Precision:0.823 Recall:0.792 F1:0.807 MCC:0.659.
 
Epoch 2/8
---------------
train Loss: 0.2255
train Accuracy:0.917 Precision:0.899 Recall:0.915 F1:0.907 MCC:0.832.
val Loss: 0.5830
val Accuracy:0.831 Precision:0.824 Recall:0.788 F1:0.805 MCC:0.657.
 
Epoch 3/8
---------------
train Loss: 0.1445
train Accuracy:0.950 Precision:0.938 Recall:0.949 F1:0.944 MCC:0.898.
val Loss: 0.6876
val Accuracy:0.821 Precision:0.744 Recall:0.910 F1:0.818 MCC:0.658.
 
Epoch 4/8
---------------
train Loss: 0.1005
train Accuracy:0.965 Precision:0.958 Recall:0.965 F1:0.961 MCC:0.930.
val Loss: 0.6094
val Accuracy:0.843 Precision:0.814 Recall:0.838 F1:0.826 MCC:0.683.
 
Epoch 5/8
---------------
train Loss: 0.0793
train Accuracy:0.974 Precision:0.968 Recall:0.974 F1:0.971 MCC:0.947.
val Loss: 0.6376
val Accuracy:0.844 Precision:0.809 Recall:0.847 F1:0.828 MCC:0.685.
 
Epoch 6/8
---------------
train Loss: 0.0653
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.7182
val Accuracy:0.842 Precision:0.821 Recall:0.822 F1:0.822 MCC:0.679.
 
Epoch 7/8
---------------
train Loss: 0.0569
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.6766
val Accuracy:0.852 Precision:0.819 Recall:0.855 F1:0.836 MCC:0.701.
 
Epoch 8/8
---------------
train Loss: 0.0521
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.6633
val Accuracy:0.852 Precision:0.842 Recall:0.822 F1:0.832 MCC:0.700.
Training complete in 231m 54s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.43231496708029177, 'acc': 0.8506894912030433, 'precision': 0.847557551937114, 'recall': 0.8089496248660236, 'mcc': 0.6967251870368298}, {'loss': 0.37927687153220174, 'acc': 0.8464285714285714, 'precision': 0.7883457314913213, 'recall': 0.8944935691318328, 'mcc': 0.6981435833371487}, {'loss': 0.33859459613050735, 'acc': 0.8826488095238095, 'precision': 0.8458535356715572, 'recall': 0.899852625937835, 'mcc': 0.7651054016396329}, {'loss': 0.41411358630395695, 'acc': 0.8320219360991893, 'precision': 0.7762041352934146, 'recall': 0.8729166666666667, 'mcc': 0.6680432398277039}, {'loss': 0.4640752484628457, 'acc': 0.8321113495469719, 'precision': 0.8225322636902686, 'recall': 0.7924059139784946, 'mcc': 0.6589681368230286}]
Averge metrics over 5 folds:
average loss:  0.4056750539019607
average accuracy:  0.848780031560317
average precision:  0.8160986436167352
average recall:  0.8537236801161706
average mcc:  0.6973971097328688
cross-validation finished, end of program
