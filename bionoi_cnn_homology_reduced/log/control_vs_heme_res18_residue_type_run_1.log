data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3767
train Accuracy:0.905 Precision:0.745 Recall:0.905 F1:0.817 MCC:0.760.
val Loss: 0.7611
val Accuracy:0.864 Precision:0.694 Recall:0.758 F1:0.725 MCC:0.636.
 
Epoch 2/8
---------------
train Loss: 0.2395
train Accuracy:0.942 Precision:0.832 Recall:0.940 F1:0.883 MCC:0.847.
val Loss: 0.8184
val Accuracy:0.874 Precision:0.747 Recall:0.702 F1:0.724 MCC:0.643.
 
Epoch 3/8
---------------
train Loss: 0.1571
train Accuracy:0.962 Precision:0.886 Recall:0.962 F1:0.922 MCC:0.899.
val Loss: 0.7964
val Accuracy:0.887 Precision:0.756 Recall:0.767 F1:0.761 MCC:0.687.
 
Epoch 4/8
---------------
train Loss: 0.1105
train Accuracy:0.973 Precision:0.916 Recall:0.974 F1:0.944 MCC:0.927.
val Loss: 1.1144
val Accuracy:0.878 Precision:0.735 Recall:0.752 F1:0.744 MCC:0.664.
 
Epoch 5/8
---------------
train Loss: 0.0857
train Accuracy:0.979 Precision:0.934 Recall:0.980 F1:0.956 MCC:0.943.
val Loss: 1.3084
val Accuracy:0.885 Precision:0.822 Recall:0.652 F1:0.728 MCC:0.663.
 
Epoch 6/8
---------------
train Loss: 0.0748
train Accuracy:0.982 Precision:0.943 Recall:0.983 F1:0.963 MCC:0.951.
val Loss: 2.0740
val Accuracy:0.876 Precision:0.917 Recall:0.521 F1:0.664 MCC:0.631.
 
Epoch 7/8
---------------
train Loss: 0.0663
train Accuracy:0.984 Precision:0.948 Recall:0.986 F1:0.966 MCC:0.956.
val Loss: 1.2817
val Accuracy:0.895 Precision:0.826 Recall:0.699 F1:0.757 MCC:0.694.
 
Epoch 8/8
---------------
train Loss: 0.0555
train Accuracy:0.987 Precision:0.957 Recall:0.988 F1:0.972 MCC:0.964.
val Loss: 1.3788
val Accuracy:0.891 Precision:0.834 Recall:0.669 F1:0.743 MCC:0.681.
Training complete in 167m 23s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4221
train Accuracy:0.888 Precision:0.711 Recall:0.884 F1:0.788 MCC:0.721.
val Loss: 1.2815
val Accuracy:0.850 Precision:0.941 Recall:0.385 F1:0.546 MCC:0.543.
 
Epoch 2/8
---------------
train Loss: 0.2443
train Accuracy:0.938 Precision:0.824 Recall:0.936 F1:0.877 MCC:0.839.
val Loss: 0.4123
val Accuracy:0.909 Precision:0.747 Recall:0.924 F1:0.826 MCC:0.773.
 
Epoch 3/8
---------------
train Loss: 0.1624
train Accuracy:0.961 Precision:0.883 Recall:0.961 F1:0.920 MCC:0.896.
val Loss: 0.4037
val Accuracy:0.912 Precision:0.769 Recall:0.894 F1:0.827 MCC:0.772.
 
Epoch 4/8
---------------
train Loss: 0.1146
train Accuracy:0.972 Precision:0.914 Recall:0.971 F1:0.942 MCC:0.924.
val Loss: 0.5440
val Accuracy:0.926 Precision:0.827 Recall:0.866 F1:0.846 MCC:0.797.
 
Epoch 5/8
---------------
train Loss: 0.0961
train Accuracy:0.977 Precision:0.930 Recall:0.977 F1:0.953 MCC:0.939.
val Loss: 0.7641
val Accuracy:0.927 Precision:0.921 Recall:0.752 F1:0.828 MCC:0.788.
 
Epoch 6/8
---------------
train Loss: 0.0787
train Accuracy:0.981 Precision:0.942 Recall:0.981 F1:0.961 MCC:0.949.
val Loss: 0.4380
val Accuracy:0.934 Precision:0.822 Recall:0.916 F1:0.867 MCC:0.825.
 
Epoch 7/8
---------------
train Loss: 0.0683
train Accuracy:0.984 Precision:0.949 Recall:0.985 F1:0.966 MCC:0.956.
val Loss: 0.4731
val Accuracy:0.938 Precision:0.863 Recall:0.872 F1:0.868 MCC:0.827.
 
Epoch 8/8
---------------
train Loss: 0.0651
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.968 MCC:0.958.
val Loss: 0.5667
val Accuracy:0.938 Precision:0.877 Recall:0.855 F1:0.866 MCC:0.826.
Training complete in 167m 24s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4345
train Accuracy:0.885 Precision:0.703 Recall:0.883 F1:0.783 MCC:0.715.
val Loss: 0.4824
val Accuracy:0.929 Precision:0.894 Recall:0.789 F1:0.838 MCC:0.795.
 
Epoch 2/8
---------------
train Loss: 0.2610
train Accuracy:0.933 Precision:0.811 Recall:0.931 F1:0.867 MCC:0.826.
val Loss: 0.3562
val Accuracy:0.928 Precision:0.797 Recall:0.930 F1:0.859 MCC:0.815.
 
Epoch 3/8
---------------
train Loss: 0.1710
train Accuracy:0.958 Precision:0.874 Recall:0.958 F1:0.914 MCC:0.887.
val Loss: 0.4065
val Accuracy:0.948 Precision:0.898 Recall:0.878 F1:0.888 MCC:0.854.
 
Epoch 4/8
---------------
train Loss: 0.1255
train Accuracy:0.970 Precision:0.907 Recall:0.970 F1:0.938 MCC:0.919.
val Loss: 0.3944
val Accuracy:0.914 Precision:0.754 Recall:0.939 F1:0.836 MCC:0.787.
 
Epoch 5/8
---------------
train Loss: 0.0941
train Accuracy:0.977 Precision:0.930 Recall:0.978 F1:0.953 MCC:0.939.
val Loss: 0.3452
val Accuracy:0.932 Precision:0.809 Recall:0.929 F1:0.865 MCC:0.823.
 
Epoch 6/8
---------------
train Loss: 0.0798
train Accuracy:0.981 Precision:0.941 Recall:0.982 F1:0.961 MCC:0.949.
val Loss: 0.4433
val Accuracy:0.936 Precision:0.834 Recall:0.908 F1:0.869 MCC:0.828.
 
Epoch 7/8
---------------
train Loss: 0.0711
train Accuracy:0.983 Precision:0.946 Recall:0.984 F1:0.964 MCC:0.954.
val Loss: 0.6158
val Accuracy:0.927 Precision:0.793 Recall:0.932 F1:0.857 MCC:0.813.
 
Epoch 8/8
---------------
train Loss: 0.0651
train Accuracy:0.985 Precision:0.951 Recall:0.985 F1:0.968 MCC:0.958.
val Loss: 0.4347
val Accuracy:0.938 Precision:0.832 Recall:0.923 F1:0.875 MCC:0.836.
Training complete in 167m 16s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4329
train Accuracy:0.887 Precision:0.707 Recall:0.883 F1:0.785 MCC:0.718.
val Loss: 0.2767
val Accuracy:0.935 Precision:0.822 Recall:0.924 F1:0.870 MCC:0.830.
 
Epoch 2/8
---------------
train Loss: 0.2556
train Accuracy:0.934 Precision:0.813 Recall:0.934 F1:0.870 MCC:0.829.
val Loss: 0.4386
val Accuracy:0.936 Precision:0.892 Recall:0.829 F1:0.859 MCC:0.819.
 
Epoch 3/8
---------------
train Loss: 0.1707
train Accuracy:0.957 Precision:0.872 Recall:0.958 F1:0.913 MCC:0.886.
val Loss: 0.3845
val Accuracy:0.893 Precision:0.694 Recall:0.972 F1:0.810 MCC:0.758.
 
Epoch 4/8
---------------
train Loss: 0.1257
train Accuracy:0.970 Precision:0.907 Recall:0.970 F1:0.937 MCC:0.918.
val Loss: 0.3191
val Accuracy:0.936 Precision:0.822 Recall:0.927 F1:0.871 MCC:0.831.
 
Epoch 5/8
---------------
train Loss: 0.0975
train Accuracy:0.976 Precision:0.926 Recall:0.977 F1:0.951 MCC:0.935.
val Loss: 0.4100
val Accuracy:0.914 Precision:0.763 Recall:0.915 F1:0.832 MCC:0.780.
 
Epoch 6/8
---------------
train Loss: 0.0852
train Accuracy:0.980 Precision:0.937 Recall:0.980 F1:0.958 MCC:0.945.
val Loss: 0.5036
val Accuracy:0.912 Precision:0.746 Recall:0.948 F1:0.835 MCC:0.786.
 
Epoch 7/8
---------------
train Loss: 0.0735
train Accuracy:0.983 Precision:0.945 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.4236
val Accuracy:0.950 Precision:0.920 Recall:0.861 F1:0.889 MCC:0.858.
 
Epoch 8/8
---------------
train Loss: 0.0684
train Accuracy:0.984 Precision:0.950 Recall:0.985 F1:0.967 MCC:0.957.
val Loss: 0.5239
val Accuracy:0.896 Precision:0.705 Recall:0.953 F1:0.810 MCC:0.756.
Training complete in 167m 49s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4049
train Accuracy:0.895 Precision:0.726 Recall:0.890 F1:0.800 MCC:0.737.
val Loss: 0.4878
val Accuracy:0.896 Precision:0.761 Recall:0.811 F1:0.785 MCC:0.718.
 
Epoch 2/8
---------------
train Loss: 0.2399
train Accuracy:0.940 Precision:0.826 Recall:0.941 F1:0.880 MCC:0.843.
val Loss: 0.5491
val Accuracy:0.875 Precision:0.691 Recall:0.845 F1:0.760 MCC:0.683.
 
Epoch 3/8
---------------
train Loss: 0.1533
train Accuracy:0.962 Precision:0.887 Recall:0.962 F1:0.923 MCC:0.900.
val Loss: 0.5502
val Accuracy:0.904 Precision:0.779 Recall:0.824 F1:0.801 MCC:0.738.
 
Epoch 4/8
---------------
train Loss: 0.1140
train Accuracy:0.973 Precision:0.915 Recall:0.973 F1:0.943 MCC:0.926.
val Loss: 0.6342
val Accuracy:0.911 Precision:0.792 Recall:0.841 F1:0.815 MCC:0.757.
 
Epoch 5/8
---------------
train Loss: 0.0920
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.7534
val Accuracy:0.911 Precision:0.812 Recall:0.806 F1:0.809 MCC:0.751.
 
Epoch 6/8
---------------
train Loss: 0.0753
train Accuracy:0.982 Precision:0.942 Recall:0.982 F1:0.962 MCC:0.950.
val Loss: 0.6442
val Accuracy:0.915 Precision:0.818 Recall:0.819 F1:0.818 MCC:0.762.
 
Epoch 7/8
---------------
train Loss: 0.0677
train Accuracy:0.984 Precision:0.950 Recall:0.984 F1:0.966 MCC:0.956.
val Loss: 0.7952
val Accuracy:0.916 Precision:0.864 Recall:0.763 F1:0.810 MCC:0.759.
 
Epoch 8/8
---------------
train Loss: 0.0576
train Accuracy:0.987 Precision:0.957 Recall:0.987 F1:0.972 MCC:0.963.
val Loss: 0.8333
val Accuracy:0.923 Precision:0.857 Recall:0.805 F1:0.830 MCC:0.781.
Training complete in 167m 53s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7610567420623661, 'acc': 0.8644199346405229, 'precision': 0.6940690093814597, 'recall': 0.7578125, 'mcc': 0.6359301289823469}, {'loss': 0.40371203665032473, 'acc': 0.912114501312336, 'precision': 0.7686286316423303, 'recall': 0.8939075630252101, 'mcc': 0.7720687828468348}, {'loss': 0.34523425848538597, 'acc': 0.9319635826771654, 'precision': 0.8091533180778032, 'recall': 0.9285714285714286, 'mcc': 0.823060225012553}, {'loss': 0.2766520495763601, 'acc': 0.9353264435695539, 'precision': 0.8217898832684825, 'recall': 0.9243697478991597, 'mcc': 0.8297491558884211}, {'loss': 0.48782580239292517, 'acc': 0.8962024278215223, 'precision': 0.7612945621816987, 'recall': 0.8112745098039216, 'mcc': 0.7177494237692286}]
Averge metrics over 5 folds:
average loss:  0.4548961778334724
average accuracy:  0.9080053780042201
average precision:  0.770987080910355
average recall:  0.8631871498599442
average mcc:  0.7557115432998768
cross-validation finished, end of program
