data directory: ../../bionoi_output/hydrophobicity/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/heme/fold_2', '../../bionoi_output/hydrophobicity/heme/fold_3', '../../bionoi_output/hydrophobicity/heme/fold_4', '../../bionoi_output/hydrophobicity/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4698
train Accuracy:0.873 Precision:0.674 Recall:0.883 F1:0.765 MCC:0.691.
val Loss: 0.8686
val Accuracy:0.866 Precision:0.782 Recall:0.598 F1:0.678 MCC:0.604.
 
Epoch 2/8
---------------
train Loss: 0.2893
train Accuracy:0.929 Precision:0.801 Recall:0.926 F1:0.859 MCC:0.815.
val Loss: 0.7518
val Accuracy:0.873 Precision:0.732 Recall:0.728 F1:0.730 MCC:0.648.
 
Epoch 3/8
---------------
train Loss: 0.1966
train Accuracy:0.953 Precision:0.861 Recall:0.951 F1:0.904 MCC:0.874.
val Loss: 0.8712
val Accuracy:0.884 Precision:0.790 Recall:0.694 F1:0.739 MCC:0.667.
 
Epoch 4/8
---------------
train Loss: 0.1402
train Accuracy:0.966 Precision:0.897 Recall:0.966 F1:0.930 MCC:0.908.
val Loss: 0.9768
val Accuracy:0.858 Precision:0.678 Recall:0.756 F1:0.714 MCC:0.622.
 
Epoch 5/8
---------------
train Loss: 0.1077
train Accuracy:0.974 Precision:0.920 Recall:0.973 F1:0.946 MCC:0.930.
val Loss: 0.8535
val Accuracy:0.888 Precision:0.763 Recall:0.761 F1:0.762 MCC:0.689.
 
Epoch 6/8
---------------
train Loss: 0.0884
train Accuracy:0.979 Precision:0.935 Recall:0.979 F1:0.957 MCC:0.943.
val Loss: 1.3011
val Accuracy:0.884 Precision:0.796 Recall:0.681 F1:0.734 MCC:0.664.
 
Epoch 7/8
---------------
train Loss: 0.0791
train Accuracy:0.981 Precision:0.940 Recall:0.981 F1:0.960 MCC:0.948.
val Loss: 1.1742
val Accuracy:0.879 Precision:0.761 Recall:0.710 F1:0.735 MCC:0.657.
 
Epoch 8/8
---------------
train Loss: 0.0727
train Accuracy:0.982 Precision:0.945 Recall:0.982 F1:0.963 MCC:0.952.
val Loss: 1.0401
val Accuracy:0.853 Precision:0.670 Recall:0.738 F1:0.703 MCC:0.607.
Training complete in 167m 41s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/heme/fold_1', '../../bionoi_output/hydrophobicity/heme/fold_3', '../../bionoi_output/hydrophobicity/heme/fold_4', '../../bionoi_output/hydrophobicity/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5160
train Accuracy:0.852 Precision:0.637 Recall:0.861 F1:0.732 MCC:0.647.
val Loss: 0.7439
val Accuracy:0.870 Precision:0.845 Recall:0.546 F1:0.663 MCC:0.609.
 
Epoch 2/8
---------------
train Loss: 0.3260
train Accuracy:0.913 Precision:0.762 Recall:0.915 F1:0.831 MCC:0.779.
val Loss: 0.5422
val Accuracy:0.880 Precision:0.700 Recall:0.857 F1:0.770 MCC:0.697.
 
Epoch 3/8
---------------
train Loss: 0.2156
train Accuracy:0.944 Precision:0.838 Recall:0.946 F1:0.889 MCC:0.855.
val Loss: 0.5344
val Accuracy:0.923 Precision:0.845 Recall:0.823 F1:0.834 MCC:0.784.
 
Epoch 4/8
---------------
train Loss: 0.1557
train Accuracy:0.961 Precision:0.883 Recall:0.962 F1:0.921 MCC:0.897.
val Loss: 0.7330
val Accuracy:0.907 Precision:0.828 Recall:0.764 F1:0.795 MCC:0.736.
 
Epoch 5/8
---------------
train Loss: 0.1233
train Accuracy:0.969 Precision:0.906 Recall:0.970 F1:0.937 MCC:0.918.
val Loss: 0.7277
val Accuracy:0.913 Precision:0.841 Recall:0.775 F1:0.807 MCC:0.752.
 
Epoch 6/8
---------------
train Loss: 0.1024
train Accuracy:0.975 Precision:0.921 Recall:0.976 F1:0.948 MCC:0.932.
val Loss: 0.4927
val Accuracy:0.918 Precision:0.780 Recall:0.908 F1:0.839 MCC:0.789.
 
Epoch 7/8
---------------
train Loss: 0.0907
train Accuracy:0.978 Precision:0.931 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.7537
val Accuracy:0.872 Precision:0.667 Recall:0.905 F1:0.768 MCC:0.697.
 
Epoch 8/8
---------------
train Loss: 0.0771
train Accuracy:0.981 Precision:0.939 Recall:0.982 F1:0.960 MCC:0.948.
val Loss: 0.7484
val Accuracy:0.913 Precision:0.835 Recall:0.784 F1:0.808 MCC:0.753.
Training complete in 167m 45s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/heme/fold_1', '../../bionoi_output/hydrophobicity/heme/fold_2', '../../bionoi_output/hydrophobicity/heme/fold_4', '../../bionoi_output/hydrophobicity/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5340
train Accuracy:0.847 Precision:0.626 Recall:0.860 F1:0.725 MCC:0.637.
val Loss: 0.3980
val Accuracy:0.872 Precision:0.655 Recall:0.953 F1:0.777 MCC:0.715.
 
Epoch 2/8
---------------
train Loss: 0.3537
train Accuracy:0.906 Precision:0.746 Recall:0.907 F1:0.818 MCC:0.762.
val Loss: 0.4668
val Accuracy:0.922 Precision:0.868 Recall:0.786 F1:0.825 MCC:0.776.
 
Epoch 3/8
---------------
train Loss: 0.2439
train Accuracy:0.937 Precision:0.819 Recall:0.940 F1:0.875 MCC:0.837.
val Loss: 0.4260
val Accuracy:0.935 Precision:0.859 Recall:0.864 F1:0.862 MCC:0.819.
 
Epoch 4/8
---------------
train Loss: 0.1745
train Accuracy:0.956 Precision:0.868 Recall:0.959 F1:0.911 MCC:0.884.
val Loss: 0.3332
val Accuracy:0.919 Precision:0.765 Recall:0.942 F1:0.844 MCC:0.798.
 
Epoch 5/8
---------------
train Loss: 0.1334
train Accuracy:0.967 Precision:0.899 Recall:0.969 F1:0.933 MCC:0.912.
val Loss: 0.4130
val Accuracy:0.926 Precision:0.820 Recall:0.878 F1:0.848 MCC:0.800.
 
Epoch 6/8
---------------
train Loss: 0.1092
train Accuracy:0.973 Precision:0.917 Recall:0.975 F1:0.945 MCC:0.928.
val Loss: 0.4006
val Accuracy:0.941 Precision:0.870 Recall:0.880 F1:0.875 MCC:0.836.
 
Epoch 7/8
---------------
train Loss: 0.0923
train Accuracy:0.978 Precision:0.930 Recall:0.978 F1:0.953 MCC:0.939.
val Loss: 0.4184
val Accuracy:0.950 Precision:0.884 Recall:0.903 F1:0.893 MCC:0.860.
 
Epoch 8/8
---------------
train Loss: 0.0840
train Accuracy:0.980 Precision:0.937 Recall:0.980 F1:0.958 MCC:0.945.
val Loss: 0.3985
val Accuracy:0.922 Precision:0.775 Recall:0.941 F1:0.850 MCC:0.805.
Training complete in 167m 45s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/heme/fold_1', '../../bionoi_output/hydrophobicity/heme/fold_2', '../../bionoi_output/hydrophobicity/heme/fold_3', '../../bionoi_output/hydrophobicity/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5372
train Accuracy:0.847 Precision:0.626 Recall:0.859 F1:0.724 MCC:0.637.
val Loss: 0.7783
val Accuracy:0.853 Precision:0.705 Recall:0.643 F1:0.673 MCC:0.580.
 
Epoch 2/8
---------------
train Loss: 0.3572
train Accuracy:0.904 Precision:0.740 Recall:0.909 F1:0.816 MCC:0.759.
val Loss: 0.7454
val Accuracy:0.907 Precision:0.891 Recall:0.687 F1:0.776 MCC:0.728.
 
Epoch 3/8
---------------
train Loss: 0.2555
train Accuracy:0.934 Precision:0.812 Recall:0.935 F1:0.869 MCC:0.829.
val Loss: 1.7108
val Accuracy:0.611 Precision:0.375 Recall:0.995 F1:0.545 MCC:0.426.
 
Epoch 4/8
---------------
train Loss: 0.1756
train Accuracy:0.955 Precision:0.866 Recall:0.958 F1:0.910 MCC:0.882.
val Loss: 0.3756
val Accuracy:0.929 Precision:0.808 Recall:0.912 F1:0.857 MCC:0.812.
 
Epoch 5/8
---------------
train Loss: 0.1358
train Accuracy:0.966 Precision:0.896 Recall:0.967 F1:0.930 MCC:0.909.
val Loss: 0.9573
val Accuracy:0.870 Precision:0.731 Recall:0.704 F1:0.717 MCC:0.633.
 
Epoch 6/8
---------------
train Loss: 0.1128
train Accuracy:0.973 Precision:0.915 Recall:0.974 F1:0.943 MCC:0.926.
val Loss: 0.4034
val Accuracy:0.923 Precision:0.799 Recall:0.900 F1:0.846 MCC:0.798.
 
Epoch 7/8
---------------
train Loss: 0.1004
train Accuracy:0.975 Precision:0.924 Recall:0.976 F1:0.949 MCC:0.934.
val Loss: 1.8708
val Accuracy:0.861 Precision:0.972 Recall:0.420 F1:0.587 MCC:0.585.
 
Epoch 8/8
---------------
train Loss: 0.0845
train Accuracy:0.979 Precision:0.935 Recall:0.980 F1:0.957 MCC:0.944.
val Loss: 0.3722
val Accuracy:0.912 Precision:0.749 Recall:0.942 F1:0.834 MCC:0.785.
Training complete in 167m 42s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_1', '../../bionoi_output/hydrophobicity/control/fold_2', '../../bionoi_output/hydrophobicity/control/fold_3', '../../bionoi_output/hydrophobicity/control/fold_4', '../../bionoi_output/hydrophobicity/heme/fold_1', '../../bionoi_output/hydrophobicity/heme/fold_2', '../../bionoi_output/hydrophobicity/heme/fold_3', '../../bionoi_output/hydrophobicity/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/hydrophobicity/control/fold_5', '../../bionoi_output/hydrophobicity/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5159
train Accuracy:0.856 Precision:0.643 Recall:0.868 F1:0.739 MCC:0.656.
val Loss: 0.4865
val Accuracy:0.857 Precision:0.645 Recall:0.869 F1:0.740 MCC:0.659.
 
Epoch 2/8
---------------
train Loss: 0.3375
train Accuracy:0.911 Precision:0.757 Recall:0.914 F1:0.828 MCC:0.775.
val Loss: 0.8394
val Accuracy:0.893 Precision:0.878 Recall:0.630 F1:0.734 MCC:0.683.
 
Epoch 3/8
---------------
train Loss: 0.2321
train Accuracy:0.940 Precision:0.826 Recall:0.942 F1:0.880 MCC:0.844.
val Loss: 0.5430
val Accuracy:0.880 Precision:0.706 Recall:0.836 F1:0.766 MCC:0.690.
 
Epoch 4/8
---------------
train Loss: 0.1660
train Accuracy:0.958 Precision:0.875 Recall:0.960 F1:0.916 MCC:0.890.
val Loss: 0.5475
val Accuracy:0.899 Precision:0.764 Recall:0.821 F1:0.792 MCC:0.726.
 
Epoch 5/8
---------------
train Loss: 0.1288
train Accuracy:0.969 Precision:0.902 Recall:0.971 F1:0.935 MCC:0.916.
val Loss: 0.7407
val Accuracy:0.906 Precision:0.817 Recall:0.770 F1:0.793 MCC:0.732.
 
Epoch 6/8
---------------
train Loss: 0.1024
train Accuracy:0.975 Precision:0.922 Recall:0.978 F1:0.949 MCC:0.934.
val Loss: 0.7327
val Accuracy:0.881 Precision:0.704 Recall:0.847 F1:0.769 MCC:0.695.
 
Epoch 7/8
---------------
train Loss: 0.0887
train Accuracy:0.978 Precision:0.932 Recall:0.980 F1:0.955 MCC:0.941.
val Loss: 1.0091
val Accuracy:0.911 Precision:0.877 Recall:0.719 F1:0.790 MCC:0.740.
 
Epoch 8/8
---------------
train Loss: 0.0785
train Accuracy:0.981 Precision:0.939 Recall:0.982 F1:0.960 MCC:0.948.
val Loss: 1.0449
val Accuracy:0.911 Precision:0.870 Recall:0.729 F1:0.793 MCC:0.741.
Training complete in 167m 39s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.751817523902343, 'acc': 0.8734477124183007, 'precision': 0.7323673184357542, 'recall': 0.7282986111111112, 'mcc': 0.6476573615305949}, {'loss': 0.49272496668619453, 'acc': 0.9183480971128609, 'precision': 0.7798165137614679, 'recall': 0.9077380952380952, 'mcc': 0.7887223361364583}, {'loss': 0.33323179496320215, 'acc': 0.9185531496062992, 'precision': 0.7647811256395679, 'recall': 0.9420518207282913, 'mcc': 0.7977428064516958}, {'loss': 0.37215157976408253, 'acc': 0.9124425853018373, 'precision': 0.7491294052096392, 'recall': 0.9415266106442577, 'mcc': 0.7852789019159255}, {'loss': 0.4864688539422872, 'acc': 0.8572424540682415, 'precision': 0.644926594777186, 'recall': 0.8690476190476191, 'mcc': 0.6585441737407743}]
Averge metrics over 5 folds:
average loss:  0.48727894385162196
average accuracy:  0.8960067997015079
average precision:  0.734204191564723
average recall:  0.8777325513538748
average mcc:  0.7355891159550897
cross-validation finished, end of program
