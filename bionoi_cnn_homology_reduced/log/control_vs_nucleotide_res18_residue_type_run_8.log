data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3744
train Accuracy:0.854 Precision:0.826 Recall:0.849 F1:0.838 MCC:0.705.
val Loss: 0.4239
val Accuracy:0.843 Precision:0.808 Recall:0.848 F1:0.827 MCC:0.684.
 
Epoch 2/8
---------------
train Loss: 0.2501
train Accuracy:0.908 Precision:0.892 Recall:0.902 F1:0.897 MCC:0.813.
val Loss: 0.4067
val Accuracy:0.847 Precision:0.847 Recall:0.800 F1:0.823 MCC:0.689.
 
Epoch 3/8
---------------
train Loss: 0.1618
train Accuracy:0.943 Precision:0.932 Recall:0.940 F1:0.936 MCC:0.884.
val Loss: 0.4404
val Accuracy:0.849 Precision:0.818 Recall:0.849 F1:0.833 MCC:0.696.
 
Epoch 4/8
---------------
train Loss: 0.1070
train Accuracy:0.963 Precision:0.956 Recall:0.961 F1:0.958 MCC:0.925.
val Loss: 0.5867
val Accuracy:0.844 Precision:0.840 Recall:0.801 F1:0.820 MCC:0.684.
 
Epoch 5/8
---------------
train Loss: 0.0813
train Accuracy:0.972 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.944.
val Loss: 0.5950
val Accuracy:0.848 Precision:0.830 Recall:0.827 F1:0.828 MCC:0.692.
 
Epoch 6/8
---------------
train Loss: 0.0682
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.6854
val Accuracy:0.848 Precision:0.870 Recall:0.773 F1:0.818 MCC:0.692.
 
Epoch 7/8
---------------
train Loss: 0.0595
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.5937
val Accuracy:0.849 Precision:0.844 Recall:0.809 F1:0.826 MCC:0.693.
 
Epoch 8/8
---------------
train Loss: 0.0539
train Accuracy:0.982 Precision:0.978 Recall:0.981 F1:0.980 MCC:0.963.
val Loss: 0.6444
val Accuracy:0.847 Precision:0.832 Recall:0.821 F1:0.826 MCC:0.689.
Training complete in 230m 52s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3814
train Accuracy:0.849 Precision:0.819 Recall:0.847 F1:0.833 MCC:0.696.
val Loss: 0.3840
val Accuracy:0.845 Precision:0.785 Recall:0.899 F1:0.838 MCC:0.697.
 
Epoch 2/8
---------------
train Loss: 0.2456
train Accuracy:0.909 Precision:0.888 Recall:0.908 F1:0.898 MCC:0.815.
val Loss: 0.3912
val Accuracy:0.879 Precision:0.902 Recall:0.817 F1:0.858 MCC:0.756.
 
Epoch 3/8
---------------
train Loss: 0.1569
train Accuracy:0.944 Precision:0.931 Recall:0.944 F1:0.937 MCC:0.887.
val Loss: 0.4092
val Accuracy:0.875 Precision:0.844 Recall:0.881 F1:0.862 MCC:0.749.
 
Epoch 4/8
---------------
train Loss: 0.1086
train Accuracy:0.963 Precision:0.954 Recall:0.964 F1:0.959 MCC:0.926.
val Loss: 0.5088
val Accuracy:0.852 Precision:0.785 Recall:0.919 F1:0.847 MCC:0.713.
 
Epoch 5/8
---------------
train Loss: 0.0819
train Accuracy:0.972 Precision:0.965 Recall:0.972 F1:0.969 MCC:0.944.
val Loss: 0.5084
val Accuracy:0.873 Precision:0.828 Recall:0.902 F1:0.863 MCC:0.748.
 
Epoch 6/8
---------------
train Loss: 0.0690
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.4962
val Accuracy:0.877 Precision:0.862 Recall:0.861 F1:0.862 MCC:0.751.
 
Epoch 7/8
---------------
train Loss: 0.0605
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.5706
val Accuracy:0.865 Precision:0.818 Recall:0.895 F1:0.855 MCC:0.732.
 
Epoch 8/8
---------------
train Loss: 0.0540
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.5067
val Accuracy:0.879 Precision:0.870 Recall:0.856 F1:0.863 MCC:0.755.
Training complete in 230m 31s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3839
train Accuracy:0.848 Precision:0.819 Recall:0.845 F1:0.832 MCC:0.694.
val Loss: 0.3798
val Accuracy:0.856 Precision:0.901 Recall:0.759 F1:0.824 MCC:0.711.
 
Epoch 2/8
---------------
train Loss: 0.2528
train Accuracy:0.906 Precision:0.887 Recall:0.903 F1:0.895 MCC:0.810.
val Loss: 0.3608
val Accuracy:0.859 Precision:0.795 Recall:0.919 F1:0.853 MCC:0.726.
 
Epoch 3/8
---------------
train Loss: 0.1637
train Accuracy:0.942 Precision:0.930 Recall:0.940 F1:0.935 MCC:0.883.
val Loss: 0.3612
val Accuracy:0.876 Precision:0.863 Recall:0.857 F1:0.860 MCC:0.749.
 
Epoch 4/8
---------------
train Loss: 0.1101
train Accuracy:0.962 Precision:0.953 Recall:0.961 F1:0.957 MCC:0.923.
val Loss: 0.4588
val Accuracy:0.863 Precision:0.807 Recall:0.907 F1:0.854 MCC:0.729.
 
Epoch 5/8
---------------
train Loss: 0.0861
train Accuracy:0.971 Precision:0.964 Recall:0.971 F1:0.967 MCC:0.941.
val Loss: 0.4526
val Accuracy:0.878 Precision:0.877 Recall:0.843 F1:0.860 MCC:0.752.
 
Epoch 6/8
---------------
train Loss: 0.0718
train Accuracy:0.976 Precision:0.970 Recall:0.976 F1:0.973 MCC:0.951.
val Loss: 0.8383
val Accuracy:0.828 Precision:0.915 Recall:0.674 F1:0.777 MCC:0.661.
 
Epoch 7/8
---------------
train Loss: 0.0607
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.977 MCC:0.959.
val Loss: 0.4699
val Accuracy:0.885 Precision:0.876 Recall:0.864 F1:0.870 MCC:0.767.
 
Epoch 8/8
---------------
train Loss: 0.0556
train Accuracy:0.982 Precision:0.977 Recall:0.982 F1:0.979 MCC:0.963.
val Loss: 0.4828
val Accuracy:0.885 Precision:0.902 Recall:0.831 F1:0.866 MCC:0.768.
Training complete in 231m 18s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3625
train Accuracy:0.858 Precision:0.830 Recall:0.856 F1:0.843 MCC:0.714.
val Loss: 0.4647
val Accuracy:0.823 Precision:0.768 Recall:0.861 F1:0.812 MCC:0.649.
 
Epoch 2/8
---------------
train Loss: 0.2251
train Accuracy:0.917 Precision:0.901 Recall:0.914 F1:0.908 MCC:0.833.
val Loss: 0.4586
val Accuracy:0.849 Precision:0.870 Recall:0.775 F1:0.820 MCC:0.693.
 
Epoch 3/8
---------------
train Loss: 0.1444
train Accuracy:0.949 Precision:0.938 Recall:0.949 F1:0.943 MCC:0.898.
val Loss: 0.7249
val Accuracy:0.822 Precision:0.883 Recall:0.689 F1:0.774 MCC:0.644.
 
Epoch 4/8
---------------
train Loss: 0.0988
train Accuracy:0.966 Precision:0.958 Recall:0.966 F1:0.962 MCC:0.931.
val Loss: 0.6253
val Accuracy:0.851 Precision:0.892 Recall:0.754 F1:0.817 MCC:0.700.
 
Epoch 5/8
---------------
train Loss: 0.0785
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.6188
val Accuracy:0.855 Precision:0.865 Recall:0.796 F1:0.829 MCC:0.705.
 
Epoch 6/8
---------------
train Loss: 0.0659
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.6379
val Accuracy:0.858 Precision:0.863 Recall:0.809 F1:0.835 MCC:0.712.
 
Epoch 7/8
---------------
train Loss: 0.0571
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.6442
val Accuracy:0.848 Precision:0.844 Recall:0.808 F1:0.825 MCC:0.692.
 
Epoch 8/8
---------------
train Loss: 0.0526
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.980 MCC:0.965.
val Loss: 0.8391
val Accuracy:0.846 Precision:0.887 Recall:0.747 F1:0.811 MCC:0.690.
Training complete in 231m 41s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3604
train Accuracy:0.858 Precision:0.830 Recall:0.856 F1:0.843 MCC:0.714.
val Loss: 0.4352
val Accuracy:0.842 Precision:0.856 Recall:0.776 F1:0.814 MCC:0.680.
 
Epoch 2/8
---------------
train Loss: 0.2267
train Accuracy:0.918 Precision:0.900 Recall:0.916 F1:0.908 MCC:0.833.
val Loss: 0.4499
val Accuracy:0.846 Precision:0.821 Recall:0.835 F1:0.828 MCC:0.689.
 
Epoch 3/8
---------------
train Loss: 0.1470
train Accuracy:0.948 Precision:0.937 Recall:0.948 F1:0.942 MCC:0.896.
val Loss: 0.5130
val Accuracy:0.844 Precision:0.806 Recall:0.856 F1:0.830 MCC:0.688.
 
Epoch 4/8
---------------
train Loss: 0.1000
train Accuracy:0.966 Precision:0.958 Recall:0.965 F1:0.961 MCC:0.931.
val Loss: 0.6212
val Accuracy:0.838 Precision:0.826 Recall:0.804 F1:0.815 MCC:0.671.
 
Epoch 5/8
---------------
train Loss: 0.0776
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.6313
val Accuracy:0.848 Precision:0.839 Recall:0.815 F1:0.827 MCC:0.692.
 
Epoch 6/8
---------------
train Loss: 0.0638
train Accuracy:0.978 Precision:0.973 Recall:0.979 F1:0.976 MCC:0.956.
val Loss: 0.6500
val Accuracy:0.841 Precision:0.809 Recall:0.841 F1:0.825 MCC:0.680.
 
Epoch 7/8
---------------
train Loss: 0.0571
train Accuracy:0.981 Precision:0.977 Recall:0.982 F1:0.979 MCC:0.962.
val Loss: 0.6919
val Accuracy:0.836 Precision:0.790 Recall:0.859 F1:0.823 MCC:0.673.
 
Epoch 8/8
---------------
train Loss: 0.0522
train Accuracy:0.983 Precision:0.978 Recall:0.983 F1:0.981 MCC:0.965.
val Loss: 0.7127
val Accuracy:0.849 Precision:0.824 Recall:0.837 F1:0.831 MCC:0.694.
Training complete in 231m 22s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4067474449893944, 'acc': 0.8471231573941987, 'precision': 0.8468027789593081, 'recall': 0.8001741693461951, 'mcc': 0.6894305729783425}, {'loss': 0.3839958772134213, 'acc': 0.8454761904761905, 'precision': 0.7845785104641646, 'recall': 0.8990487674169346, 'mcc': 0.6974403007913642}, {'loss': 0.36078344117495276, 'acc': 0.8589880952380953, 'precision': 0.7954308245390236, 'recall': 0.9189442658092176, 'mcc': 0.7257079223739327}, {'loss': 0.4586466524961396, 'acc': 0.848652837386743, 'precision': 0.8697193723596862, 'recall': 0.7747983870967742, 'mcc': 0.6933702585098304}, {'loss': 0.435210075948883, 'acc': 0.8424535050071531, 'precision': 0.8556494661921709, 'recall': 0.7756048387096774, 'mcc': 0.6802226476642247}]
Averge metrics over 5 folds:
average loss:  0.40907669836455823
average accuracy:  0.8485387571004761
average precision:  0.8304361905028707
average recall:  0.8337140856757598
average mcc:  0.6972343404635388
cross-validation finished, end of program
