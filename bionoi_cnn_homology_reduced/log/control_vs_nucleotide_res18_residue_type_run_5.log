data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3741
train Accuracy:0.854 Precision:0.826 Recall:0.850 F1:0.837 MCC:0.705.
val Loss: 0.4458
val Accuracy:0.839 Precision:0.789 Recall:0.870 F1:0.828 MCC:0.681.
 
Epoch 2/8
---------------
train Loss: 0.2513
train Accuracy:0.908 Precision:0.891 Recall:0.903 F1:0.897 MCC:0.814.
val Loss: 0.4162
val Accuracy:0.854 Precision:0.852 Recall:0.812 F1:0.831 MCC:0.703.
 
Epoch 3/8
---------------
train Loss: 0.1631
train Accuracy:0.942 Precision:0.931 Recall:0.939 F1:0.935 MCC:0.883.
val Loss: 0.4585
val Accuracy:0.855 Precision:0.835 Recall:0.839 F1:0.837 MCC:0.707.
 
Epoch 4/8
---------------
train Loss: 0.1088
train Accuracy:0.962 Precision:0.954 Recall:0.961 F1:0.958 MCC:0.923.
val Loss: 0.5786
val Accuracy:0.852 Precision:0.857 Recall:0.800 F1:0.828 MCC:0.700.
 
Epoch 5/8
---------------
train Loss: 0.0847
train Accuracy:0.971 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.5459
val Accuracy:0.858 Precision:0.831 Recall:0.853 F1:0.842 MCC:0.713.
 
Epoch 6/8
---------------
train Loss: 0.0688
train Accuracy:0.977 Precision:0.972 Recall:0.977 F1:0.974 MCC:0.954.
val Loss: 0.8185
val Accuracy:0.830 Precision:0.893 Recall:0.702 F1:0.786 MCC:0.661.
 
Epoch 7/8
---------------
train Loss: 0.0607
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.7289
val Accuracy:0.848 Precision:0.894 Recall:0.746 F1:0.813 MCC:0.694.
 
Epoch 8/8
---------------
train Loss: 0.0531
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.981 MCC:0.965.
val Loss: 0.7606
val Accuracy:0.840 Precision:0.857 Recall:0.767 F1:0.809 MCC:0.675.
Training complete in 230m 34s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3829
train Accuracy:0.848 Precision:0.817 Recall:0.848 F1:0.832 MCC:0.694.
val Loss: 0.3520
val Accuracy:0.859 Precision:0.813 Recall:0.887 F1:0.849 MCC:0.720.
 
Epoch 2/8
---------------
train Loss: 0.2496
train Accuracy:0.907 Precision:0.886 Recall:0.907 F1:0.896 MCC:0.812.
val Loss: 0.4113
val Accuracy:0.873 Precision:0.903 Recall:0.800 F1:0.849 MCC:0.744.
 
Epoch 3/8
---------------
train Loss: 0.1622
train Accuracy:0.942 Precision:0.929 Recall:0.942 F1:0.935 MCC:0.883.
val Loss: 0.3876
val Accuracy:0.883 Precision:0.861 Recall:0.880 F1:0.870 MCC:0.764.
 
Epoch 4/8
---------------
train Loss: 0.1132
train Accuracy:0.961 Precision:0.951 Recall:0.960 F1:0.956 MCC:0.920.
val Loss: 0.5522
val Accuracy:0.841 Precision:0.762 Recall:0.934 F1:0.840 MCC:0.700.
 
Epoch 5/8
---------------
train Loss: 0.0832
train Accuracy:0.972 Precision:0.965 Recall:0.972 F1:0.968 MCC:0.943.
val Loss: 0.6889
val Accuracy:0.832 Precision:0.758 Recall:0.915 F1:0.829 MCC:0.679.
 
Epoch 6/8
---------------
train Loss: 0.0703
train Accuracy:0.977 Precision:0.971 Recall:0.976 F1:0.974 MCC:0.953.
val Loss: 0.4929
val Accuracy:0.873 Precision:0.826 Recall:0.904 F1:0.863 MCC:0.747.
 
Epoch 7/8
---------------
train Loss: 0.0623
train Accuracy:0.979 Precision:0.973 Recall:0.980 F1:0.976 MCC:0.958.
val Loss: 0.5255
val Accuracy:0.876 Precision:0.848 Recall:0.879 F1:0.863 MCC:0.751.
 
Epoch 8/8
---------------
train Loss: 0.0557
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.5066
val Accuracy:0.878 Precision:0.869 Recall:0.853 F1:0.861 MCC:0.752.
Training complete in 230m 44s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3830
train Accuracy:0.848 Precision:0.818 Recall:0.845 F1:0.831 MCC:0.693.
val Loss: 0.3327
val Accuracy:0.873 Precision:0.868 Recall:0.843 F1:0.855 MCC:0.743.
 
Epoch 2/8
---------------
train Loss: 0.2515
train Accuracy:0.907 Precision:0.888 Recall:0.904 F1:0.896 MCC:0.812.
val Loss: 0.3830
val Accuracy:0.855 Precision:0.783 Recall:0.933 F1:0.852 MCC:0.723.
 
Epoch 3/8
---------------
train Loss: 0.1613
train Accuracy:0.943 Precision:0.931 Recall:0.941 F1:0.936 MCC:0.885.
val Loss: 0.3041
val Accuracy:0.892 Precision:0.872 Recall:0.889 F1:0.880 MCC:0.783.
 
Epoch 4/8
---------------
train Loss: 0.1089
train Accuracy:0.963 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.924.
val Loss: 0.4207
val Accuracy:0.871 Precision:0.829 Recall:0.895 F1:0.860 MCC:0.743.
 
Epoch 5/8
---------------
train Loss: 0.0821
train Accuracy:0.972 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.944.
val Loss: 0.4134
val Accuracy:0.882 Precision:0.877 Recall:0.856 F1:0.866 MCC:0.762.
 
Epoch 6/8
---------------
train Loss: 0.0694
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.954.
val Loss: 0.6033
val Accuracy:0.863 Precision:0.910 Recall:0.767 F1:0.832 MCC:0.725.
 
Epoch 7/8
---------------
train Loss: 0.0605
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.4961
val Accuracy:0.877 Precision:0.856 Recall:0.867 F1:0.862 MCC:0.750.
 
Epoch 8/8
---------------
train Loss: 0.0554
train Accuracy:0.982 Precision:0.978 Recall:0.981 F1:0.979 MCC:0.963.
val Loss: 0.4574
val Accuracy:0.889 Precision:0.888 Recall:0.859 F1:0.873 MCC:0.774.
Training complete in 231m 15s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3646
train Accuracy:0.857 Precision:0.829 Recall:0.855 F1:0.842 MCC:0.712.
val Loss: 0.3901
val Accuracy:0.836 Precision:0.781 Recall:0.875 F1:0.825 MCC:0.675.
 
Epoch 2/8
---------------
train Loss: 0.2263
train Accuracy:0.917 Precision:0.901 Recall:0.914 F1:0.908 MCC:0.833.
val Loss: 0.4656
val Accuracy:0.846 Precision:0.817 Recall:0.841 F1:0.829 MCC:0.689.
 
Epoch 3/8
---------------
train Loss: 0.1479
train Accuracy:0.948 Precision:0.937 Recall:0.946 F1:0.941 MCC:0.894.
val Loss: 0.5044
val Accuracy:0.848 Precision:0.839 Recall:0.814 F1:0.826 MCC:0.692.
 
Epoch 4/8
---------------
train Loss: 0.1011
train Accuracy:0.965 Precision:0.957 Recall:0.964 F1:0.960 MCC:0.929.
val Loss: 0.5638
val Accuracy:0.855 Precision:0.864 Recall:0.799 F1:0.830 MCC:0.706.
 
Epoch 5/8
---------------
train Loss: 0.0773
train Accuracy:0.974 Precision:0.968 Recall:0.974 F1:0.971 MCC:0.948.
val Loss: 0.6507
val Accuracy:0.832 Precision:0.823 Recall:0.792 F1:0.807 MCC:0.659.
 
Epoch 6/8
---------------
train Loss: 0.0658
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.975 MCC:0.956.
val Loss: 0.6755
val Accuracy:0.859 Precision:0.894 Recall:0.773 F1:0.829 MCC:0.716.
 
Epoch 7/8
---------------
train Loss: 0.0587
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.6208
val Accuracy:0.845 Precision:0.837 Recall:0.808 F1:0.822 MCC:0.686.
 
Epoch 8/8
---------------
train Loss: 0.0512
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.7026
val Accuracy:0.850 Precision:0.848 Recall:0.805 F1:0.826 MCC:0.695.
Training complete in 231m 42s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3574
train Accuracy:0.860 Precision:0.832 Recall:0.858 F1:0.845 MCC:0.718.
val Loss: 0.4731
val Accuracy:0.830 Precision:0.869 Recall:0.727 F1:0.792 MCC:0.658.
 
Epoch 2/8
---------------
train Loss: 0.2250
train Accuracy:0.918 Precision:0.902 Recall:0.915 F1:0.908 MCC:0.834.
val Loss: 0.5161
val Accuracy:0.836 Precision:0.798 Recall:0.845 F1:0.821 MCC:0.671.
 
Epoch 3/8
---------------
train Loss: 0.1438
train Accuracy:0.949 Precision:0.938 Recall:0.948 F1:0.943 MCC:0.897.
val Loss: 0.5715
val Accuracy:0.835 Precision:0.782 Recall:0.869 F1:0.823 MCC:0.672.
 
Epoch 4/8
---------------
train Loss: 0.0988
train Accuracy:0.966 Precision:0.959 Recall:0.965 F1:0.962 MCC:0.931.
val Loss: 0.5860
val Accuracy:0.847 Precision:0.851 Recall:0.794 F1:0.821 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.0786
train Accuracy:0.974 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.947.
val Loss: 0.7263
val Accuracy:0.835 Precision:0.855 Recall:0.758 F1:0.803 MCC:0.666.
 
Epoch 6/8
---------------
train Loss: 0.0640
train Accuracy:0.979 Precision:0.973 Recall:0.978 F1:0.976 MCC:0.957.
val Loss: 0.6682
val Accuracy:0.840 Precision:0.820 Recall:0.820 F1:0.820 MCC:0.677.
 
Epoch 7/8
---------------
train Loss: 0.0585
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.978 MCC:0.961.
val Loss: 0.8243
val Accuracy:0.831 Precision:0.845 Recall:0.759 F1:0.800 MCC:0.658.
 
Epoch 8/8
---------------
train Loss: 0.0522
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.966.
val Loss: 0.7002
val Accuracy:0.853 Precision:0.864 Recall:0.792 F1:0.826 MCC:0.701.
Training complete in 231m 60s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4161920283756764, 'acc': 0.8537208749405611, 'precision': 0.8516305875737982, 'recall': 0.8116961414790996, 'mcc': 0.7028947256167617}, {'loss': 0.3519693806483632, 'acc': 0.859375, 'precision': 0.8134947458981134, 'recall': 0.8867899249732047, 'mcc': 0.7200911701516339}, {'loss': 0.304149430722353, 'acc': 0.8925, 'precision': 0.8715524034672971, 'recall': 0.8890675241157556, 'mcc': 0.7828621495447411}, {'loss': 0.39013596291933167, 'acc': 0.8355984740104911, 'precision': 0.7806281467274035, 'recall': 0.875268817204301, 'mcc': 0.6749114789207005}, {'loss': 0.47312233382796015, 'acc': 0.8302932761087267, 'precision': 0.8686195826645264, 'recall': 0.7273521505376344, 'mcc': 0.657721863066646}]
Averge metrics over 5 folds:
average loss:  0.38711382729873695
average accuracy:  0.8542975250119558
average precision:  0.8371850932662278
average recall:  0.8380349116619991
average mcc:  0.7076962774600967
cross-validation finished, end of program
