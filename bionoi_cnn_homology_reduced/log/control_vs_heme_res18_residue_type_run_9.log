data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3780
train Accuracy:0.905 Precision:0.745 Recall:0.904 F1:0.817 MCC:0.760.
val Loss: 1.1853
val Accuracy:0.876 Precision:0.899 Recall:0.533 F1:0.669 MCC:0.630.
 
Epoch 2/8
---------------
train Loss: 0.2314
train Accuracy:0.944 Precision:0.841 Recall:0.940 F1:0.888 MCC:0.853.
val Loss: 0.8221
val Accuracy:0.875 Precision:0.748 Recall:0.705 F1:0.726 MCC:0.646.
 
Epoch 3/8
---------------
train Loss: 0.1513
train Accuracy:0.963 Precision:0.889 Recall:0.963 F1:0.925 MCC:0.902.
val Loss: 0.7178
val Accuracy:0.875 Precision:0.715 Recall:0.776 F1:0.744 MCC:0.663.
 
Epoch 4/8
---------------
train Loss: 0.1084
train Accuracy:0.974 Precision:0.919 Recall:0.974 F1:0.946 MCC:0.929.
val Loss: 1.0337
val Accuracy:0.876 Precision:0.731 Recall:0.747 F1:0.739 MCC:0.658.
 
Epoch 5/8
---------------
train Loss: 0.0819
train Accuracy:0.980 Precision:0.938 Recall:0.981 F1:0.959 MCC:0.947.
val Loss: 1.1850
val Accuracy:0.882 Precision:0.798 Recall:0.666 F1:0.726 MCC:0.656.
 
Epoch 6/8
---------------
train Loss: 0.0722
train Accuracy:0.983 Precision:0.945 Recall:0.983 F1:0.964 MCC:0.953.
val Loss: 1.6172
val Accuracy:0.891 Precision:0.874 Recall:0.627 F1:0.730 MCC:0.679.
 
Epoch 7/8
---------------
train Loss: 0.0627
train Accuracy:0.985 Precision:0.953 Recall:0.986 F1:0.969 MCC:0.960.
val Loss: 1.8280
val Accuracy:0.883 Precision:0.854 Recall:0.607 F1:0.710 MCC:0.654.
 
Epoch 8/8
---------------
train Loss: 0.0575
train Accuracy:0.987 Precision:0.958 Recall:0.987 F1:0.972 MCC:0.964.
val Loss: 1.7488
val Accuracy:0.892 Precision:0.914 Recall:0.599 F1:0.723 MCC:0.683.
Training complete in 167m 40s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4224
train Accuracy:0.888 Precision:0.710 Recall:0.885 F1:0.788 MCC:0.721.
val Loss: 1.7146
val Accuracy:0.819 Precision:0.853 Recall:0.272 F1:0.413 MCC:0.415.
 
Epoch 2/8
---------------
train Loss: 0.2432
train Accuracy:0.939 Precision:0.827 Recall:0.936 F1:0.878 MCC:0.841.
val Loss: 0.4077
val Accuracy:0.918 Precision:0.782 Recall:0.901 F1:0.837 MCC:0.786.
 
Epoch 3/8
---------------
train Loss: 0.1550
train Accuracy:0.962 Precision:0.886 Recall:0.962 F1:0.922 MCC:0.898.
val Loss: 0.4612
val Accuracy:0.905 Precision:0.756 Recall:0.878 F1:0.813 MCC:0.753.
 
Epoch 4/8
---------------
train Loss: 0.1109
train Accuracy:0.973 Precision:0.916 Recall:0.974 F1:0.944 MCC:0.927.
val Loss: 0.6571
val Accuracy:0.922 Precision:0.843 Recall:0.819 F1:0.831 MCC:0.780.
 
Epoch 5/8
---------------
train Loss: 0.0927
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 0.4227
val Accuracy:0.939 Precision:0.861 Recall:0.884 F1:0.872 MCC:0.832.
 
Epoch 6/8
---------------
train Loss: 0.0729
train Accuracy:0.982 Precision:0.944 Recall:0.983 F1:0.963 MCC:0.952.
val Loss: 0.4924
val Accuracy:0.932 Precision:0.842 Recall:0.874 F1:0.858 MCC:0.814.
 
Epoch 7/8
---------------
train Loss: 0.0713
train Accuracy:0.983 Precision:0.947 Recall:0.983 F1:0.965 MCC:0.954.
val Loss: 0.4499
val Accuracy:0.916 Precision:0.785 Recall:0.884 F1:0.831 MCC:0.778.
 
Epoch 8/8
---------------
train Loss: 0.0618
train Accuracy:0.986 Precision:0.956 Recall:0.985 F1:0.971 MCC:0.962.
val Loss: 0.5122
val Accuracy:0.939 Precision:0.889 Recall:0.845 F1:0.867 MCC:0.828.
Training complete in 167m 42s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_4', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4245
train Accuracy:0.887 Precision:0.707 Recall:0.887 F1:0.787 MCC:0.720.
val Loss: 0.4332
val Accuracy:0.920 Precision:0.828 Recall:0.829 F1:0.828 MCC:0.776.
 
Epoch 2/8
---------------
train Loss: 0.2493
train Accuracy:0.936 Precision:0.819 Recall:0.935 F1:0.873 MCC:0.834.
val Loss: 0.3875
val Accuracy:0.943 Precision:0.853 Recall:0.912 F1:0.881 MCC:0.844.
 
Epoch 3/8
---------------
train Loss: 0.1658
train Accuracy:0.958 Precision:0.875 Recall:0.959 F1:0.915 MCC:0.889.
val Loss: 0.3485
val Accuracy:0.947 Precision:0.868 Recall:0.915 F1:0.891 MCC:0.857.
 
Epoch 4/8
---------------
train Loss: 0.1233
train Accuracy:0.970 Precision:0.908 Recall:0.971 F1:0.938 MCC:0.920.
val Loss: 0.4506
val Accuracy:0.914 Precision:0.755 Recall:0.938 F1:0.836 MCC:0.787.
 
Epoch 5/8
---------------
train Loss: 0.0977
train Accuracy:0.977 Precision:0.927 Recall:0.977 F1:0.952 MCC:0.937.
val Loss: 0.4118
val Accuracy:0.921 Precision:0.776 Recall:0.930 F1:0.846 MCC:0.799.
 
Epoch 6/8
---------------
train Loss: 0.0772
train Accuracy:0.981 Precision:0.940 Recall:0.982 F1:0.960 MCC:0.948.
val Loss: 0.4421
val Accuracy:0.920 Precision:0.765 Recall:0.948 F1:0.847 MCC:0.802.
 
Epoch 7/8
---------------
train Loss: 0.0690
train Accuracy:0.983 Precision:0.945 Recall:0.984 F1:0.964 MCC:0.953.
val Loss: 0.5150
val Accuracy:0.942 Precision:0.852 Recall:0.911 F1:0.880 MCC:0.843.
 
Epoch 8/8
---------------
train Loss: 0.0629
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.969 MCC:0.959.
val Loss: 0.5937
val Accuracy:0.938 Precision:0.843 Recall:0.901 F1:0.871 MCC:0.831.
Training complete in 167m 49s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4380
train Accuracy:0.886 Precision:0.706 Recall:0.881 F1:0.784 MCC:0.716.
val Loss: 0.3458
val Accuracy:0.916 Precision:0.776 Recall:0.901 F1:0.834 MCC:0.782.
 
Epoch 2/8
---------------
train Loss: 0.2717
train Accuracy:0.932 Precision:0.807 Recall:0.931 F1:0.865 MCC:0.823.
val Loss: 0.3472
val Accuracy:0.918 Precision:0.773 Recall:0.917 F1:0.839 MCC:0.789.
 
Epoch 3/8
---------------
train Loss: 0.1805
train Accuracy:0.954 Precision:0.864 Recall:0.955 F1:0.907 MCC:0.879.
val Loss: 1.0269
val Accuracy:0.754 Precision:0.488 Recall:0.990 F1:0.654 MCC:0.570.
 
Epoch 4/8
---------------
train Loss: 0.1326
train Accuracy:0.967 Precision:0.899 Recall:0.968 F1:0.932 MCC:0.912.
val Loss: 0.3683
val Accuracy:0.933 Precision:0.829 Recall:0.899 F1:0.862 MCC:0.819.
 
Epoch 5/8
---------------
train Loss: 0.1009
train Accuracy:0.975 Precision:0.922 Recall:0.976 F1:0.948 MCC:0.933.
val Loss: 0.4611
val Accuracy:0.908 Precision:0.747 Recall:0.918 F1:0.824 MCC:0.770.
 
Epoch 6/8
---------------
train Loss: 0.0836
train Accuracy:0.980 Precision:0.938 Recall:0.981 F1:0.959 MCC:0.946.
val Loss: 0.4001
val Accuracy:0.922 Precision:0.780 Recall:0.932 F1:0.849 MCC:0.803.
 
Epoch 7/8
---------------
train Loss: 0.0778
train Accuracy:0.982 Precision:0.942 Recall:0.982 F1:0.962 MCC:0.950.
val Loss: 0.3041
val Accuracy:0.941 Precision:0.835 Recall:0.932 F1:0.881 MCC:0.844.
 
Epoch 8/8
---------------
train Loss: 0.0663
train Accuracy:0.985 Precision:0.952 Recall:0.985 F1:0.968 MCC:0.958.
val Loss: 0.4767
val Accuracy:0.932 Precision:0.849 Recall:0.864 F1:0.856 MCC:0.812.
Training complete in 167m 55s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/heme/fold_1', '../../bionoi_output/residue_type/heme/fold_2', '../../bionoi_output/residue_type/heme/fold_3', '../../bionoi_output/residue_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4086
train Accuracy:0.895 Precision:0.723 Recall:0.893 F1:0.799 MCC:0.736.
val Loss: 0.4762
val Accuracy:0.879 Precision:0.703 Recall:0.837 F1:0.764 MCC:0.688.
 
Epoch 2/8
---------------
train Loss: 0.2480
train Accuracy:0.937 Precision:0.821 Recall:0.936 F1:0.875 MCC:0.836.
val Loss: 0.7165
val Accuracy:0.910 Precision:0.883 Recall:0.709 F1:0.786 MCC:0.737.
 
Epoch 3/8
---------------
train Loss: 0.1593
train Accuracy:0.960 Precision:0.881 Recall:0.961 F1:0.919 MCC:0.895.
val Loss: 0.5898
val Accuracy:0.885 Precision:0.723 Recall:0.825 F1:0.771 MCC:0.698.
 
Epoch 4/8
---------------
train Loss: 0.1127
train Accuracy:0.973 Precision:0.915 Recall:0.974 F1:0.943 MCC:0.926.
val Loss: 0.8612
val Accuracy:0.897 Precision:0.808 Recall:0.737 F1:0.771 MCC:0.706.
 
Epoch 5/8
---------------
train Loss: 0.0919
train Accuracy:0.978 Precision:0.932 Recall:0.978 F1:0.955 MCC:0.941.
val Loss: 0.6825
val Accuracy:0.905 Precision:0.781 Recall:0.826 F1:0.803 MCC:0.741.
 
Epoch 6/8
---------------
train Loss: 0.0776
train Accuracy:0.982 Precision:0.943 Recall:0.983 F1:0.963 MCC:0.951.
val Loss: 0.5597
val Accuracy:0.907 Precision:0.771 Recall:0.858 F1:0.812 MCC:0.752.
 
Epoch 7/8
---------------
train Loss: 0.0681
train Accuracy:0.984 Precision:0.949 Recall:0.984 F1:0.966 MCC:0.956.
val Loss: 0.9216
val Accuracy:0.897 Precision:0.803 Recall:0.742 F1:0.771 MCC:0.705.
 
Epoch 8/8
---------------
train Loss: 0.0608
train Accuracy:0.986 Precision:0.956 Recall:0.986 F1:0.971 MCC:0.962.
val Loss: 0.7089
val Accuracy:0.882 Precision:0.709 Recall:0.846 F1:0.771 MCC:0.698.
Training complete in 167m 42s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.7177810950655173, 'acc': 0.8746323529411765, 'precision': 0.7152455607102863, 'recall': 0.7762152777777778, 'mcc': 0.6625793222988138}, {'loss': 0.4077220630729351, 'acc': 0.917855971128609, 'precision': 0.7817104663527267, 'recall': 0.9009103641456583, 'mcc': 0.7860611996201571}, {'loss': 0.3484919861868376, 'acc': 0.9474245406824147, 'precision': 0.8679401993355482, 'recall': 0.9147408963585434, 'mcc': 0.8566544510906363}, {'loss': 0.30413193144044764, 'acc': 0.9410679133858267, 'precision': 0.8351889603261722, 'recall': 0.9324229691876751, 'mcc': 0.8443682523840248}, {'loss': 0.4761593236130836, 'acc': 0.8788549868766404, 'precision': 0.7026153394064061, 'recall': 0.8371848739495799, 'mcc': 0.6881127362808586}]
Averge metrics over 5 folds:
average loss:  0.45085727987576424
average accuracy:  0.9119671530029334
average precision:  0.7805401052262277
average recall:  0.8722948762838468
average mcc:  0.7675551923348982
cross-validation finished, end of program
