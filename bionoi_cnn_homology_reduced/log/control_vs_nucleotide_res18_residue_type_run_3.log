data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3733
train Accuracy:0.855 Precision:0.827 Recall:0.850 F1:0.838 MCC:0.706.
val Loss: 0.4329
val Accuracy:0.833 Precision:0.845 Recall:0.764 F1:0.803 MCC:0.662.
 
Epoch 2/8
---------------
train Loss: 0.2488
train Accuracy:0.909 Precision:0.893 Recall:0.902 F1:0.898 MCC:0.815.
val Loss: 0.4250
val Accuracy:0.847 Precision:0.844 Recall:0.805 F1:0.824 MCC:0.690.
 
Epoch 3/8
---------------
train Loss: 0.1633
train Accuracy:0.942 Precision:0.931 Recall:0.939 F1:0.935 MCC:0.883.
val Loss: 0.4454
val Accuracy:0.850 Precision:0.807 Recall:0.871 F1:0.837 MCC:0.700.
 
Epoch 4/8
---------------
train Loss: 0.1081
train Accuracy:0.963 Precision:0.956 Recall:0.961 F1:0.958 MCC:0.925.
val Loss: 0.6195
val Accuracy:0.846 Precision:0.811 Recall:0.849 F1:0.830 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.0849
train Accuracy:0.971 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.5361
val Accuracy:0.850 Precision:0.860 Recall:0.790 F1:0.823 MCC:0.695.
 
Epoch 6/8
---------------
train Loss: 0.0711
train Accuracy:0.976 Precision:0.971 Recall:0.974 F1:0.973 MCC:0.951.
val Loss: 0.6903
val Accuracy:0.831 Precision:0.858 Recall:0.743 F1:0.796 MCC:0.659.
 
Epoch 7/8
---------------
train Loss: 0.0591
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.7007
val Accuracy:0.841 Precision:0.872 Recall:0.751 F1:0.807 MCC:0.678.
 
Epoch 8/8
---------------
train Loss: 0.0549
train Accuracy:0.982 Precision:0.978 Recall:0.981 F1:0.979 MCC:0.963.
val Loss: 0.6911
val Accuracy:0.839 Precision:0.844 Recall:0.780 F1:0.811 MCC:0.672.
Training complete in 230m 50s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3786
train Accuracy:0.850 Precision:0.819 Recall:0.850 F1:0.834 MCC:0.698.
val Loss: 0.3541
val Accuracy:0.859 Precision:0.807 Recall:0.896 F1:0.849 MCC:0.721.
 
Epoch 2/8
---------------
train Loss: 0.2421
train Accuracy:0.911 Precision:0.891 Recall:0.910 F1:0.900 MCC:0.820.
val Loss: 0.4028
val Accuracy:0.881 Precision:0.913 Recall:0.808 F1:0.857 MCC:0.760.
 
Epoch 3/8
---------------
train Loss: 0.1551
train Accuracy:0.945 Precision:0.932 Recall:0.945 F1:0.938 MCC:0.889.
val Loss: 0.4436
val Accuracy:0.874 Precision:0.851 Recall:0.867 F1:0.859 MCC:0.745.
 
Epoch 4/8
---------------
train Loss: 0.1085
train Accuracy:0.963 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.924.
val Loss: 0.4219
val Accuracy:0.878 Precision:0.858 Recall:0.870 F1:0.864 MCC:0.754.
 
Epoch 5/8
---------------
train Loss: 0.0807
train Accuracy:0.973 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.945.
val Loss: 0.4580
val Accuracy:0.876 Precision:0.851 Recall:0.875 F1:0.863 MCC:0.750.
 
Epoch 6/8
---------------
train Loss: 0.0687
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.5638
val Accuracy:0.873 Precision:0.878 Recall:0.831 F1:0.854 MCC:0.743.
 
Epoch 7/8
---------------
train Loss: 0.0603
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.977 MCC:0.959.
val Loss: 0.5102
val Accuracy:0.874 Precision:0.848 Recall:0.874 F1:0.861 MCC:0.746.
 
Epoch 8/8
---------------
train Loss: 0.0552
train Accuracy:0.982 Precision:0.977 Recall:0.982 F1:0.979 MCC:0.963.
val Loss: 0.4924
val Accuracy:0.877 Precision:0.853 Recall:0.873 F1:0.863 MCC:0.752.
Training complete in 230m 42s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3849
train Accuracy:0.848 Precision:0.819 Recall:0.845 F1:0.832 MCC:0.694.
val Loss: 0.3487
val Accuracy:0.863 Precision:0.858 Recall:0.829 F1:0.843 MCC:0.722.
 
Epoch 2/8
---------------
train Loss: 0.2540
train Accuracy:0.906 Precision:0.889 Recall:0.902 F1:0.895 MCC:0.811.
val Loss: 0.4321
val Accuracy:0.844 Precision:0.759 Recall:0.950 F1:0.844 MCC:0.709.
 
Epoch 3/8
---------------
train Loss: 0.1632
train Accuracy:0.942 Precision:0.929 Recall:0.941 F1:0.935 MCC:0.883.
val Loss: 0.3389
val Accuracy:0.892 Precision:0.858 Recall:0.907 F1:0.882 MCC:0.783.
 
Epoch 4/8
---------------
train Loss: 0.1096
train Accuracy:0.963 Precision:0.955 Recall:0.962 F1:0.958 MCC:0.925.
val Loss: 0.4162
val Accuracy:0.868 Precision:0.818 Recall:0.906 F1:0.860 MCC:0.740.
 
Epoch 5/8
---------------
train Loss: 0.0849
train Accuracy:0.971 Precision:0.964 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.4303
val Accuracy:0.875 Precision:0.841 Recall:0.886 F1:0.863 MCC:0.749.
 
Epoch 6/8
---------------
train Loss: 0.0711
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.973 MCC:0.952.
val Loss: 0.4825
val Accuracy:0.876 Precision:0.874 Recall:0.842 F1:0.858 MCC:0.749.
 
Epoch 7/8
---------------
train Loss: 0.0593
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.5452
val Accuracy:0.861 Precision:0.799 Recall:0.918 F1:0.854 MCC:0.729.
 
Epoch 8/8
---------------
train Loss: 0.0565
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.4169
val Accuracy:0.889 Precision:0.874 Recall:0.876 F1:0.875 MCC:0.775.
Training complete in 230m 36s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3650
train Accuracy:0.857 Precision:0.828 Recall:0.854 F1:0.841 MCC:0.711.
val Loss: 0.4479
val Accuracy:0.823 Precision:0.756 Recall:0.887 F1:0.816 MCC:0.656.
 
Epoch 2/8
---------------
train Loss: 0.2238
train Accuracy:0.918 Precision:0.901 Recall:0.916 F1:0.908 MCC:0.834.
val Loss: 0.6107
val Accuracy:0.822 Precision:0.897 Recall:0.675 F1:0.771 MCC:0.647.
 
Epoch 3/8
---------------
train Loss: 0.1460
train Accuracy:0.949 Precision:0.938 Recall:0.948 F1:0.943 MCC:0.897.
val Loss: 0.5556
val Accuracy:0.836 Precision:0.885 Recall:0.725 F1:0.797 MCC:0.671.
 
Epoch 4/8
---------------
train Loss: 0.0997
train Accuracy:0.966 Precision:0.959 Recall:0.965 F1:0.962 MCC:0.932.
val Loss: 0.6558
val Accuracy:0.853 Precision:0.869 Recall:0.788 F1:0.826 MCC:0.702.
 
Epoch 5/8
---------------
train Loss: 0.0780
train Accuracy:0.974 Precision:0.968 Recall:0.973 F1:0.970 MCC:0.947.
val Loss: 0.6368
val Accuracy:0.849 Precision:0.852 Recall:0.798 F1:0.824 MCC:0.692.
 
Epoch 6/8
---------------
train Loss: 0.0655
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.7826
val Accuracy:0.843 Precision:0.907 Recall:0.719 F1:0.802 MCC:0.687.
 
Epoch 7/8
---------------
train Loss: 0.0585
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.6533
val Accuracy:0.856 Precision:0.841 Recall:0.834 F1:0.837 MCC:0.709.
 
Epoch 8/8
---------------
train Loss: 0.0513
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.981 MCC:0.966.
val Loss: 0.8564
val Accuracy:0.848 Precision:0.886 Recall:0.756 F1:0.816 MCC:0.695.
Training complete in 231m 24s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3593
train Accuracy:0.859 Precision:0.831 Recall:0.857 F1:0.844 MCC:0.716.
val Loss: 0.4681
val Accuracy:0.834 Precision:0.862 Recall:0.745 F1:0.800 MCC:0.665.
 
Epoch 2/8
---------------
train Loss: 0.2286
train Accuracy:0.916 Precision:0.899 Recall:0.913 F1:0.906 MCC:0.830.
val Loss: 0.5318
val Accuracy:0.833 Precision:0.847 Recall:0.761 F1:0.802 MCC:0.661.
 
Epoch 3/8
---------------
train Loss: 0.1493
train Accuracy:0.947 Precision:0.935 Recall:0.946 F1:0.941 MCC:0.893.
val Loss: 0.5535
val Accuracy:0.837 Precision:0.776 Recall:0.889 F1:0.829 MCC:0.680.
 
Epoch 4/8
---------------
train Loss: 0.1048
train Accuracy:0.964 Precision:0.956 Recall:0.963 F1:0.959 MCC:0.927.
val Loss: 0.6948
val Accuracy:0.828 Precision:0.864 Recall:0.726 F1:0.789 MCC:0.652.
 
Epoch 5/8
---------------
train Loss: 0.0794
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.6521
val Accuracy:0.847 Precision:0.833 Recall:0.820 F1:0.826 MCC:0.690.
 
Epoch 6/8
---------------
train Loss: 0.0687
train Accuracy:0.977 Precision:0.971 Recall:0.976 F1:0.974 MCC:0.953.
val Loss: 0.6608
val Accuracy:0.836 Precision:0.792 Recall:0.854 F1:0.822 MCC:0.672.
 
Epoch 7/8
---------------
train Loss: 0.0583
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.7446
val Accuracy:0.836 Precision:0.824 Recall:0.801 F1:0.812 MCC:0.667.
 
Epoch 8/8
---------------
train Loss: 0.0530
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.7216
val Accuracy:0.847 Precision:0.843 Recall:0.806 F1:0.824 MCC:0.690.
Training complete in 231m 50s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.42497358126437385, 'acc': 0.847301474084641, 'precision': 0.8439432265317595, 'recall': 0.8045953912111469, 'mcc': 0.6898183735437177}, {'loss': 0.3540666380098888, 'acc': 0.8588690476190476, 'precision': 0.8073627036813519, 'recall': 0.8961682743837085, 'mcc': 0.7207683381195032}, {'loss': 0.3389442619113695, 'acc': 0.891875, 'precision': 0.857504589479015, 'recall': 0.907422293676313, 'mcc': 0.7833645407679287}, {'loss': 0.44792839801618467, 'acc': 0.823140200286123, 'precision': 0.7562736335510485, 'recall': 0.8870967741935484, 'mcc': 0.6555806093251779}, {'loss': 0.46808368148451823, 'acc': 0.8343466857415355, 'precision': 0.8624416796267496, 'recall': 0.7453629032258065, 'mcc': 0.6648198634799696}]
Averge metrics over 5 folds:
average loss:  0.40679931213726694
average accuracy:  0.8511064815462694
average precision:  0.8255051665739849
average recall:  0.8481291273381046
average mcc:  0.7028703450472594
cross-validation finished, end of program
