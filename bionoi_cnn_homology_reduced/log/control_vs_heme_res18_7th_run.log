data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4489
train Accuracy:0.883 Precision:0.696 Recall:0.884 F1:0.779 MCC:0.710.
val Loss: 0.6883
val Accuracy:0.839 Precision:0.624 Recall:0.793 F1:0.698 MCC:0.598.
 
Epoch 2/8
---------------
train Loss: 0.3025
train Accuracy:0.930 Precision:0.807 Recall:0.919 F1:0.860 MCC:0.816.
val Loss: 0.8521
val Accuracy:0.876 Precision:0.751 Recall:0.705 F1:0.727 MCC:0.647.
 
Epoch 3/8
---------------
train Loss: 0.2215
train Accuracy:0.950 Precision:0.859 Recall:0.940 F1:0.897 MCC:0.866.
val Loss: 0.7690
val Accuracy:0.860 Precision:0.669 Recall:0.806 F1:0.731 MCC:0.643.
 
Epoch 4/8
---------------
train Loss: 0.1609
train Accuracy:0.962 Precision:0.891 Recall:0.957 F1:0.923 MCC:0.899.
val Loss: 0.9830
val Accuracy:0.883 Precision:0.795 Recall:0.680 F1:0.733 MCC:0.662.
 
Epoch 5/8
---------------
train Loss: 0.1260
train Accuracy:0.971 Precision:0.913 Recall:0.968 F1:0.940 MCC:0.921.
val Loss: 1.0718
val Accuracy:0.883 Precision:0.800 Recall:0.670 F1:0.730 MCC:0.660.
 
Epoch 6/8
---------------
train Loss: 0.1019
train Accuracy:0.976 Precision:0.926 Recall:0.975 F1:0.950 MCC:0.935.
val Loss: 1.6597
val Accuracy:0.881 Precision:0.901 Recall:0.555 F1:0.687 MCC:0.646.
 
Epoch 7/8
---------------
train Loss: 0.0902
train Accuracy:0.978 Precision:0.931 Recall:0.978 F1:0.954 MCC:0.940.
val Loss: 1.1123
val Accuracy:0.881 Precision:0.788 Recall:0.676 F1:0.727 MCC:0.655.
 
Epoch 8/8
---------------
train Loss: 0.0766
train Accuracy:0.982 Precision:0.944 Recall:0.981 F1:0.962 MCC:0.950.
val Loss: 1.3215
val Accuracy:0.895 Precision:0.865 Recall:0.656 F1:0.746 MCC:0.692.
Training complete in 151m 5s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5117
train Accuracy:0.860 Precision:0.654 Recall:0.861 F1:0.743 MCC:0.661.
val Loss: 0.5535
val Accuracy:0.897 Precision:0.821 Recall:0.717 F1:0.766 MCC:0.703.
 
Epoch 2/8
---------------
train Loss: 0.3339
train Accuracy:0.917 Precision:0.778 Recall:0.904 F1:0.836 MCC:0.785.
val Loss: 0.4337
val Accuracy:0.870 Precision:0.652 Recall:0.952 F1:0.774 MCC:0.711.
 
Epoch 3/8
---------------
train Loss: 0.2305
train Accuracy:0.943 Precision:0.840 Recall:0.936 F1:0.885 MCC:0.850.
val Loss: 0.4868
val Accuracy:0.855 Precision:0.631 Recall:0.917 F1:0.748 MCC:0.673.
 
Epoch 4/8
---------------
train Loss: 0.1678
train Accuracy:0.959 Precision:0.880 Recall:0.955 F1:0.916 MCC:0.890.
val Loss: 0.3874
val Accuracy:0.913 Precision:0.771 Recall:0.893 F1:0.828 MCC:0.774.
 
Epoch 5/8
---------------
train Loss: 0.1284
train Accuracy:0.969 Precision:0.907 Recall:0.968 F1:0.936 MCC:0.917.
val Loss: 0.5937
val Accuracy:0.918 Precision:0.845 Recall:0.795 F1:0.819 MCC:0.767.
 
Epoch 6/8
---------------
train Loss: 0.1101
train Accuracy:0.974 Precision:0.920 Recall:0.974 F1:0.946 MCC:0.930.
val Loss: 0.3539
val Accuracy:0.920 Precision:0.781 Recall:0.918 F1:0.844 MCC:0.795.
 
Epoch 7/8
---------------
train Loss: 0.0970
train Accuracy:0.976 Precision:0.926 Recall:0.976 F1:0.950 MCC:0.935.
val Loss: 0.4731
val Accuracy:0.921 Precision:0.811 Recall:0.862 F1:0.836 MCC:0.784.
 
Epoch 8/8
---------------
train Loss: 0.0844
train Accuracy:0.980 Precision:0.940 Recall:0.979 F1:0.959 MCC:0.946.
val Loss: 0.4884
val Accuracy:0.931 Precision:0.843 Recall:0.868 F1:0.856 MCC:0.811.
Training complete in 151m 23s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_4', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5143
train Accuracy:0.860 Precision:0.653 Recall:0.859 F1:0.742 MCC:0.660.
val Loss: 0.3615
val Accuracy:0.926 Precision:0.805 Recall:0.901 F1:0.850 MCC:0.803.
 
Epoch 2/8
---------------
train Loss: 0.3363
train Accuracy:0.917 Precision:0.777 Recall:0.905 F1:0.836 MCC:0.785.
val Loss: 0.3355
val Accuracy:0.940 Precision:0.861 Recall:0.887 F1:0.874 MCC:0.835.
 
Epoch 3/8
---------------
train Loss: 0.2380
train Accuracy:0.942 Precision:0.836 Recall:0.935 F1:0.883 MCC:0.846.
val Loss: 0.3475
val Accuracy:0.928 Precision:0.809 Recall:0.909 F1:0.856 MCC:0.811.
 
Epoch 4/8
---------------
train Loss: 0.1747
train Accuracy:0.958 Precision:0.876 Recall:0.954 F1:0.913 MCC:0.887.
val Loss: 0.3242
val Accuracy:0.935 Precision:0.817 Recall:0.931 F1:0.870 MCC:0.830.
 
Epoch 5/8
---------------
train Loss: 0.1350
train Accuracy:0.967 Precision:0.901 Recall:0.966 F1:0.932 MCC:0.911.
val Loss: 0.4206
val Accuracy:0.926 Precision:0.794 Recall:0.922 F1:0.853 MCC:0.808.
 
Epoch 6/8
---------------
train Loss: 0.1069
train Accuracy:0.974 Precision:0.919 Recall:0.973 F1:0.945 MCC:0.929.
val Loss: 0.3904
val Accuracy:0.927 Precision:0.794 Recall:0.932 F1:0.857 MCC:0.813.
 
Epoch 7/8
---------------
train Loss: 0.0944
train Accuracy:0.977 Precision:0.929 Recall:0.978 F1:0.953 MCC:0.938.
val Loss: 0.4243
val Accuracy:0.939 Precision:0.835 Recall:0.924 F1:0.877 MCC:0.839.
 
Epoch 8/8
---------------
train Loss: 0.0868
train Accuracy:0.979 Precision:0.935 Recall:0.979 F1:0.956 MCC:0.943.
val Loss: 0.5954
val Accuracy:0.940 Precision:0.884 Recall:0.855 F1:0.869 MCC:0.830.
Training complete in 151m 15s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5145
train Accuracy:0.862 Precision:0.658 Recall:0.855 F1:0.744 MCC:0.662.
val Loss: 0.8240
val Accuracy:0.888 Precision:0.928 Recall:0.568 F1:0.705 MCC:0.670.
 
Epoch 2/8
---------------
train Loss: 0.3502
train Accuracy:0.914 Precision:0.772 Recall:0.899 F1:0.831 MCC:0.777.
val Loss: 0.3390
val Accuracy:0.916 Precision:0.775 Recall:0.904 F1:0.835 MCC:0.783.
 
Epoch 3/8
---------------
train Loss: 0.2410
train Accuracy:0.941 Precision:0.835 Recall:0.931 F1:0.880 MCC:0.843.
val Loss: 0.4123
val Accuracy:0.923 Precision:0.838 Recall:0.834 F1:0.836 MCC:0.786.
 
Epoch 4/8
---------------
train Loss: 0.1764
train Accuracy:0.957 Precision:0.875 Recall:0.952 F1:0.912 MCC:0.885.
val Loss: 0.3205
val Accuracy:0.943 Precision:0.875 Recall:0.883 F1:0.879 MCC:0.841.
 
Epoch 5/8
---------------
train Loss: 0.1369
train Accuracy:0.967 Precision:0.902 Recall:0.965 F1:0.933 MCC:0.912.
val Loss: 0.3653
val Accuracy:0.928 Precision:0.808 Recall:0.908 F1:0.855 MCC:0.810.
 
Epoch 6/8
---------------
train Loss: 0.1106
train Accuracy:0.974 Precision:0.920 Recall:0.972 F1:0.946 MCC:0.929.
val Loss: 0.3790
val Accuracy:0.932 Precision:0.825 Recall:0.903 F1:0.862 MCC:0.819.
 
Epoch 7/8
---------------
train Loss: 0.0967
train Accuracy:0.977 Precision:0.930 Recall:0.976 F1:0.952 MCC:0.938.
val Loss: 0.3196
val Accuracy:0.947 Precision:0.873 Recall:0.904 F1:0.888 MCC:0.854.
 
Epoch 8/8
---------------
train Loss: 0.0871
train Accuracy:0.979 Precision:0.935 Recall:0.978 F1:0.956 MCC:0.943.
val Loss: 0.3765
val Accuracy:0.926 Precision:0.807 Recall:0.901 F1:0.852 MCC:0.805.
Training complete in 151m 17s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/heme/fold_1', '../../data_homology_reduced/images/heme/fold_2', '../../data_homology_reduced/images/heme/fold_3', '../../data_homology_reduced/images/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4774
train Accuracy:0.877 Precision:0.687 Recall:0.872 F1:0.768 MCC:0.695.
val Loss: 0.4925
val Accuracy:0.834 Precision:0.597 Recall:0.902 F1:0.718 MCC:0.634.
 
Epoch 2/8
---------------
train Loss: 0.3239
train Accuracy:0.922 Precision:0.790 Recall:0.908 F1:0.845 MCC:0.796.
val Loss: 0.5295
val Accuracy:0.908 Precision:0.798 Recall:0.812 F1:0.805 MCC:0.745.
 
Epoch 3/8
---------------
train Loss: 0.2256
train Accuracy:0.946 Precision:0.847 Recall:0.938 F1:0.890 MCC:0.856.
val Loss: 0.5987
val Accuracy:0.893 Precision:0.755 Recall:0.801 F1:0.778 MCC:0.708.
 
Epoch 4/8
---------------
train Loss: 0.1607
train Accuracy:0.961 Precision:0.884 Recall:0.959 F1:0.920 MCC:0.895.
val Loss: 0.7324
val Accuracy:0.911 Precision:0.839 Recall:0.766 F1:0.801 MCC:0.745.
 
Epoch 5/8
---------------
train Loss: 0.1268
train Accuracy:0.970 Precision:0.909 Recall:0.969 F1:0.938 MCC:0.919.
val Loss: 0.7922
val Accuracy:0.904 Precision:0.810 Recall:0.773 F1:0.791 MCC:0.729.
 
Epoch 6/8
---------------
train Loss: 0.1063
train Accuracy:0.974 Precision:0.922 Recall:0.973 F1:0.947 MCC:0.931.
val Loss: 0.5856
val Accuracy:0.916 Precision:0.824 Recall:0.814 F1:0.819 MCC:0.764.
 
Epoch 7/8
---------------
train Loss: 0.0909
train Accuracy:0.978 Precision:0.934 Recall:0.977 F1:0.955 MCC:0.941.
val Loss: 0.7679
val Accuracy:0.896 Precision:0.762 Recall:0.811 F1:0.785 MCC:0.718.
 
Epoch 8/8
---------------
train Loss: 0.0801
train Accuracy:0.981 Precision:0.942 Recall:0.980 F1:0.960 MCC:0.948.
val Loss: 0.7939
val Accuracy:0.909 Precision:0.832 Recall:0.768 F1:0.799 MCC:0.741.
Training complete in 151m 33s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.6883401689770954, 'acc': 0.8387254901960784, 'precision': 0.6237028945931186, 'recall': 0.7930555555555555, 'mcc': 0.5982771742784461}, {'loss': 0.3539118531052808, 'acc': 0.9203576115485564, 'precision': 0.7806730196545563, 'recall': 0.9178921568627451, 'mcc': 0.7954346433601233}, {'loss': 0.3242411571017068, 'acc': 0.9349163385826772, 'precision': 0.8169663439372983, 'recall': 0.930672268907563, 'mcc': 0.8300690984609246}, {'loss': 0.319576266960546, 'acc': 0.9467273622047244, 'precision': 0.8730346576500423, 'recall': 0.90406162464986, 'mcc': 0.8535407361382302}, {'loss': 0.4925000068225612, 'acc': 0.8341535433070866, 'precision': 0.5965054385558899, 'recall': 0.9024859943977591, 'mcc': 0.6337313068822431}]
Averge metrics over 5 folds:
average loss:  0.435713890593438
average accuracy:  0.8949760691678247
average precision:  0.7381764708781811
average recall:  0.8896335200746964
average mcc:  0.7422105918239935
cross-validation finished, end of program
