data directory: ../../bionoi_output/atom_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/nucleotide/fold_2', '../../bionoi_output/atom_type/nucleotide/fold_3', '../../bionoi_output/atom_type/nucleotide/fold_4', '../../bionoi_output/atom_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3806
train Accuracy:0.851 Precision:0.821 Recall:0.849 F1:0.835 MCC:0.700.
val Loss: 0.5238
val Accuracy:0.828 Precision:0.896 Recall:0.692 F1:0.781 MCC:0.658.
 
Epoch 2/8
---------------
train Loss: 0.2302
train Accuracy:0.916 Precision:0.901 Recall:0.910 F1:0.906 MCC:0.830.
val Loss: 0.4739
val Accuracy:0.837 Precision:0.864 Recall:0.752 F1:0.804 MCC:0.671.
 
Epoch 3/8
---------------
train Loss: 0.1449
train Accuracy:0.949 Precision:0.939 Recall:0.946 F1:0.942 MCC:0.896.
val Loss: 0.5547
val Accuracy:0.832 Precision:0.788 Recall:0.850 F1:0.818 MCC:0.664.
 
Epoch 4/8
---------------
train Loss: 0.0998
train Accuracy:0.966 Precision:0.959 Recall:0.966 F1:0.962 MCC:0.932.
val Loss: 0.7367
val Accuracy:0.822 Precision:0.848 Recall:0.730 F1:0.785 MCC:0.640.
 
Epoch 5/8
---------------
train Loss: 0.0783
train Accuracy:0.974 Precision:0.968 Recall:0.973 F1:0.970 MCC:0.947.
val Loss: 0.6366
val Accuracy:0.842 Precision:0.859 Recall:0.771 F1:0.812 MCC:0.679.
 
Epoch 6/8
---------------
train Loss: 0.0669
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.7317
val Accuracy:0.833 Precision:0.852 Recall:0.755 F1:0.801 MCC:0.662.
 
Epoch 7/8
---------------
train Loss: 0.0582
train Accuracy:0.981 Precision:0.977 Recall:0.980 F1:0.979 MCC:0.961.
val Loss: 0.6112
val Accuracy:0.841 Precision:0.803 Recall:0.850 F1:0.826 MCC:0.681.
 
Epoch 8/8
---------------
train Loss: 0.0526
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6857
val Accuracy:0.850 Precision:0.848 Recall:0.806 F1:0.827 MCC:0.695.
Training complete in 231m 2s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/nucleotide/fold_1', '../../bionoi_output/atom_type/nucleotide/fold_3', '../../bionoi_output/atom_type/nucleotide/fold_4', '../../bionoi_output/atom_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3975
train Accuracy:0.840 Precision:0.808 Recall:0.840 F1:0.824 MCC:0.678.
val Loss: 0.4133
val Accuracy:0.832 Precision:0.768 Recall:0.890 F1:0.825 MCC:0.671.
 
Epoch 2/8
---------------
train Loss: 0.2386
train Accuracy:0.912 Precision:0.894 Recall:0.910 F1:0.902 MCC:0.823.
val Loss: 0.4250
val Accuracy:0.857 Precision:0.824 Recall:0.862 F1:0.843 MCC:0.712.
 
Epoch 3/8
---------------
train Loss: 0.1516
train Accuracy:0.947 Precision:0.936 Recall:0.946 F1:0.941 MCC:0.893.
val Loss: 0.5525
val Accuracy:0.845 Precision:0.781 Recall:0.905 F1:0.838 MCC:0.697.
 
Epoch 4/8
---------------
train Loss: 0.1035
train Accuracy:0.965 Precision:0.956 Recall:0.964 F1:0.960 MCC:0.929.
val Loss: 0.5741
val Accuracy:0.834 Precision:0.761 Recall:0.913 F1:0.830 MCC:0.681.
 
Epoch 5/8
---------------
train Loss: 0.0803
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.7399
val Accuracy:0.822 Precision:0.748 Recall:0.905 F1:0.819 MCC:0.659.
 
Epoch 6/8
---------------
train Loss: 0.0665
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.5536
val Accuracy:0.862 Precision:0.844 Recall:0.847 F1:0.845 MCC:0.721.
 
Epoch 7/8
---------------
train Loss: 0.0573
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.978 MCC:0.961.
val Loss: 0.6359
val Accuracy:0.866 Precision:0.881 Recall:0.808 F1:0.843 MCC:0.729.
 
Epoch 8/8
---------------
train Loss: 0.0524
train Accuracy:0.983 Precision:0.979 Recall:0.983 F1:0.981 MCC:0.965.
val Loss: 0.5419
val Accuracy:0.878 Precision:0.860 Recall:0.867 F1:0.863 MCC:0.753.
Training complete in 231m 26s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/nucleotide/fold_1', '../../bionoi_output/atom_type/nucleotide/fold_2', '../../bionoi_output/atom_type/nucleotide/fold_4', '../../bionoi_output/atom_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3980
train Accuracy:0.842 Precision:0.808 Recall:0.842 F1:0.825 MCC:0.681.
val Loss: 0.3809
val Accuracy:0.855 Precision:0.844 Recall:0.827 F1:0.836 MCC:0.706.
 
Epoch 2/8
---------------
train Loss: 0.2441
train Accuracy:0.910 Precision:0.892 Recall:0.907 F1:0.900 MCC:0.819.
val Loss: 0.3264
val Accuracy:0.882 Precision:0.863 Recall:0.874 F1:0.868 MCC:0.762.
 
Epoch 3/8
---------------
train Loss: 0.1552
train Accuracy:0.945 Precision:0.934 Recall:0.943 F1:0.938 MCC:0.889.
val Loss: 0.4474
val Accuracy:0.865 Precision:0.800 Recall:0.927 F1:0.859 MCC:0.737.
 
Epoch 4/8
---------------
train Loss: 0.1078
train Accuracy:0.963 Precision:0.955 Recall:0.962 F1:0.958 MCC:0.925.
val Loss: 0.3972
val Accuracy:0.881 Precision:0.875 Recall:0.854 F1:0.864 MCC:0.758.
 
Epoch 5/8
---------------
train Loss: 0.0818
train Accuracy:0.973 Precision:0.967 Recall:0.972 F1:0.969 MCC:0.945.
val Loss: 0.5439
val Accuracy:0.864 Precision:0.871 Recall:0.815 F1:0.842 MCC:0.724.
 
Epoch 6/8
---------------
train Loss: 0.0705
train Accuracy:0.976 Precision:0.971 Recall:0.975 F1:0.973 MCC:0.951.
val Loss: 0.5087
val Accuracy:0.877 Precision:0.920 Recall:0.793 F1:0.852 MCC:0.754.
 
Epoch 7/8
---------------
train Loss: 0.0607
train Accuracy:0.980 Precision:0.976 Recall:0.979 F1:0.977 MCC:0.959.
val Loss: 0.4648
val Accuracy:0.888 Precision:0.861 Recall:0.893 F1:0.877 MCC:0.775.
 
Epoch 8/8
---------------
train Loss: 0.0546
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.4454
val Accuracy:0.886 Precision:0.900 Recall:0.836 F1:0.867 MCC:0.769.
Training complete in 231m 18s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/nucleotide/fold_1', '../../bionoi_output/atom_type/nucleotide/fold_2', '../../bionoi_output/atom_type/nucleotide/fold_3', '../../bionoi_output/atom_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3903
train Accuracy:0.844 Precision:0.813 Recall:0.844 F1:0.828 MCC:0.686.
val Loss: 0.4143
val Accuracy:0.832 Precision:0.791 Recall:0.844 F1:0.817 MCC:0.663.
 
Epoch 2/8
---------------
train Loss: 0.2328
train Accuracy:0.915 Precision:0.899 Recall:0.911 F1:0.905 MCC:0.828.
val Loss: 0.4623
val Accuracy:0.830 Precision:0.846 Recall:0.754 F1:0.798 MCC:0.655.
 
Epoch 3/8
---------------
train Loss: 0.1490
train Accuracy:0.948 Precision:0.938 Recall:0.946 F1:0.942 MCC:0.895.
val Loss: 0.5287
val Accuracy:0.825 Precision:0.819 Recall:0.777 F1:0.798 MCC:0.644.
 
Epoch 4/8
---------------
train Loss: 0.1026
train Accuracy:0.965 Precision:0.958 Recall:0.964 F1:0.961 MCC:0.929.
val Loss: 0.5912
val Accuracy:0.846 Precision:0.820 Recall:0.836 F1:0.828 MCC:0.689.
 
Epoch 5/8
---------------
train Loss: 0.0801
train Accuracy:0.973 Precision:0.967 Recall:0.972 F1:0.970 MCC:0.945.
val Loss: 0.5225
val Accuracy:0.848 Precision:0.831 Recall:0.824 F1:0.828 MCC:0.691.
 
Epoch 6/8
---------------
train Loss: 0.0674
train Accuracy:0.978 Precision:0.973 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.5572
val Accuracy:0.853 Precision:0.839 Recall:0.828 F1:0.834 MCC:0.703.
 
Epoch 7/8
---------------
train Loss: 0.0583
train Accuracy:0.981 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.6702
val Accuracy:0.835 Precision:0.890 Recall:0.715 F1:0.793 MCC:0.669.
 
Epoch 8/8
---------------
train Loss: 0.0533
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.981 MCC:0.965.
val Loss: 0.6469
val Accuracy:0.836 Precision:0.790 Recall:0.858 F1:0.822 MCC:0.672.
Training complete in 231m 23s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/nucleotide/fold_1', '../../bionoi_output/atom_type/nucleotide/fold_2', '../../bionoi_output/atom_type/nucleotide/fold_3', '../../bionoi_output/atom_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3706
train Accuracy:0.853 Precision:0.824 Recall:0.852 F1:0.838 MCC:0.704.
val Loss: 0.5789
val Accuracy:0.807 Precision:0.907 Recall:0.629 F1:0.743 MCC:0.622.
 
Epoch 2/8
---------------
train Loss: 0.2175
train Accuracy:0.921 Precision:0.906 Recall:0.917 F1:0.911 MCC:0.840.
val Loss: 0.4940
val Accuracy:0.843 Precision:0.827 Recall:0.817 F1:0.822 MCC:0.682.
 
Epoch 3/8
---------------
train Loss: 0.1381
train Accuracy:0.952 Precision:0.942 Recall:0.951 F1:0.946 MCC:0.903.
val Loss: 0.7701
val Accuracy:0.777 Precision:0.686 Recall:0.917 F1:0.784 MCC:0.588.
 
Epoch 4/8
---------------
train Loss: 0.0979
train Accuracy:0.967 Precision:0.960 Recall:0.965 F1:0.963 MCC:0.933.
val Loss: 0.7493
val Accuracy:0.813 Precision:0.804 Recall:0.764 F1:0.784 MCC:0.620.
 
Epoch 5/8
---------------
train Loss: 0.0758
train Accuracy:0.975 Precision:0.969 Recall:0.975 F1:0.972 MCC:0.949.
val Loss: 0.7802
val Accuracy:0.817 Precision:0.880 Recall:0.681 F1:0.768 MCC:0.635.
 
Epoch 6/8
---------------
train Loss: 0.0627
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.976 MCC:0.957.
val Loss: 0.8408
val Accuracy:0.826 Precision:0.873 Recall:0.711 F1:0.784 MCC:0.650.
 
Epoch 7/8
---------------
train Loss: 0.0561
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.7953
val Accuracy:0.840 Precision:0.825 Recall:0.812 F1:0.818 MCC:0.676.
 
Epoch 8/8
---------------
train Loss: 0.0513
train Accuracy:0.983 Precision:0.980 Recall:0.983 F1:0.981 MCC:0.967.
val Loss: 0.8031
val Accuracy:0.821 Precision:0.774 Recall:0.842 F1:0.806 MCC:0.642.
Training complete in 231m 30s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.47394981115872215, 'acc': 0.8374643366619116, 'precision': 0.8637797092531344, 'recall': 0.7522775991425509, 'mcc': 0.6710375497226326}, {'loss': 0.41329736095099223, 'acc': 0.8316666666666667, 'precision': 0.7677601940626083, 'recall': 0.8904742765273312, 'mcc': 0.6712349468261953}, {'loss': 0.326404786017679, 'acc': 0.8823809523809524, 'precision': 0.8628669664110024, 'recall': 0.8741961414790996, 'mcc': 0.7621705700114442}, {'loss': 0.4142774243438932, 'acc': 0.8317238912732475, 'precision': 0.7905601006922592, 'recall': 0.8442204301075269, 'mcc': 0.6626433762950501}, {'loss': 0.4939528292966105, 'acc': 0.8429899856938483, 'precision': 0.8268498367791077, 'recall': 0.8170698924731182, 'mcc': 0.6815731225815406}]
Averge metrics over 5 folds:
average loss:  0.42437644235357946
average accuracy:  0.8452451665353253
average precision:  0.8223633614396224
average recall:  0.8356476679459254
average mcc:  0.6897319130873726
cross-validation finished, end of program
