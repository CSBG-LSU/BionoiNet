data directory: ../../data_homology_reduced/images/
batch size: 16
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5258
train Accuracy:0.779 Precision:0.738 Recall:0.779 F1:0.758 MCC:0.556.
val Loss: 0.4809
val Accuracy:0.792 Precision:0.767 Recall:0.763 F1:0.765 MCC:0.579.
 
Epoch 2/8
---------------
train Loss: 0.4292
train Accuracy:0.830 Precision:0.798 Recall:0.826 F1:0.812 MCC:0.658.
val Loss: 0.4649
val Accuracy:0.799 Precision:0.733 Recall:0.862 F1:0.792 MCC:0.608.
 
Epoch 3/8
---------------
train Loss: 0.3824
train Accuracy:0.851 Precision:0.824 Recall:0.845 F1:0.835 MCC:0.700.
val Loss: 0.4181
val Accuracy:0.819 Precision:0.765 Recall:0.856 F1:0.808 MCC:0.642.
 
Epoch 4/8
---------------
train Loss: 0.3557
train Accuracy:0.863 Precision:0.838 Recall:0.857 F1:0.847 MCC:0.723.
val Loss: 0.4583
val Accuracy:0.820 Precision:0.853 Recall:0.718 F1:0.780 MCC:0.636.
 
Epoch 5/8
---------------
train Loss: 0.3304
train Accuracy:0.874 Precision:0.851 Recall:0.868 F1:0.859 MCC:0.745.
val Loss: 0.4340
val Accuracy:0.835 Precision:0.813 Recall:0.814 F1:0.814 MCC:0.665.
 
Epoch 6/8
---------------
train Loss: 0.3126
train Accuracy:0.881 Precision:0.860 Recall:0.875 F1:0.867 MCC:0.759.
val Loss: 0.4359
val Accuracy:0.818 Precision:0.758 Recall:0.868 F1:0.809 MCC:0.643.
 
Epoch 7/8
---------------
train Loss: 0.2921
train Accuracy:0.890 Precision:0.870 Recall:0.884 F1:0.877 MCC:0.777.
val Loss: 0.4447
val Accuracy:0.822 Precision:0.777 Recall:0.841 F1:0.807 MCC:0.644.
 
Epoch 8/8
---------------
train Loss: 0.2765
train Accuracy:0.896 Precision:0.877 Recall:0.890 F1:0.884 MCC:0.790.
val Loss: 0.4620
val Accuracy:0.828 Precision:0.828 Recall:0.774 F1:0.800 MCC:0.651.
Training complete in 209m 9s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5270
train Accuracy:0.778 Precision:0.737 Recall:0.776 F1:0.756 MCC:0.553.
val Loss: 0.4533
val Accuracy:0.822 Precision:0.755 Recall:0.887 F1:0.816 MCC:0.653.
 
Epoch 2/8
---------------
train Loss: 0.4466
train Accuracy:0.819 Precision:0.785 Recall:0.814 F1:0.799 MCC:0.634.
val Loss: 0.4372
val Accuracy:0.834 Precision:0.849 Recall:0.761 F1:0.803 MCC:0.663.
 
Epoch 3/8
---------------
train Loss: 0.4008
train Accuracy:0.839 Precision:0.808 Recall:0.835 F1:0.821 MCC:0.675.
val Loss: 0.4018
val Accuracy:0.848 Precision:0.830 Recall:0.827 F1:0.829 MCC:0.692.
 
Epoch 4/8
---------------
train Loss: 0.3747
train Accuracy:0.850 Precision:0.822 Recall:0.846 F1:0.834 MCC:0.698.
val Loss: 0.4218
val Accuracy:0.825 Precision:0.743 Recall:0.924 F1:0.824 MCC:0.669.
 
Epoch 5/8
---------------
train Loss: 0.3512
train Accuracy:0.861 Precision:0.835 Recall:0.857 F1:0.846 MCC:0.720.
val Loss: 0.3626
val Accuracy:0.867 Precision:0.839 Recall:0.867 F1:0.853 MCC:0.732.
 
Epoch 6/8
---------------
train Loss: 0.3295
train Accuracy:0.871 Precision:0.846 Recall:0.867 F1:0.857 MCC:0.740.
val Loss: 0.3777
val Accuracy:0.854 Precision:0.808 Recall:0.880 F1:0.843 MCC:0.709.
 
Epoch 7/8
---------------
train Loss: 0.3115
train Accuracy:0.879 Precision:0.856 Recall:0.876 F1:0.866 MCC:0.756.
val Loss: 0.4323
val Accuracy:0.836 Precision:0.769 Recall:0.902 F1:0.830 MCC:0.681.
 
Epoch 8/8
---------------
train Loss: 0.2941
train Accuracy:0.886 Precision:0.864 Recall:0.883 F1:0.873 MCC:0.771.
val Loss: 0.4181
val Accuracy:0.849 Precision:0.800 Recall:0.882 F1:0.839 MCC:0.701.
Training complete in 210m 37s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_4', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5471
train Accuracy:0.767 Precision:0.724 Recall:0.767 F1:0.745 MCC:0.531.
val Loss: 0.4027
val Accuracy:0.838 Precision:0.769 Recall:0.909 F1:0.833 MCC:0.687.
 
Epoch 2/8
---------------
train Loss: 0.4712
train Accuracy:0.808 Precision:0.768 Recall:0.812 F1:0.790 MCC:0.614.
val Loss: 0.3786
val Accuracy:0.861 Precision:0.865 Recall:0.815 F1:0.839 MCC:0.718.
 
Epoch 3/8
---------------
train Loss: 0.4180
train Accuracy:0.833 Precision:0.800 Recall:0.830 F1:0.815 MCC:0.663.
val Loss: 0.4008
val Accuracy:0.843 Precision:0.791 Recall:0.879 F1:0.833 MCC:0.690.
 
Epoch 4/8
---------------
train Loss: 0.3885
train Accuracy:0.845 Precision:0.816 Recall:0.841 F1:0.828 MCC:0.688.
val Loss: 0.3428
val Accuracy:0.872 Precision:0.866 Recall:0.841 F1:0.854 MCC:0.740.
 
Epoch 5/8
---------------
train Loss: 0.3672
train Accuracy:0.855 Precision:0.828 Recall:0.851 F1:0.839 MCC:0.708.
val Loss: 0.3447
val Accuracy:0.876 Precision:0.838 Recall:0.894 F1:0.865 MCC:0.752.
 
Epoch 6/8
---------------
train Loss: 0.3460
train Accuracy:0.865 Precision:0.839 Recall:0.861 F1:0.850 MCC:0.727.
val Loss: 0.3881
val Accuracy:0.855 Precision:0.826 Recall:0.853 F1:0.839 MCC:0.707.
 
Epoch 7/8
---------------
train Loss: 0.3269
train Accuracy:0.873 Precision:0.849 Recall:0.870 F1:0.859 MCC:0.744.
val Loss: 0.3897
val Accuracy:0.842 Precision:0.807 Recall:0.847 F1:0.827 MCC:0.682.
 
Epoch 8/8
---------------
train Loss: 0.3103
train Accuracy:0.881 Precision:0.857 Recall:0.877 F1:0.867 MCC:0.759.
val Loss: 0.3255
val Accuracy:0.877 Precision:0.856 Recall:0.869 F1:0.862 MCC:0.751.
Training complete in 209m 21s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5383
train Accuracy:0.773 Precision:0.730 Recall:0.777 F1:0.753 MCC:0.545.
val Loss: 0.4371
val Accuracy:0.825 Precision:0.805 Recall:0.799 F1:0.802 MCC:0.645.
 
Epoch 2/8
---------------
train Loss: 0.4413
train Accuracy:0.824 Precision:0.786 Recall:0.828 F1:0.807 MCC:0.646.
val Loss: 0.4490
val Accuracy:0.817 Precision:0.795 Recall:0.791 F1:0.793 MCC:0.629.
 
Epoch 3/8
---------------
train Loss: 0.3920
train Accuracy:0.846 Precision:0.813 Recall:0.847 F1:0.830 MCC:0.689.
val Loss: 0.4570
val Accuracy:0.834 Precision:0.869 Recall:0.736 F1:0.797 MCC:0.664.
 
Epoch 4/8
---------------
train Loss: 0.3642
train Accuracy:0.858 Precision:0.829 Recall:0.857 F1:0.843 MCC:0.714.
val Loss: 0.4632
val Accuracy:0.831 Precision:0.881 Recall:0.715 F1:0.790 MCC:0.661.
 
Epoch 5/8
---------------
train Loss: 0.3387
train Accuracy:0.870 Precision:0.844 Recall:0.867 F1:0.855 MCC:0.737.
val Loss: 0.4412
val Accuracy:0.823 Precision:0.826 Recall:0.761 F1:0.792 MCC:0.640.
 
Epoch 6/8
---------------
train Loss: 0.3199
train Accuracy:0.877 Precision:0.853 Recall:0.874 F1:0.864 MCC:0.753.
val Loss: 0.4273
val Accuracy:0.832 Precision:0.820 Recall:0.796 F1:0.808 MCC:0.659.
 
Epoch 7/8
---------------
train Loss: 0.3025
train Accuracy:0.884 Precision:0.862 Recall:0.880 F1:0.871 MCC:0.766.
val Loss: 0.4369
val Accuracy:0.825 Precision:0.783 Recall:0.837 F1:0.809 MCC:0.649.
 
Epoch 8/8
---------------
train Loss: 0.2859
train Accuracy:0.891 Precision:0.870 Recall:0.887 F1:0.879 MCC:0.780.
val Loss: 0.4893
val Accuracy:0.816 Precision:0.807 Recall:0.769 F1:0.788 MCC:0.626.
Training complete in 209m 12s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_1', '../../data_homology_reduced/images/control/fold_2', '../../data_homology_reduced/images/control/fold_3', '../../data_homology_reduced/images/control/fold_4', '../../data_homology_reduced/images/nucleotide/fold_1', '../../data_homology_reduced/images/nucleotide/fold_2', '../../data_homology_reduced/images/nucleotide/fold_3', '../../data_homology_reduced/images/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../data_homology_reduced/images/control/fold_5', '../../data_homology_reduced/images/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.5234
train Accuracy:0.781 Precision:0.740 Recall:0.781 F1:0.760 MCC:0.560.
val Loss: 0.5566
val Accuracy:0.773 Precision:0.809 Recall:0.640 F1:0.714 MCC:0.540.
 
Epoch 2/8
---------------
train Loss: 0.4272
train Accuracy:0.829 Precision:0.796 Recall:0.827 F1:0.811 MCC:0.656.
val Loss: 0.4472
val Accuracy:0.821 Precision:0.787 Recall:0.817 F1:0.802 MCC:0.639.
 
Epoch 3/8
---------------
train Loss: 0.3852
train Accuracy:0.848 Precision:0.819 Recall:0.845 F1:0.832 MCC:0.694.
val Loss: 0.5523
val Accuracy:0.769 Precision:0.680 Recall:0.905 F1:0.777 MCC:0.572.
 
Epoch 4/8
---------------
train Loss: 0.3549
train Accuracy:0.860 Precision:0.834 Recall:0.856 F1:0.845 MCC:0.718.
val Loss: 0.4412
val Accuracy:0.833 Precision:0.815 Recall:0.806 F1:0.811 MCC:0.661.
 
Epoch 5/8
---------------
train Loss: 0.3315
train Accuracy:0.871 Precision:0.847 Recall:0.866 F1:0.856 MCC:0.739.
val Loss: 0.4904
val Accuracy:0.821 Precision:0.763 Recall:0.864 F1:0.811 MCC:0.646.
 
Epoch 6/8
---------------
train Loss: 0.3116
train Accuracy:0.880 Precision:0.857 Recall:0.875 F1:0.866 MCC:0.757.
val Loss: 0.4887
val Accuracy:0.805 Precision:0.754 Recall:0.832 F1:0.791 MCC:0.611.
 
Epoch 7/8
---------------
train Loss: 0.2934
train Accuracy:0.889 Precision:0.868 Recall:0.884 F1:0.876 MCC:0.775.
val Loss: 0.5005
val Accuracy:0.819 Precision:0.810 Recall:0.773 F1:0.791 MCC:0.632.
 
Epoch 8/8
---------------
train Loss: 0.2758
train Accuracy:0.896 Precision:0.877 Recall:0.891 F1:0.884 MCC:0.790.
val Loss: 0.4641
val Accuracy:0.826 Precision:0.774 Recall:0.858 F1:0.814 MCC:0.655.
Training complete in 209m 35s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.4180946844677329, 'acc': 0.8193651925820257, 'precision': 0.7650335409678966, 'recall': 0.8556404072883173, 'mcc': 0.6419811777101969}, {'loss': 0.3626400684494348, 'acc': 0.8669642857142857, 'precision': 0.8390610815717806, 'recall': 0.8668274383708467, 'mcc': 0.731796606019673}, {'loss': 0.3254587237820739, 'acc': 0.8769047619047619, 'precision': 0.8563127311146329, 'recall': 0.8687031082529475, 'mcc': 0.7511388907095955}, {'loss': 0.4272556779999419, 'acc': 0.8318431092036243, 'precision': 0.8199196564621138, 'recall': 0.7955645161290322, 'mcc': 0.6585401809578402}, {'loss': 0.4412290431136282, 'acc': 0.8330054840247973, 'precision': 0.8152654115408142, 'recall': 0.8061155913978495, 'mcc': 0.6613373742630719}]
Averge metrics over 5 folds:
average loss:  0.3949356395625624
average accuracy:  0.845616566685899
average precision:  0.8191184843314476
average recall:  0.8385702122877987
average mcc:  0.6889588459320756
cross-validation finished, end of program
