data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3752
train Accuracy:0.853 Precision:0.826 Recall:0.849 F1:0.837 MCC:0.704.
val Loss: 0.4163
val Accuracy:0.846 Precision:0.841 Recall:0.806 F1:0.823 MCC:0.688.
 
Epoch 2/8
---------------
train Loss: 0.2531
train Accuracy:0.906 Precision:0.889 Recall:0.900 F1:0.895 MCC:0.810.
val Loss: 0.3830
val Accuracy:0.857 Precision:0.854 Recall:0.819 F1:0.836 MCC:0.710.
 
Epoch 3/8
---------------
train Loss: 0.1650
train Accuracy:0.942 Precision:0.931 Recall:0.940 F1:0.935 MCC:0.883.
val Loss: 0.4911
val Accuracy:0.850 Precision:0.835 Recall:0.825 F1:0.830 MCC:0.696.
 
Epoch 4/8
---------------
train Loss: 0.1096
train Accuracy:0.963 Precision:0.955 Recall:0.961 F1:0.958 MCC:0.924.
val Loss: 0.5405
val Accuracy:0.853 Precision:0.869 Recall:0.788 F1:0.826 MCC:0.702.
 
Epoch 5/8
---------------
train Loss: 0.0836
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.5428
val Accuracy:0.854 Precision:0.846 Recall:0.820 F1:0.833 MCC:0.703.
 
Epoch 6/8
---------------
train Loss: 0.0691
train Accuracy:0.977 Precision:0.972 Recall:0.977 F1:0.974 MCC:0.954.
val Loss: 0.7793
val Accuracy:0.846 Precision:0.903 Recall:0.731 F1:0.808 MCC:0.692.
 
Epoch 7/8
---------------
train Loss: 0.0588
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.6111
val Accuracy:0.858 Precision:0.861 Recall:0.810 F1:0.835 MCC:0.711.
 
Epoch 8/8
---------------
train Loss: 0.0544
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6626
val Accuracy:0.855 Precision:0.855 Recall:0.812 F1:0.833 MCC:0.706.
Training complete in 231m 24s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3798
train Accuracy:0.850 Precision:0.819 Recall:0.849 F1:0.834 MCC:0.697.
val Loss: 0.3943
val Accuracy:0.839 Precision:0.772 Recall:0.905 F1:0.833 MCC:0.687.
 
Epoch 2/8
---------------
train Loss: 0.2447
train Accuracy:0.909 Precision:0.889 Recall:0.908 F1:0.899 MCC:0.816.
val Loss: 0.4176
val Accuracy:0.877 Precision:0.912 Recall:0.801 F1:0.853 MCC:0.753.
 
Epoch 3/8
---------------
train Loss: 0.1566
train Accuracy:0.944 Precision:0.931 Recall:0.944 F1:0.938 MCC:0.888.
val Loss: 0.4342
val Accuracy:0.868 Precision:0.842 Recall:0.866 F1:0.854 MCC:0.734.
 
Epoch 4/8
---------------
train Loss: 0.1073
train Accuracy:0.963 Precision:0.955 Recall:0.963 F1:0.959 MCC:0.926.
val Loss: 0.4859
val Accuracy:0.857 Precision:0.802 Recall:0.902 F1:0.849 MCC:0.719.
 
Epoch 5/8
---------------
train Loss: 0.0832
train Accuracy:0.972 Precision:0.965 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.4961
val Accuracy:0.865 Precision:0.814 Recall:0.901 F1:0.855 MCC:0.732.
 
Epoch 6/8
---------------
train Loss: 0.0701
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.974 MCC:0.952.
val Loss: 0.5800
val Accuracy:0.873 Precision:0.861 Recall:0.853 F1:0.857 MCC:0.743.
 
Epoch 7/8
---------------
train Loss: 0.0610
train Accuracy:0.980 Precision:0.975 Recall:0.979 F1:0.977 MCC:0.959.
val Loss: 0.5116
val Accuracy:0.873 Precision:0.857 Recall:0.858 F1:0.858 MCC:0.744.
 
Epoch 8/8
---------------
train Loss: 0.0553
train Accuracy:0.982 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.963.
val Loss: 0.5597
val Accuracy:0.877 Precision:0.907 Recall:0.805 F1:0.853 MCC:0.751.
Training complete in 231m 39s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3833
train Accuracy:0.848 Precision:0.819 Recall:0.846 F1:0.832 MCC:0.694.
val Loss: 0.3546
val Accuracy:0.861 Precision:0.836 Recall:0.854 F1:0.845 MCC:0.719.
 
Epoch 2/8
---------------
train Loss: 0.2504
train Accuracy:0.908 Precision:0.890 Recall:0.905 F1:0.897 MCC:0.814.
val Loss: 0.3683
val Accuracy:0.860 Precision:0.808 Recall:0.896 F1:0.850 MCC:0.722.
 
Epoch 3/8
---------------
train Loss: 0.1620
train Accuracy:0.943 Precision:0.931 Recall:0.942 F1:0.936 MCC:0.885.
val Loss: 0.3460
val Accuracy:0.886 Precision:0.850 Recall:0.903 F1:0.876 MCC:0.772.
 
Epoch 4/8
---------------
train Loss: 0.1112
train Accuracy:0.962 Precision:0.952 Recall:0.961 F1:0.957 MCC:0.922.
val Loss: 0.3680
val Accuracy:0.883 Precision:0.839 Recall:0.913 F1:0.874 MCC:0.768.
 
Epoch 5/8
---------------
train Loss: 0.0856
train Accuracy:0.971 Precision:0.964 Recall:0.971 F1:0.968 MCC:0.942.
val Loss: 0.4003
val Accuracy:0.883 Precision:0.846 Recall:0.899 F1:0.872 MCC:0.765.
 
Epoch 6/8
---------------
train Loss: 0.0709
train Accuracy:0.976 Precision:0.971 Recall:0.976 F1:0.974 MCC:0.952.
val Loss: 0.5347
val Accuracy:0.871 Precision:0.909 Recall:0.788 F1:0.845 MCC:0.741.
 
Epoch 7/8
---------------
train Loss: 0.0607
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.4316
val Accuracy:0.885 Precision:0.855 Recall:0.893 F1:0.874 MCC:0.769.
 
Epoch 8/8
---------------
train Loss: 0.0552
train Accuracy:0.982 Precision:0.977 Recall:0.982 F1:0.979 MCC:0.963.
val Loss: 0.4324
val Accuracy:0.887 Precision:0.873 Recall:0.873 F1:0.873 MCC:0.771.
Training complete in 231m 27s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3635
train Accuracy:0.858 Precision:0.830 Recall:0.855 F1:0.842 MCC:0.713.
val Loss: 0.4004
val Accuracy:0.827 Precision:0.758 Recall:0.895 F1:0.821 MCC:0.664.
 
Epoch 2/8
---------------
train Loss: 0.2251
train Accuracy:0.918 Precision:0.902 Recall:0.914 F1:0.908 MCC:0.834.
val Loss: 0.4430
val Accuracy:0.852 Precision:0.868 Recall:0.786 F1:0.825 MCC:0.700.
 
Epoch 3/8
---------------
train Loss: 0.1446
train Accuracy:0.950 Precision:0.939 Recall:0.948 F1:0.944 MCC:0.899.
val Loss: 0.5927
val Accuracy:0.835 Precision:0.856 Recall:0.755 F1:0.802 MCC:0.666.
 
Epoch 4/8
---------------
train Loss: 0.1000
train Accuracy:0.966 Precision:0.958 Recall:0.965 F1:0.961 MCC:0.930.
val Loss: 0.5519
val Accuracy:0.862 Precision:0.869 Recall:0.810 F1:0.838 MCC:0.719.
 
Epoch 5/8
---------------
train Loss: 0.0780
train Accuracy:0.973 Precision:0.968 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.5768
val Accuracy:0.849 Precision:0.836 Recall:0.820 F1:0.828 MCC:0.693.
 
Epoch 6/8
---------------
train Loss: 0.0655
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.975 MCC:0.956.
val Loss: 0.7203
val Accuracy:0.851 Precision:0.900 Recall:0.747 F1:0.816 MCC:0.701.
 
Epoch 7/8
---------------
train Loss: 0.0573
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.6298
val Accuracy:0.853 Precision:0.834 Recall:0.835 F1:0.835 MCC:0.703.
 
Epoch 8/8
---------------
train Loss: 0.0521
train Accuracy:0.983 Precision:0.979 Recall:0.982 F1:0.981 MCC:0.965.
val Loss: 0.6877
val Accuracy:0.861 Precision:0.872 Recall:0.804 F1:0.837 MCC:0.718.
Training complete in 231m 35s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3586
train Accuracy:0.859 Precision:0.831 Recall:0.857 F1:0.844 MCC:0.716.
val Loss: 0.4217
val Accuracy:0.849 Precision:0.845 Recall:0.808 F1:0.826 MCC:0.693.
 
Epoch 2/8
---------------
train Loss: 0.2256
train Accuracy:0.917 Precision:0.900 Recall:0.915 F1:0.908 MCC:0.833.
val Loss: 0.5027
val Accuracy:0.835 Precision:0.802 Recall:0.834 F1:0.818 MCC:0.667.
 
Epoch 3/8
---------------
train Loss: 0.1470
train Accuracy:0.949 Precision:0.937 Recall:0.948 F1:0.942 MCC:0.896.
val Loss: 0.5112
val Accuracy:0.843 Precision:0.790 Recall:0.878 F1:0.832 MCC:0.688.
 
Epoch 4/8
---------------
train Loss: 0.1020
train Accuracy:0.965 Precision:0.957 Recall:0.965 F1:0.961 MCC:0.929.
val Loss: 0.6767
val Accuracy:0.832 Precision:0.858 Recall:0.746 F1:0.798 MCC:0.661.
 
Epoch 5/8
---------------
train Loss: 0.0774
train Accuracy:0.974 Precision:0.967 Recall:0.974 F1:0.971 MCC:0.947.
val Loss: 0.6448
val Accuracy:0.844 Precision:0.829 Recall:0.816 F1:0.823 MCC:0.683.
 
Epoch 6/8
---------------
train Loss: 0.0668
train Accuracy:0.978 Precision:0.972 Recall:0.978 F1:0.975 MCC:0.955.
val Loss: 0.6935
val Accuracy:0.839 Precision:0.835 Recall:0.794 F1:0.814 MCC:0.673.
 
Epoch 7/8
---------------
train Loss: 0.0563
train Accuracy:0.981 Precision:0.976 Recall:0.981 F1:0.979 MCC:0.961.
val Loss: 0.7583
val Accuracy:0.835 Precision:0.823 Recall:0.800 F1:0.811 MCC:0.665.
 
Epoch 8/8
---------------
train Loss: 0.0515
train Accuracy:0.983 Precision:0.978 Recall:0.983 F1:0.981 MCC:0.965.
val Loss: 0.7060
val Accuracy:0.857 Precision:0.867 Recall:0.802 F1:0.833 MCC:0.711.
Training complete in 231m 31s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.38299992223523993, 'acc': 0.8574060865430337, 'precision': 0.8535036292573981, 'recall': 0.8191988210075026, 'mcc': 0.710430322670148}, {'loss': 0.3942622342421895, 'acc': 0.83875, 'precision': 0.7716521937842779, 'recall': 0.9048097534833869, 'mcc': 0.6870477528588863}, {'loss': 0.3460157445605312, 'acc': 0.8859523809523809, 'precision': 0.8495904221802142, 'recall': 0.9032020364415863, 'mcc': 0.7717182820214139}, {'loss': 0.4003688840708053, 'acc': 0.8268061516452074, 'precision': 0.7579204823388885, 'recall': 0.895497311827957, 'mcc': 0.6640502338497223}, {'loss': 0.4217077884565493, 'acc': 0.8488018597997139, 'precision': 0.8447100175746924, 'recall': 0.8075268817204301, 'mcc': 0.6928628504536586}]
Averge metrics over 5 folds:
average loss:  0.38907091471306304
average accuracy:  0.8515432957880671
average precision:  0.8154753490270942
average recall:  0.8660469608961726
average mcc:  0.7052218883707658
cross-validation finished, end of program
