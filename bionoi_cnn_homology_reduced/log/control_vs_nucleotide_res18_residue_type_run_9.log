data directory: ../../bionoi_output/residue_type/
batch size: 32
performing control_vs_nucleotide cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3723
train Accuracy:0.855 Precision:0.828 Recall:0.850 F1:0.839 MCC:0.707.
val Loss: 0.3964
val Accuracy:0.850 Precision:0.830 Recall:0.831 F1:0.831 MCC:0.695.
 
Epoch 2/8
---------------
train Loss: 0.2460
train Accuracy:0.910 Precision:0.893 Recall:0.906 F1:0.899 MCC:0.818.
val Loss: 0.3948
val Accuracy:0.855 Precision:0.826 Recall:0.851 F1:0.839 MCC:0.707.
 
Epoch 3/8
---------------
train Loss: 0.1583
train Accuracy:0.944 Precision:0.933 Recall:0.941 F1:0.937 MCC:0.887.
val Loss: 0.4641
val Accuracy:0.853 Precision:0.827 Recall:0.847 F1:0.837 MCC:0.704.
 
Epoch 4/8
---------------
train Loss: 0.1063
train Accuracy:0.963 Precision:0.955 Recall:0.962 F1:0.958 MCC:0.925.
val Loss: 0.5533
val Accuracy:0.859 Precision:0.879 Recall:0.791 F1:0.833 MCC:0.714.
 
Epoch 5/8
---------------
train Loss: 0.0835
train Accuracy:0.972 Precision:0.966 Recall:0.972 F1:0.969 MCC:0.943.
val Loss: 0.6452
val Accuracy:0.834 Precision:0.839 Recall:0.775 F1:0.806 MCC:0.663.
 
Epoch 6/8
---------------
train Loss: 0.0687
train Accuracy:0.977 Precision:0.971 Recall:0.976 F1:0.974 MCC:0.953.
val Loss: 0.7117
val Accuracy:0.838 Precision:0.874 Recall:0.742 F1:0.803 MCC:0.673.
 
Epoch 7/8
---------------
train Loss: 0.0584
train Accuracy:0.981 Precision:0.977 Recall:0.980 F1:0.978 MCC:0.961.
val Loss: 0.6431
val Accuracy:0.851 Precision:0.824 Recall:0.845 F1:0.834 MCC:0.699.
 
Epoch 8/8
---------------
train Loss: 0.0545
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6742
val Accuracy:0.851 Precision:0.866 Recall:0.785 F1:0.824 MCC:0.697.
Training complete in 230m 31s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3818
train Accuracy:0.849 Precision:0.818 Recall:0.847 F1:0.832 MCC:0.695.
val Loss: 0.4141
val Accuracy:0.831 Precision:0.753 Recall:0.921 F1:0.828 MCC:0.678.
 
Epoch 2/8
---------------
train Loss: 0.2467
train Accuracy:0.908 Precision:0.889 Recall:0.907 F1:0.898 MCC:0.815.
val Loss: 0.4662
val Accuracy:0.860 Precision:0.867 Recall:0.808 F1:0.837 MCC:0.715.
 
Epoch 3/8
---------------
train Loss: 0.1552
train Accuracy:0.945 Precision:0.932 Recall:0.945 F1:0.939 MCC:0.889.
val Loss: 0.4005
val Accuracy:0.881 Precision:0.872 Recall:0.857 F1:0.865 MCC:0.758.
 
Epoch 4/8
---------------
train Loss: 0.1087
train Accuracy:0.962 Precision:0.954 Recall:0.962 F1:0.958 MCC:0.924.
val Loss: 0.4618
val Accuracy:0.869 Precision:0.839 Recall:0.874 F1:0.856 MCC:0.737.
 
Epoch 5/8
---------------
train Loss: 0.0795
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.4974
val Accuracy:0.879 Precision:0.858 Recall:0.872 F1:0.865 MCC:0.756.
 
Epoch 6/8
---------------
train Loss: 0.0679
train Accuracy:0.977 Precision:0.972 Recall:0.977 F1:0.974 MCC:0.954.
val Loss: 0.5236
val Accuracy:0.875 Precision:0.845 Recall:0.880 F1:0.862 MCC:0.748.
 
Epoch 7/8
---------------
train Loss: 0.0588
train Accuracy:0.980 Precision:0.976 Recall:0.980 F1:0.978 MCC:0.960.
val Loss: 0.5488
val Accuracy:0.882 Precision:0.888 Recall:0.839 F1:0.863 MCC:0.760.
 
Epoch 8/8
---------------
train Loss: 0.0542
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.6019
val Accuracy:0.882 Precision:0.907 Recall:0.819 F1:0.861 MCC:0.763.
Training complete in 230m 35s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14880, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14928]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3840
train Accuracy:0.847 Precision:0.816 Recall:0.845 F1:0.830 MCC:0.691.
val Loss: 0.3415
val Accuracy:0.865 Precision:0.844 Recall:0.854 F1:0.849 MCC:0.727.
 
Epoch 2/8
---------------
train Loss: 0.2530
train Accuracy:0.907 Precision:0.887 Recall:0.904 F1:0.896 MCC:0.811.
val Loss: 0.4314
val Accuracy:0.837 Precision:0.753 Recall:0.943 F1:0.837 MCC:0.696.
 
Epoch 3/8
---------------
train Loss: 0.1637
train Accuracy:0.942 Precision:0.930 Recall:0.941 F1:0.935 MCC:0.883.
val Loss: 0.3550
val Accuracy:0.882 Precision:0.858 Recall:0.879 F1:0.869 MCC:0.761.
 
Epoch 4/8
---------------
train Loss: 0.1086
train Accuracy:0.962 Precision:0.954 Recall:0.961 F1:0.958 MCC:0.924.
val Loss: 0.4034
val Accuracy:0.873 Precision:0.840 Recall:0.882 F1:0.860 MCC:0.745.
 
Epoch 5/8
---------------
train Loss: 0.0839
train Accuracy:0.972 Precision:0.966 Recall:0.971 F1:0.968 MCC:0.943.
val Loss: 0.4547
val Accuracy:0.871 Precision:0.840 Recall:0.875 F1:0.857 MCC:0.740.
 
Epoch 6/8
---------------
train Loss: 0.0706
train Accuracy:0.977 Precision:0.971 Recall:0.977 F1:0.974 MCC:0.953.
val Loss: 0.9505
val Accuracy:0.815 Precision:0.912 Recall:0.646 F1:0.756 MCC:0.638.
 
Epoch 7/8
---------------
train Loss: 0.0623
train Accuracy:0.979 Precision:0.974 Recall:0.979 F1:0.977 MCC:0.958.
val Loss: 0.4795
val Accuracy:0.881 Precision:0.883 Recall:0.843 F1:0.863 MCC:0.758.
 
Epoch 8/8
---------------
train Loss: 0.0539
train Accuracy:0.982 Precision:0.977 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.4340
val Accuracy:0.888 Precision:0.864 Recall:0.889 F1:0.876 MCC:0.774.
Training complete in 230m 57s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3649
train Accuracy:0.857 Precision:0.829 Recall:0.854 F1:0.841 MCC:0.711.
val Loss: 0.4165
val Accuracy:0.836 Precision:0.802 Recall:0.837 F1:0.819 MCC:0.670.
 
Epoch 2/8
---------------
train Loss: 0.2283
train Accuracy:0.916 Precision:0.900 Recall:0.913 F1:0.906 MCC:0.830.
val Loss: 0.4848
val Accuracy:0.847 Precision:0.897 Recall:0.739 F1:0.811 MCC:0.693.
 
Epoch 3/8
---------------
train Loss: 0.1480
train Accuracy:0.949 Precision:0.938 Recall:0.947 F1:0.942 MCC:0.896.
val Loss: 0.4971
val Accuracy:0.844 Precision:0.821 Recall:0.829 F1:0.825 MCC:0.684.
 
Epoch 4/8
---------------
train Loss: 0.1018
train Accuracy:0.966 Precision:0.958 Recall:0.965 F1:0.961 MCC:0.930.
val Loss: 0.5906
val Accuracy:0.854 Precision:0.866 Recall:0.794 F1:0.828 MCC:0.704.
 
Epoch 5/8
---------------
train Loss: 0.0799
train Accuracy:0.973 Precision:0.966 Recall:0.973 F1:0.969 MCC:0.945.
val Loss: 0.5344
val Accuracy:0.849 Precision:0.845 Recall:0.808 F1:0.826 MCC:0.693.
 
Epoch 6/8
---------------
train Loss: 0.0666
train Accuracy:0.978 Precision:0.973 Recall:0.978 F1:0.975 MCC:0.956.
val Loss: 0.9153
val Accuracy:0.827 Precision:0.888 Recall:0.697 F1:0.781 MCC:0.654.
 
Epoch 7/8
---------------
train Loss: 0.0607
train Accuracy:0.980 Precision:0.975 Recall:0.980 F1:0.977 MCC:0.959.
val Loss: 0.5643
val Accuracy:0.862 Precision:0.838 Recall:0.854 F1:0.846 MCC:0.721.
 
Epoch 8/8
---------------
train Loss: 0.0524
train Accuracy:0.983 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.965.
val Loss: 0.6719
val Accuracy:0.851 Precision:0.840 Recall:0.821 F1:0.830 MCC:0.698.
Training complete in 231m 29s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_1', '../../bionoi_output/residue_type/control/fold_2', '../../bionoi_output/residue_type/control/fold_3', '../../bionoi_output/residue_type/control/fold_4', '../../bionoi_output/residue_type/nucleotide/fold_1', '../../bionoi_output/residue_type/nucleotide/fold_2', '../../bionoi_output/residue_type/nucleotide/fold_3', '../../bionoi_output/residue_type/nucleotide/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 14928, 14928, 14928, 14880]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'nucleotide': 1}
getting training data from following folders:  ['../../bionoi_output/residue_type/control/fold_5', '../../bionoi_output/residue_type/nucleotide/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 14880]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0001
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3601
train Accuracy:0.859 Precision:0.831 Recall:0.855 F1:0.843 MCC:0.715.
val Loss: 0.4825
val Accuracy:0.831 Precision:0.868 Recall:0.730 F1:0.793 MCC:0.659.
 
Epoch 2/8
---------------
train Loss: 0.2244
train Accuracy:0.918 Precision:0.900 Recall:0.917 F1:0.908 MCC:0.834.
val Loss: 0.4848
val Accuracy:0.842 Precision:0.846 Recall:0.788 F1:0.816 MCC:0.679.
 
Epoch 3/8
---------------
train Loss: 0.1469
train Accuracy:0.949 Precision:0.937 Recall:0.948 F1:0.942 MCC:0.896.
val Loss: 0.5609
val Accuracy:0.844 Precision:0.801 Recall:0.863 F1:0.831 MCC:0.688.
 
Epoch 4/8
---------------
train Loss: 0.1025
train Accuracy:0.964 Precision:0.955 Recall:0.964 F1:0.959 MCC:0.927.
val Loss: 0.6406
val Accuracy:0.842 Precision:0.859 Recall:0.770 F1:0.812 MCC:0.679.
 
Epoch 5/8
---------------
train Loss: 0.0795
train Accuracy:0.973 Precision:0.967 Recall:0.973 F1:0.970 MCC:0.946.
val Loss: 0.7287
val Accuracy:0.838 Precision:0.832 Recall:0.796 F1:0.814 MCC:0.671.
 
Epoch 6/8
---------------
train Loss: 0.0668
train Accuracy:0.978 Precision:0.972 Recall:0.977 F1:0.975 MCC:0.955.
val Loss: 0.6584
val Accuracy:0.840 Precision:0.823 Recall:0.815 F1:0.819 MCC:0.676.
 
Epoch 7/8
---------------
train Loss: 0.0568
train Accuracy:0.981 Precision:0.977 Recall:0.981 F1:0.979 MCC:0.962.
val Loss: 0.7882
val Accuracy:0.842 Precision:0.842 Recall:0.792 F1:0.816 MCC:0.678.
 
Epoch 8/8
---------------
train Loss: 0.0532
train Accuracy:0.982 Precision:0.978 Recall:0.982 F1:0.980 MCC:0.964.
val Loss: 0.7107
val Accuracy:0.842 Precision:0.818 Recall:0.826 F1:0.822 MCC:0.680.
Training complete in 231m 35s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.3947970832578919, 'acc': 0.8546124583927722, 'precision': 0.8261830473218928, 'recall': 0.8514201500535906, 'mcc': 0.7066575120532137}, {'loss': 0.40049959325896844, 'acc': 0.880625, 'precision': 0.8717564530409317, 'recall': 0.857449088960343, 'mcc': 0.7579328038748501}, {'loss': 0.34146604063965025, 'acc': 0.8647619047619047, 'precision': 0.8435225618631732, 'recall': 0.8540326902465166, 'mcc': 0.7265105028979247}, {'loss': 0.4165147487456081, 'acc': 0.8362541726275632, 'precision': 0.8024229926536924, 'recall': 0.8368279569892473, 'mcc': 0.6702022801177232}, {'loss': 0.48246477692821904, 'acc': 0.8311278016213639, 'precision': 0.868147674604443, 'recall': 0.7301075268817204, 'mcc': 0.6592583489095728}]
Averge metrics over 5 folds:
average loss:  0.4071484485660675
average accuracy:  0.8534762674807208
average precision:  0.8424065458968266
average recall:  0.8259674826262836
average mcc:  0.7041122895706569
cross-validation finished, end of program
