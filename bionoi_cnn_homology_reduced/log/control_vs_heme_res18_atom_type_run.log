data directory: ../../bionoi_output/atom_type/
batch size: 32
performing control_vs_heme cross-validation task.
Current device: cuda:0
*********************************************************************
starting 1th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [2, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/heme/fold_2', '../../bionoi_output/atom_type/heme/fold_3', '../../bionoi_output/atom_type/heme/fold_4', '../../bionoi_output/atom_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18672, 18672, 18672, 18672, 5712, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [1]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/heme/fold_1']
folder classes:  [0, 1]
lengths of the folders:  [18720, 5760]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.3906
train Accuracy:0.898 Precision:0.726 Recall:0.907 F1:0.807 MCC:0.747.
val Loss: 0.6974
val Accuracy:0.873 Precision:0.729 Recall:0.729 F1:0.729 MCC:0.646.
 
Epoch 2/8
---------------
train Loss: 0.2459
train Accuracy:0.937 Precision:0.818 Recall:0.941 F1:0.875 MCC:0.837.
val Loss: 0.8888
val Accuracy:0.821 Precision:0.581 Recall:0.862 F1:0.694 MCC:0.597.
 
Epoch 3/8
---------------
train Loss: 0.1596
train Accuracy:0.960 Precision:0.877 Recall:0.963 F1:0.918 MCC:0.893.
val Loss: 1.5691
val Accuracy:0.873 Precision:0.829 Recall:0.580 F1:0.682 MCC:0.621.
 
Epoch 4/8
---------------
train Loss: 0.1138
train Accuracy:0.972 Precision:0.912 Recall:0.975 F1:0.942 MCC:0.925.
val Loss: 1.0070
val Accuracy:0.856 Precision:0.651 Recall:0.832 F1:0.731 MCC:0.643.
 
Epoch 5/8
---------------
train Loss: 0.0861
train Accuracy:0.979 Precision:0.932 Recall:0.981 F1:0.956 MCC:0.942.
val Loss: 0.9828
val Accuracy:0.881 Precision:0.726 Recall:0.796 F1:0.760 MCC:0.682.
 
Epoch 6/8
---------------
train Loss: 0.0718
train Accuracy:0.983 Precision:0.945 Recall:0.985 F1:0.964 MCC:0.953.
val Loss: 2.3907
val Accuracy:0.852 Precision:0.924 Recall:0.404 F1:0.562 MCC:0.550.
 
Epoch 7/8
---------------
train Loss: 0.0657
train Accuracy:0.984 Precision:0.949 Recall:0.986 F1:0.967 MCC:0.957.
val Loss: 1.3101
val Accuracy:0.895 Precision:0.831 Recall:0.697 F1:0.758 MCC:0.696.
 
Epoch 8/8
---------------
train Loss: 0.0568
train Accuracy:0.986 Precision:0.955 Recall:0.987 F1:0.971 MCC:0.962.
val Loss: 1.3845
val Accuracy:0.891 Precision:0.828 Recall:0.679 F1:0.746 MCC:0.683.
Training complete in 167m 49s
*********************************************************************
starting 2th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 3, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/heme/fold_1', '../../bionoi_output/atom_type/heme/fold_3', '../../bionoi_output/atom_type/heme/fold_4', '../../bionoi_output/atom_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [2]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/heme/fold_2']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4492
train Accuracy:0.884 Precision:0.700 Recall:0.882 F1:0.780 MCC:0.711.
val Loss: 0.7569
val Accuracy:0.868 Precision:0.730 Recall:0.690 F1:0.710 MCC:0.624.
 
Epoch 2/8
---------------
train Loss: 0.2822
train Accuracy:0.927 Precision:0.794 Recall:0.931 F1:0.857 MCC:0.813.
val Loss: 0.6670
val Accuracy:0.880 Precision:0.685 Recall:0.898 F1:0.777 MCC:0.709.
 
Epoch 3/8
---------------
train Loss: 0.1817
train Accuracy:0.954 Precision:0.861 Recall:0.959 F1:0.907 MCC:0.879.
val Loss: 0.6290
val Accuracy:0.857 Precision:0.635 Recall:0.913 F1:0.749 MCC:0.674.
 
Epoch 4/8
---------------
train Loss: 0.1285
train Accuracy:0.968 Precision:0.900 Recall:0.970 F1:0.934 MCC:0.914.
val Loss: 0.5293
val Accuracy:0.919 Precision:0.793 Recall:0.888 F1:0.838 MCC:0.787.
 
Epoch 5/8
---------------
train Loss: 0.0999
train Accuracy:0.976 Precision:0.923 Recall:0.978 F1:0.949 MCC:0.934.
val Loss: 1.2005
val Accuracy:0.899 Precision:0.904 Recall:0.634 F1:0.746 MCC:0.702.
 
Epoch 6/8
---------------
train Loss: 0.0848
train Accuracy:0.979 Precision:0.934 Recall:0.981 F1:0.957 MCC:0.944.
val Loss: 0.6680
val Accuracy:0.897 Precision:0.725 Recall:0.904 F1:0.805 MCC:0.744.
 
Epoch 7/8
---------------
train Loss: 0.0719
train Accuracy:0.983 Precision:0.945 Recall:0.984 F1:0.964 MCC:0.953.
val Loss: 0.5299
val Accuracy:0.890 Precision:0.698 Recall:0.930 F1:0.798 MCC:0.738.
 
Epoch 8/8
---------------
train Loss: 0.0653
train Accuracy:0.984 Precision:0.948 Recall:0.985 F1:0.966 MCC:0.955.
val Loss: 0.6782
val Accuracy:0.915 Precision:0.825 Recall:0.811 F1:0.818 MCC:0.763.
Training complete in 167m 40s
*********************************************************************
starting 3th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 4, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/heme/fold_1', '../../bionoi_output/atom_type/heme/fold_2', '../../bionoi_output/atom_type/heme/fold_4', '../../bionoi_output/atom_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [3]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/heme/fold_3']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4473
train Accuracy:0.879 Precision:0.689 Recall:0.886 F1:0.775 MCC:0.705.
val Loss: 0.5963
val Accuracy:0.921 Precision:0.850 Recall:0.804 F1:0.827 MCC:0.776.
 
Epoch 2/8
---------------
train Loss: 0.2681
train Accuracy:0.930 Precision:0.799 Recall:0.937 F1:0.862 MCC:0.820.
val Loss: 0.4364
val Accuracy:0.881 Precision:0.679 Recall:0.935 F1:0.787 MCC:0.725.
 
Epoch 3/8
---------------
train Loss: 0.1746
train Accuracy:0.955 Precision:0.865 Recall:0.960 F1:0.910 MCC:0.883.
val Loss: 0.5301
val Accuracy:0.948 Precision:0.894 Recall:0.883 F1:0.889 MCC:0.855.
 
Epoch 4/8
---------------
train Loss: 0.1277
train Accuracy:0.967 Precision:0.899 Recall:0.970 F1:0.933 MCC:0.913.
val Loss: 0.4924
val Accuracy:0.919 Precision:0.771 Recall:0.932 F1:0.844 MCC:0.796.
 
Epoch 5/8
---------------
train Loss: 0.1015
train Accuracy:0.975 Precision:0.922 Recall:0.977 F1:0.948 MCC:0.933.
val Loss: 0.6295
val Accuracy:0.946 Precision:0.892 Recall:0.877 F1:0.885 MCC:0.850.
 
Epoch 6/8
---------------
train Loss: 0.0819
train Accuracy:0.980 Precision:0.937 Recall:0.982 F1:0.959 MCC:0.947.
val Loss: 0.4863
val Accuracy:0.935 Precision:0.825 Recall:0.916 F1:0.868 MCC:0.827.
 
Epoch 7/8
---------------
train Loss: 0.0723
train Accuracy:0.983 Precision:0.946 Recall:0.983 F1:0.964 MCC:0.953.
val Loss: 0.5562
val Accuracy:0.943 Precision:0.883 Recall:0.872 F1:0.877 MCC:0.840.
 
Epoch 8/8
---------------
train Loss: 0.0639
train Accuracy:0.984 Precision:0.950 Recall:0.985 F1:0.968 MCC:0.958.
val Loss: 0.6304
val Accuracy:0.930 Precision:0.818 Recall:0.901 F1:0.857 MCC:0.813.
Training complete in 167m 52s
*********************************************************************
starting 4th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/heme/fold_1', '../../bionoi_output/atom_type/heme/fold_2', '../../bionoi_output/atom_type/heme/fold_3', '../../bionoi_output/atom_type/heme/fold_5']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/heme/fold_4']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4492
train Accuracy:0.879 Precision:0.690 Recall:0.884 F1:0.775 MCC:0.704.
val Loss: 0.6313
val Accuracy:0.887 Precision:0.794 Recall:0.701 F1:0.745 MCC:0.675.
 
Epoch 2/8
---------------
train Loss: 0.2730
train Accuracy:0.927 Precision:0.791 Recall:0.934 F1:0.856 MCC:0.812.
val Loss: 0.3214
val Accuracy:0.921 Precision:0.778 Recall:0.924 F1:0.845 MCC:0.797.
 
Epoch 3/8
---------------
train Loss: 0.1865
train Accuracy:0.952 Precision:0.856 Recall:0.956 F1:0.903 MCC:0.874.
val Loss: 0.3938
val Accuracy:0.885 Precision:0.685 Recall:0.942 F1:0.793 MCC:0.734.
 
Epoch 4/8
---------------
train Loss: 0.1266
train Accuracy:0.968 Precision:0.901 Recall:0.971 F1:0.935 MCC:0.915.
val Loss: 0.4370
val Accuracy:0.936 Precision:0.852 Recall:0.881 F1:0.866 MCC:0.824.
 
Epoch 5/8
---------------
train Loss: 0.1037
train Accuracy:0.974 Precision:0.918 Recall:0.977 F1:0.947 MCC:0.930.
val Loss: 0.5644
val Accuracy:0.933 Precision:0.871 Recall:0.839 F1:0.855 MCC:0.812.
 
Epoch 6/8
---------------
train Loss: 0.0885
train Accuracy:0.978 Precision:0.931 Recall:0.980 F1:0.955 MCC:0.941.
val Loss: 0.5237
val Accuracy:0.937 Precision:0.888 Recall:0.838 F1:0.862 MCC:0.822.
 
Epoch 7/8
---------------
train Loss: 0.0751
train Accuracy:0.982 Precision:0.943 Recall:0.983 F1:0.962 MCC:0.951.
val Loss: 0.4980
val Accuracy:0.944 Precision:0.931 Recall:0.820 F1:0.872 MCC:0.839.
 
Epoch 8/8
---------------
train Loss: 0.0677
train Accuracy:0.984 Precision:0.950 Recall:0.984 F1:0.967 MCC:0.957.
val Loss: 0.3534
val Accuracy:0.929 Precision:0.797 Recall:0.939 F1:0.862 MCC:0.820.
Training complete in 167m 49s
*********************************************************************
starting 5th fold cross-validation
--------------------------------------------------------
generating training dataset...
folds:  [1, 2, 3, 4]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_1', '../../bionoi_output/atom_type/control/fold_2', '../../bionoi_output/atom_type/control/fold_3', '../../bionoi_output/atom_type/control/fold_4', '../../bionoi_output/atom_type/heme/fold_1', '../../bionoi_output/atom_type/heme/fold_2', '../../bionoi_output/atom_type/heme/fold_3', '../../bionoi_output/atom_type/heme/fold_4']
folder classes:  [0, 0, 0, 0, 1, 1, 1, 1]
lengths of the folders:  [18720, 18672, 18672, 18672, 5760, 5712, 5712, 5712]
--------------------------------------------------------
generating validation dataset...
folds:  [5]
class name to integer map:  {'control': 0, 'heme': 1}
getting training data from following folders:  ['../../bionoi_output/atom_type/control/fold_5', '../../bionoi_output/atom_type/heme/fold_5']
folder classes:  [0, 1]
lengths of the folders:  [18672, 5712]
Model:  resnet18
Feature extracting: False
Using pretrained model: True
Using 2 GPUs...
optimizer:
Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0003
)
Not using any learning rate scheduler.
 
Epoch 1/8
---------------
train Loss: 0.4293
train Accuracy:0.889 Precision:0.711 Recall:0.889 F1:0.790 MCC:0.724.
val Loss: 0.5137
val Accuracy:0.847 Precision:0.617 Recall:0.909 F1:0.735 MCC:0.656.
 
Epoch 2/8
---------------
train Loss: 0.2527
train Accuracy:0.935 Precision:0.814 Recall:0.936 F1:0.871 MCC:0.831.
val Loss: 0.9913
val Accuracy:0.890 Precision:0.863 Recall:0.629 F1:0.728 MCC:0.673.
 
Epoch 3/8
---------------
train Loss: 0.1684
train Accuracy:0.958 Precision:0.872 Recall:0.962 F1:0.915 MCC:0.889.
val Loss: 0.5692
val Accuracy:0.842 Precision:0.606 Recall:0.926 F1:0.733 MCC:0.656.
 
Epoch 4/8
---------------
train Loss: 0.1203
train Accuracy:0.970 Precision:0.907 Recall:0.973 F1:0.939 MCC:0.920.
val Loss: 0.6480
val Accuracy:0.918 Precision:0.845 Recall:0.797 F1:0.820 MCC:0.768.
 
Epoch 5/8
---------------
train Loss: 0.0997
train Accuracy:0.976 Precision:0.923 Recall:0.977 F1:0.950 MCC:0.934.
val Loss: 0.5678
val Accuracy:0.908 Precision:0.760 Recall:0.884 F1:0.818 MCC:0.760.
 
Epoch 6/8
---------------
train Loss: 0.0807
train Accuracy:0.980 Precision:0.938 Recall:0.981 F1:0.959 MCC:0.947.
val Loss: 0.5724
val Accuracy:0.917 Precision:0.810 Recall:0.844 F1:0.827 MCC:0.773.
 
Epoch 7/8
---------------
train Loss: 0.0671
train Accuracy:0.984 Precision:0.948 Recall:0.985 F1:0.966 MCC:0.956.
val Loss: 0.6413
val Accuracy:0.922 Precision:0.832 Recall:0.837 F1:0.834 MCC:0.783.
 
Epoch 8/8
---------------
train Loss: 0.0636
train Accuracy:0.985 Precision:0.951 Recall:0.986 F1:0.968 MCC:0.959.
val Loss: 0.9468
val Accuracy:0.917 Precision:0.876 Recall:0.753 F1:0.810 MCC:0.761.
Training complete in 167m 52s
------------------------------------
metrics for each fold when validation loss reaches minimum:
[{'loss': 0.6974231412402945, 'acc': 0.8725490196078431, 'precision': 0.7293259207783183, 'recall': 0.7288194444444445, 'mcc': 0.645748243244109}, {'loss': 0.5293170317189811, 'acc': 0.9194963910761155, 'precision': 0.7931196247068022, 'recall': 0.8879551820728291, 'mcc': 0.7867580051751597}, {'loss': 0.4364398400888355, 'acc': 0.881233595800525, 'precision': 0.6789527198779868, 'recall': 0.9352240896358543, 'mcc': 0.7247079619494501}, {'loss': 0.32143414137381426, 'acc': 0.9205626640419947, 'precision': 0.7782692024178093, 'recall': 0.9241946778711485, 'mcc': 0.797389157255915}, {'loss': 0.5136596920980713, 'acc': 0.8466207349081365, 'precision': 0.6171299596103588, 'recall': 0.9094887955182073, 'mcc': 0.6564206453579912}]
Averge metrics over 5 folds:
average loss:  0.4996547693039993
average accuracy:  0.888092481086923
average precision:  0.719359485478255
average recall:  0.8771364379084968
average mcc:  0.722204802596525
cross-validation finished, end of program
