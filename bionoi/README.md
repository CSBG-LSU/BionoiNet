# Bionoi
Bionoi is a software that converts ligand-binding sites (3D) to Voronoi diagrams (2D) based on the 3D coordinate structure and properties of atoms/residues. Those images can be used as informative representations of ligand-binding sites for machine learning applications. The process of getting Bionoi representation of a binding site is illustrated in the following figure:  
<p align="center">
  <img width="500" height="330" src="example_output/flowchart.png">
</p>

## Folders
* cmaps: color maps for atom type and residue type. The color map of residue type represents the hydrophobicity of each residue. This implmentation is the classic hydrophobicity implementation which is used in the BionoiNet paper. 

* dependency: envionment file exported by Anaconda.

* example_output: example Voronoi diagrams used for this document.

* legacy: codes that developed during research process, not used in final version.

* testfiles: source files to generate example images.


## Dependency
To install the dependcy Python packages, use Conda:
```
conda env create -f environment.yml
```

## Usage
1. Example image colored by atom type.
   ```
   python bionoi.py -colorby atom_type
   ```   
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_atom_type_XOY+_r0_OO.png">
   </p>
2. Example image colored by residue type (classic hydrophobicity).   
   ```
   python bionoi.py -colorby residue_type
   ```   
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_residue_type_XOY+_r0_OO.png">
   </p>
3. Example image colored by charge (of each atom).   
   ```
   python bionoi.py -colorby charge
   ```   
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_charge_XOY+_r0_OO.png">
   </p>
4. Example image colored by center distances (of each atom).   
   ```
   python bionoi.py -colorby center_dist
   ```
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_center_dist_XOY+_r0_OO.png">
   </p>
5. Example image colored by solvent accessible surface area (SASA) (of each atom).   
   ```
   python bionoi.py -colorby sasa
   ```   
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_sasa_XOY+_r0_OO.png">
   </p>
6. Example image colored by hydrophobicity (of each residue).   
   ```
   python bionoi.py -colorby hydrophobicity
   ```
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_hydrophobicity_XOY+_r0_OO.png">
   </p>
7. Example image colored by sequence entropy (of each residue).    
   ```
   python bionoi.py -colorby seq_entropy
   ```
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_seq_entropy_XOY+_r0_OO.png">
   </p>
8. Example image colored by binding probability (of each residue).   
   ```
   python bionoi.py -colorby binding_prob
   ```
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_binding_prob_XOY+_r0_OO.png">
   </p>
9. Example image generated by blending the images of all the 6 properties (charge, SASA, center distance, hydrophobicity, sequence entropy and binding probability).   
   ```
   python bionoi.py -colorby blended
   ```
   output:   
   <p align="center">
   <img width="200" height="200" src="example_output/5iunE00_blended_XOY+_r0_OO.png">
   </p>
10. To generate images for your own binding sites, you need to write a simple bash script to specify the path of .mol2 file, pop file (for sasa) and profile file (for sequence entropy) for each binding site. The ```img_gen.sh``` is a straightforward example to do that.


## Contributors:
Rajiv Gandhi Govindaraj, Jeffrey Lemoine, Limeng Pu, Ye Fang, Wentao Shi, Joseph Feinstein and Michal Brylinski.

## Citation:
